

 *******************************************************************************
mmtbx/regression/tst_sampled_model_density.py
from __future__ import absolute_import, division, print_function
import iotbx.pdb
from mmtbx import real_space

pdb_str = """\
CRYST1  115.062  115.062   90.199  90.00  90.00 120.00 P 62
HETATM 3333 ZN    ZN E   1     -26.232  76.952   9.703  1.00 49.37          ZN
HETATM 3334 ZN    ZN E   2     -31.336  69.295  -1.147  0.00 11.59          ZN
TER
"""

def run():
  xrs = iotbx.pdb.input(source_info=None, lines=pdb_str).xray_structure_simple()
  smd = real_space.sampled_model_density(xray_structure=xrs, grid_step=0.3)

if __name__ == '__main__':
  run()


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_scattering_table.py
from __future__ import division, print_function
import time, os
import iotbx.pdb
import mmtbx.model
from cctbx import crystal
from cctbx import xray
from cctbx.array_family import flex
from iotbx.data_manager import DataManager
from libtbx.utils import null_out

pdb_str = """
CRYST1    4.870   10.060   30.660  94.85  90.26  99.99 P 1           1
ATOM      1  N   GLN A   1       1.153   1.465  -2.445  1.00  9.04           N
ATOM      2  CA  GLN A   1       1.681   2.444  -1.508  1.00  4.57           C
ATOM      3  C   GLN A   1       1.010   2.351  -0.141  1.00  3.21           C
ATOM      4  O   GLN A   1      -0.214   2.379  -0.045  1.00  5.48           O
ATOM      5  CB  GLN A   1       1.514   3.851  -2.090  1.00  6.45           C
ATOM      6  CG  GLN A   1       2.245   4.927  -1.325  1.00  8.01           C
ATOM      7  CD  GLN A   1       1.858   6.297  -1.796  1.00  5.89           C
ATOM      8  OE1 GLN A   1       0.717   6.720  -1.624  1.00  7.78           O
ATOM      9  NE2 GLN A   1       2.793   6.997  -2.405  1.00  6.95           N
"""

def tst000():
  """
  Test scattering table consistency between model object and xray_structure.

  This function sets up an atomic model from a PDB string and assigns
  different scattering tables ("n_gaussian", "wk1995", "it1992", "electron").
  It then verifies that the scattering table assigned via
  `model.setup_scattering_dictionaries` matches the table retrieved from
  the `xray_structure` object.

  Returns
  -------
  None

  Raises
  ------
  AssertionError
      If the scattering table retrieved from `xray_structure` does not match
      the expected table.
  """
  for table in ["n_gaussian", "wk1995", "it1992", "electron"]:
    pdb_inp = iotbx.pdb.input(source_info=None, lines=pdb_str)
    model = mmtbx.model.manager(model_input=pdb_inp, log=null_out())
    # set the scattering table via model object
    model.setup_scattering_dictionaries(scattering_table=table)
    # check that this table is consistent with what can be accessed with xrs
    xrs = model.get_xray_structure()
    assert (xrs.scattering_type_registry_params.table == table)
    assert (xrs.get_scattering_table() == table)

# ------------------------------------------------------------------------------

def tst001():
  """
  Test the scattering table consistency between what is supplied in the data
  manager and the xray_structure retrieved from the fmodel object.

  This function writes atomic model from a PDB string to a file,
  and then uses different scattering tables to create an fmodel object via
  the data manager. It tests if the xray structure object correctly retains
  the assigned scattering table.

  Returns
  -------
  None

  Raises
  ------
  AssertionError
      If the scattering table in xray_structure obtained from
      fmodel via the data manager does not match the assigned table.

  Notes
  -----
  - The generated model is saved as 'model.pdb'.
  - Structure factors are computed at d_min = 1.0 Ã….
  """
  phil_str = '''
  data_manager {
      model {
        file = tst_scattering_table_tst_001_model.pdb
        type = %s
      }
      miller_array {
        file = tst_scattering_table_tst_001_data.mtz
        labels {
          name = FOBS
          type = %s
        }
        labels {
          name = R-free-flags
          type = %s
        }
    }
  }'''
  pdb_inp = iotbx.pdb.input(source_info=None, lines=pdb_str)
  model = mmtbx.model.manager(model_input=pdb_inp, log=null_out())
  pdb_fn = 'tst_scattering_table_tst_001_model.pdb'
  mtz_fn = 'tst_scattering_table_tst_001_data.mtz'
  label_fobs = 'FOBS'
  label_flag = 'R-free-flags'
  with open(pdb_fn,"w") as fo:
    fo.write(model.model_as_pdb())
  for table in ["n_gaussian", "wk1995", "it1992", "electron"]:
    if table in ["n_gaussian", "wk1995", "it1992"]:
      _type = '*x_ray neutron electron'
    else:
      _type = 'x_ray neutron *electron'
    model.setup_scattering_dictionaries(scattering_table=table)
    fc = model.get_xray_structure().structure_factors(d_min=1,
      algorithm="direct").f_calc()
    mtz_dataset = abs(fc).as_mtz_dataset(column_root_label = 'FOBS')
    mtz_dataset.add_miller_array(
      miller_array      = fc.generate_r_free_flags(),
      column_root_label = label_flag)
    mtz_object = mtz_dataset.mtz_object()
    mtz_object.write(file_name = mtz_fn)
    dm_phil = iotbx.phil.parse(phil_str%(_type + ' reference', _type, _type))
    dm = DataManager(['model', 'miller_array'])
    dm.load_phil_scope(dm_phil)
    fmodel = dm.get_fmodel(scattering_table=table)
    #print(fmodel.r_work())
    xrs = fmodel.xray_structure
    assert (xrs.get_scattering_table() == table)
    assert (xrs.scattering_type_registry_params.table == table)
  os.remove(pdb_fn)
  os.remove(mtz_fn)

# ------------------------------------------------------------------------------

def tst002():
  """
  Test scattering table consistency after selections.

  This function sets up an atomic model from a PDB string and assigns
  different scattering tables ("n_gaussian", "wk1995", "it1992", "electron").
  It then verifies that the scattering tables are consistent after xrs.select().

  Returns
  -------
  None

  Raises
  ------
  AssertionError
      If the scattering table retrieved after applying selections do not match
      the expected table.
  """
  for table in ["n_gaussian", "wk1995", "it1992", "electron"]:
    pdb_inp = iotbx.pdb.input(source_info=None, lines=pdb_str)
    model = mmtbx.model.manager(model_input=pdb_inp, log=null_out())
    # get a selection
    sel = model.selection('name N or name CA or name C or name O')
    # copy model
    m1 = model.deep_copy()
    # -----
    # Test 1: check that table is consistent after applying xrs.select()
    # -----
    # set the scattering table via model object
    m1.setup_scattering_dictionaries(scattering_table=table)
    # check that this table is consistent with what can be accessed with xrs
    xrs1 = m1.get_xray_structure()
    assert (xrs1.scattering_type_registry_params.table == table)
    assert (xrs1.get_scattering_table() == table)
    # Check that xrs remembers scattering table after selection
    xrs_selected = xrs1.select(sel)
    assert (xrs_selected.get_scattering_table() == table)
    # -----
    # Test 2: check that table is consistent after deep_copy()
    # -----
    xrs_copy = xrs1.deep_copy_scatterers()
    assert (xrs_copy.get_scattering_table() == table)

# ------------------------------------------------------------------------------

def tst003():
  cs = crystal.symmetry((10, 20, 30, 90, 90, 90), "P 1")
  sp = crystal.special_position_settings(cs)
  scatterers = flex.xray_scatterer((
    xray.scatterer("o", (0.5, 0, 0)),
    xray.scatterer("c", (0, 0, 0))))
  xrs = xray.structure(sp, scatterers)
  # we have not set any scattering table yet, so it should be None
  assert (xrs.get_scattering_table() is None)
  #fc = xrs.structure_factors(d_min=1).f_calc()
  # here we create a default, which is n_gaussian
  xrs.scattering_type_registry()
  assert (xrs.get_scattering_table() == 'n_gaussian')
  # Now we set it explicitly
  xrs.scattering_type_registry(table = 'electron')
  assert (xrs.get_scattering_table() == 'electron')

# ------------------------------------------------------------------------------

if(__name__ == "__main__"):
  """
  Run the scattering table tests.

  This script executes the following tests:
  - `tst000()`: Ensures cconsistency between model object and xray_structure.
  - `tst001()`: consistency between what is supplied in the data manager and
     the xray_structure retrieved from the fmodel object
  - `tst002()`: Ensure consistency after xrs.select()
  - `tst003()`: illustrate toy example

  Returns
  -------
  None
  """
  t0 = time.time()
  tst000()
  tst001()
  tst002()
  tst003() # toy example
  print("OK. Time: %8.3f"%(time.time()-t0))


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_scattering_type_registry.py
from __future__ import absolute_import, division, print_function
import time
import mmtbx.model
import iotbx.pdb
from libtbx.utils import null_out


# Testing behavior of scattering_type_registry

def check_scattering_type_registry():
  pdb_inp = iotbx.pdb.input(source_info=None, lines=pdb_str)
  model = mmtbx.model.manager(
    model_input = pdb_inp,
    log = null_out())
  model.process(make_restraints=True)
  xrs1 = model.get_xray_structure()
  xrs2 = model.get_hierarchy().extract_xray_structure(
        crystal_symmetry=model.crystal_symmetry())
  xrs1.scattering_type_registry(table = "electron")
  xrs2.scattering_type_registry(table = "electron")
  xrs1.scattering_type_registry().show()
  xrs2.scattering_type_registry().show()
  # TODO: Assert to the same value once added
  assert (xrs1.scattering_type_registry().gaussian("O1-") is None)
  assert (xrs2.scattering_type_registry().gaussian("O1-") is None)

pdb_str = """
CRYST1    1.000    1.000    1.000  90.00  90.00  90.00 P 1
SCALE1      1.000000  0.000000  0.000000        0.00000
SCALE2      0.000000  1.000000  0.000000        0.00000
SCALE3      0.000000  0.000000  1.000000        0.00000
ATOM      1  O   ARG M 284     148.445 116.581 116.082  1.00 56.57           O1-
"""

if (__name__ == "__main__"):
  t0 = time.time()
  check_scattering_type_registry()
  print("Finished. Time:", round(time.time()-t0, 2))
  print("OK")


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_schrodinger_interface.py
"""
Test Phenix/Schrodinger interface

For now it only checks if Schrodinger is installed and the interface requested.
"""
from __future__ import absolute_import, division, print_function
import tempfile
import unittest

from mmtbx.geometry_restraints import external


class TestSchrodingerInterface(unittest.TestCase):

  def test_is_schrodinger_installed(self):
    env = dict(
        SCHRODINGER=tempfile.gettempdir(),
    )
    assert not external.is_schrodinger_installed(env)
    env['PHENIX_SCHRODINGER'] = True
    assert external.is_schrodinger_installed(env)
    del env['SCHRODINGER']
    assert not external.is_schrodinger_installed(env)
    env['SCHRODINGER'] = None
    assert not external.is_schrodinger_installed(env)


if __name__ == '__main__':
  unittest.main(verbosity=0)


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_sequence_validation.py

from __future__ import absolute_import, division, print_function
from iotbx.data_manager import DataManager
from libtbx import easy_mp
from libtbx import easy_pickle
from libtbx.utils import Sorry, null_out
import os
import tempfile

def exercise():
  import libtbx.utils
  if (libtbx.utils.detect_multiprocessing_problem() is not None):
    print("multiprocessing not available, skipping this test")
    return
  if (os.name == "nt"):
    print("easy_mp fixed_func not supported under Windows, skipping this test")
    return
  from mmtbx.validation.sequence import validation, get_sequence_n_copies, \
    get_sequence_n_copies_from_files
  import iotbx.bioinformatics
  import iotbx.pdb
  import libtbx.load_env # import dependency
  from libtbx.test_utils import Exception_expected, contains_lines, approx_equal
  from six.moves import cStringIO as StringIO
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM      2  CA  ARG A  10      -6.299  36.344   7.806  1.00 55.20           C
ATOM     25  CA  TYR A  11      -3.391  33.962   7.211  1.00 40.56           C
ATOM     46  CA  ALA A  12      -0.693  34.802   4.693  1.00 67.95           C
ATOM     56  CA  ALA A  13       0.811  31.422   3.858  1.00 57.97           C
ATOM     66  CA  GLY A  14       4.466  31.094   2.905  1.00 49.24           C
ATOM     73  CA  ALA A  15       7.163  28.421   2.671  1.00 54.70           C
ATOM     83  CA  ILE A  16       6.554  24.685   2.957  1.00 51.79           C
ATOM    102  CA  LEU A  17       7.691  23.612   6.406  1.00 42.30           C
ATOM    121  CA  PTY A  18       7.292  19.882   5.861  1.00 36.68           C
ATOM    128  CA  PHE A  19       5.417  16.968   4.327  1.00 44.99           C
ATOM    148  CA  GLY A  20       3.466  14.289   6.150  1.00 41.99           C
ATOM    155  CA  GLY A  21       1.756  11.130   4.965  1.00 35.77           C
ATOM    190  CA  ALA A  24       1.294  19.658   3.683  1.00 47.02           C
ATOM    200  CA  VAL A  24A      2.361  22.009   6.464  1.00 37.13           C
ATOM    216  CA  HIS A  25       2.980  25.633   5.535  1.00 42.52           C
ATOM    234  CA  LEU A  26       4.518  28.425   7.577  1.00 47.63           C
ATOM    253  CA  ALA A  27       2.095  31.320   7.634  1.00 38.61           C
ATOM    263  CA  ARG A  28       1.589  34.719   9.165  1.00 37.04           C
END""")
  seq1 = iotbx.bioinformatics.sequence("MTTPSHLSDRYELGEILGFGGMSEVHLARD".lower())
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq1],
    log=null_out(),
    nproc=1)
  out = StringIO()
  v.show(out=out)
  assert contains_lines(out.getvalue(), """\
  sequence identity: 76.47%
  13 residue(s) missing from PDB chain (9 at start, 1 at end)
  2 gap(s) in chain
  4 mismatches to sequence
    residue IDs:  12 13 15 24""")
  cif_block = v.sequence_as_cif_block()
  assert list(cif_block['_struct_ref.pdbx_seq_one_letter_code']) == [
    ';MTTPSHLSDRYELGEILGFGGMSEVHLARD\n;']
  # assert approx_equal(cif_block['_struct_ref_seq.pdbx_auth_seq_align_beg'],
  #                     ['10', '14', '16', '19', '24'])
  # assert approx_equal(cif_block['_struct_ref_seq.pdbx_auth_seq_align_end'],
  #                     ['11', '14', '17', '21', '28'])
  # assert approx_equal(cif_block['_struct_ref_seq.db_align_beg'],
  #                     ['10', '14', '16', '19', '25'])
  # assert approx_equal(cif_block['_struct_ref_seq.db_align_end'],
  #                     ['11', '14', '17', '21', '29'])
  # assert cif_block['_struct_ref_seq.pdbx_seq_align_beg_ins_code'][4] == 'A'
  seq2 = iotbx.bioinformatics.sequence("MTTPSHLSDRYELGEILGFGGMSEVHLA")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq2],
    log=null_out(),
    nproc=1)
  out = StringIO()
  v.show(out=out)
  assert contains_lines(out.getvalue(), """\
  1 residues not found in sequence
    residue IDs:  28""")
  try :
    v = validation(
      pdb_hierarchy=pdb_in.construct_hierarchy(),
      sequences=[],
      log=null_out(),
      nproc=1)
  except AssertionError :
    pass
  else :
    raise Exception_expected
  cif_block = v.sequence_as_cif_block()
  print(list(cif_block['_struct_ref.pdbx_seq_one_letter_code']))
  assert list(cif_block['_struct_ref.pdbx_seq_one_letter_code']) == [
    ';MTTPSHLSDRYELGEILGFGGMSEVHLA\n;']
  # assert approx_equal(cif_block['_struct_ref_seq.pdbx_auth_seq_align_end'],
  #                     ['11', '14', '17', '21', '27'])
  # assert approx_equal(cif_block['_struct_ref_seq.db_align_end'],
  #                     ['11', '14', '17', '21', '28'])
  #
  pdb_in2 = iotbx.pdb.input(source_info=None, lines="""\
ATOM      2  CA  ARG A  10      -6.299  36.344   7.806  1.00 55.20           C
ATOM     25  CA  TYR A  11      -3.391  33.962   7.211  1.00 40.56           C
ATOM     46  CA  ALA A  12      -0.693  34.802   4.693  1.00 67.95           C
ATOM     56  CA  ALA A  13       0.811  31.422   3.858  1.00 57.97           C
ATOM     66  CA  GLY A  14       4.466  31.094   2.905  1.00 49.24           C
ATOM     73  CA  ALA A  15       7.163  28.421   2.671  1.00 54.70           C
ATOM     83  CA  ILE A  16       6.554  24.685   2.957  1.00 51.79           C
ATOM    102  CA  LEU A  17       7.691  23.612   6.406  1.00 42.30           C
TER
ATOM   1936  P     G B   2     -22.947 -23.615  15.323  1.00123.20           P
ATOM   1959  P     C B   3     -26.398 -26.111  19.062  1.00110.06           P
ATOM   1979  P     U B   4     -29.512 -30.638  21.164  1.00101.06           P
ATOM   1999  P     C B   5     -30.524 -36.109  21.527  1.00 92.76           P
ATOM   2019  P     U B   6     -28.684 -41.458  21.223  1.00 87.42           P
ATOM   2062  P     G B   8     -18.396 -45.415  21.903  1.00 80.35           P
ATOM   2085  P     A B   9     -13.852 -43.272  24.156  1.00 77.76           P
ATOM   2107  P     G B  10      -8.285 -44.242  26.815  1.00 79.86           P
END
""")
  seq3 = iotbx.bioinformatics.sequence("AGCUUUGGAG")
  v = validation(
    pdb_hierarchy=pdb_in2.construct_hierarchy(),
    sequences=[seq2,seq3],
    log=null_out(),
    nproc=1,
    extract_coordinates=True)
  out = StringIO()
  v.show(out=out)
  cif_block = v.sequence_as_cif_block()
  assert approx_equal(cif_block['_struct_ref.pdbx_seq_one_letter_code'],
                      [';MTTPSHLSDRYELGEILGFGGMSEVHLA\n;', ';AGCUUUGGAG\n;'])
  # assert approx_equal(cif_block['_struct_ref_seq.pdbx_auth_seq_align_beg'],
  #                     ['10', '14', '16', '2', '6', '8'])
  # assert approx_equal(cif_block['_struct_ref_seq.pdbx_auth_seq_align_end'],
  #                     ['11', '14', '17', '4', '6', '10'])
  assert (len(v.chains[0].get_outliers_table()) == 3)
  assert (len(v.get_table_data()) == 4)
  assert approx_equal(
    v.chains[0].get_mean_coordinate_for_alignment_range(11,11),
    (-0.693, 34.802, 4.693))
  assert approx_equal(
    v.chains[0].get_mean_coordinate_for_alignment_range(11,14),
    (2.93675, 31.43475, 3.53175))
  assert (v.chains[0].get_highlighted_residues() == [11,12,14])
  assert contains_lines(out.getvalue(), """\
  3 mismatches to sequence
    residue IDs:  12 13 15""")
  assert contains_lines(out.getvalue(), """\
  sequence identity: 87.50%
  2 residue(s) missing from PDB chain (1 at start, 0 at end)
  1 gap(s) in chain
  1 mismatches to sequence
    residue IDs:  5""")
  s = easy_pickle.dumps(v)
  seq4 = iotbx.bioinformatics.sequence("")
  try :
    v = validation(
      pdb_hierarchy=pdb_in2.construct_hierarchy(),
      sequences=[seq4],
      log=null_out(),
      nproc=1,
      extract_coordinates=True)
  except AssertionError :
    pass
  else :
    raise Exception_expected
  # check that nucleic acid chain doesn't get aligned against protein sequence
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM  18932  P  B DG D   1     -12.183  60.531  25.090  0.50364.79           P
ATOM  18963  P  B DG D   2      -9.738  55.258  20.689  0.50278.77           P
ATOM  18994  P  B DA D   3     -10.119  47.855  19.481  0.50355.17           P
ATOM  19025  P  B DT D   4     -13.664  42.707  21.119  0.50237.06           P
ATOM  19056  P  B DG D   5     -19.510  39.821  21.770  0.50255.45           P
ATOM  19088  P  B DA D   6     -26.096  40.001  21.038  0.50437.49           P
ATOM  19120  P  B DC D   7     -31.790  41.189  18.413  0.50210.00           P
ATOM  19149  P  B DG D   8     -34.639  41.306  12.582  0.50313.99           P
ATOM  19179  P  B DA D   9     -34.987  38.244   6.813  0.50158.92           P
ATOM  19210  P  B DT D  10     -32.560  35.160   1.082  0.50181.38           P
HETATM19241  P  BTSP D  11     -27.614  30.137   0.455  0.50508.17           P
""")
  sequences, _ = iotbx.bioinformatics.fasta_sequence_parse.parse(
    """>4GFH:A|PDBID|CHAIN|SEQUENCE
MSTEPVSASDKYQKISQLEHILKRPDTYIGSVETQEQLQWIYDEETDCMIEKNVTIVPGLFKIFDEILVNAADNKVRDPS
MKRIDVNIHAEEHTIEVKNDGKGIPIEIHNKENIYIPEMIFGHLLTSSNYDDDEKKVTGGRNGYGAKLCNIFSTEFILET
ADLNVGQKYVQKWENNMSICHPPKITSYKKGPSYTKVTFKPDLTRFGMKELDNDILGVMRRRVYDINGSVRDINVYLNGK
SLKIRNFKNYVELYLKSLEKKRQLDNGEDGAAKSDIPTILYERINNRWEVAFAVSDISFQQISFVNSIATTMGGTHVNYI
TDQIVKKISEILKKKKKKSVKSFQIKNNMFIFINCLIENPAFTSQTKEQLTTRVKDFGSRCEIPLEYINKIMKTDLATRM
FEIADANEENALKKSDGTRKSRITNYPKLEDANKAGTKEGYKCTLVLTEGDSALSLAVAGLAVVGRDYYGCYPLRGKMLN
VREASADQILKNAEIQAIKKIMGLQHRKKYEDTKSLRYGHLMIMTDQDHDGSHIKGLIINFLESSFPGLLDIQGFLLEFI
TPIIKVSITKPTKNTIAFYNMPDYEKWREEESHKFTWKQKYYKGLGTSLAQEVREYFSNLDRHLKIFHSLQGNDKDYIDL
AFSKKKADDRKEWLRQYEPGTVLDPTLKEIPISDFINKELILFSLADNIRSIPNVLDGFKPGQRKVLYGCFKKNLKSELK
VAQLAPYVSECTAYHHGEQSLAQTIIGLAQNFVGSNNIYLLLPNGAFGTRATGGKDAAAARYIYTELNKLTRKIFHPADD
PLYKYIQEDEKTVEPEWYLPILPMILVNGAEGIGTGWSTYIPPFNPLEIIKNIRHLMNDEELEQMHPWFRGWTGTIEEIE
PLRYRMYGRIEQIGDNVLEITELPARTWTSTIKEYLLLGLSGNDKIKPWIKDMEEQHDDNIKFIITLSPEEMAKTRKIGF
YERFKLISPISLMNMVAFDPHGKIKKYNSVNEILSEFYYVRLEYYQKRKDHMSERLQWEVEKYSFQVKFIKMIIEKELTV
TNKPRNAIIQELENLGFPRFNKEGKPYYGSPNDEIAEQINDVKGATSDEEDEESSHEDTENVINGPEELYGTYEYLLGMR
IWSLTKERYQKLLKQKQEKETELENLLKLSAKDIWNTDLKAFEVGYQEFLQRDAEAR
>4GFH:D|PDBID|CHAIN|SEQUENCE
GGATGACGATX
""")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=sequences,
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].n_missing == 0
  assert v.chains[0].n_missing_end == 0
  assert v.chains[0].n_missing_start == 0
  assert len(v.chains[0].alignment.matches()) == 11
  #
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM      2  CA  GLY A   1       1.367   0.551   0.300  1.00  7.71           C
ATOM      6  CA  CYS A   2       2.782   3.785   1.683  1.00  5.18           C
ATOM     12  CA  CYS A   3      -0.375   5.128   3.282  1.00  5.21           C
ATOM     18  CA  SER A   4      -0.870   2.048   5.492  1.00  7.19           C
ATOM     25  CA  LEU A   5       2.786   2.056   6.642  1.00  6.78           C
ATOM     33  CA  PRO A   6       3.212   4.746   9.312  1.00  7.03           C
ATOM     40  CA  PRO A   7       6.870   5.690   8.552  1.00  7.97           C
ATOM     47  CA  CYS A   8       6.021   6.070   4.855  1.00  6.48           C
ATOM     53  CA  ALA A   9       2.812   8.041   5.452  1.00  7.15           C
ATOM     58  CA  LEU A  10       4.739  10.382   7.748  1.00  8.36           C
ATOM     66  CA  SER A  11       7.292  11.200   5.016  1.00  7.00           C
ATOM     73  CA  ASN A  12       4.649  11.435   2.264  1.00  5.40           C
ATOM     81  CA  PRO A  13       1.879  13.433   3.968  1.00  5.97           C
ATOM     88  CA  ASP A  14       0.485  15.371   0.986  1.00  7.70           C
ATOM     96  CA  TYR A  15       0.565  12.245  -1.180  1.00  6.55           C
ATOM    108  CA  CYS A  16      -1.466  10.260   1.363  1.00  7.32           C
ATOM    113  N   NH2 A  17      -2.612  12.308   2.058  1.00  8.11           N
""")
  seq = iotbx.bioinformatics.sequence("GCCSLPPCALSNPDYCX")
  # match last residue
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq],
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].n_missing == 0
  assert v.chains[0].n_missing_end == 0
  assert v.chains[0].n_missing_start == 0
  assert len(v.chains[0].alignment.matches()) == 17
  # ignore non-protein residue
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq],
    log=null_out(),
    nproc=1,
    ignore_hetatm=True)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].n_missing == 1
  assert v.chains[0].n_missing_end == 1
  assert v.chains[0].n_missing_start == 0
  assert len(v.chains[0].alignment.matches()) == 17
  #
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM   2518  CA  PRO C   3      23.450  -5.848  45.723  1.00 85.24           C
ATOM   2525  CA  GLY C   4      20.066  -4.416  44.815  1.00 79.25           C
ATOM   2529  CA  PHE C   5      19.408  -0.913  46.032  1.00 77.13           C
ATOM   2540  CA  GLY C   6      17.384  -1.466  49.208  1.00 83.44           C
ATOM   2544  CA  GLN C   7      17.316  -5.259  49.606  1.00 89.25           C
ATOM   2553  CA  GLY C   8      19.061  -6.829  52.657  1.00 90.67           C
""")
  sequences, _ = iotbx.bioinformatics.fasta_sequence_parse.parse(
    """>1JN5:A|PDBID|CHAIN|SEQUENCE
MASVDFKTYVDQACRAAEEFVNVYYTTMDKRRRLLSRLYMGTATLVWNGNAVSGQESLSEFFEMLPSSEFQISVVDCQPV
HDEATPSQTTVLVVICGSVKFEGNKQRDFNQNFILTAQASPSNTVWKIASDCFRFQDWAS
>1JN5:B|PDBID|CHAIN|SEQUENCE
APPCKGSYFGTENLKSLVLHFLQQYYAIYDSGDRQGLLDAYHDGACCSLSIPFIPQNPARSSLAEYFKDSRNVKKLKDPT
LRFRLLKHTRLNVVAFLNELPKTQHDVNSFVVDISAQTSTLLCFSVNGVFKEVDGKSRDSLRAFTRTFIAVPASNSGLCI
VNDELFVRNASSEEIQRAFAMPAPTPSSSPVPTLSPEQQEMLQAFSTQSGMNLEWSQKCLQDNNWDYTRSAQAFTHLKAK
GEIPEVAFMK
>1JN5:C|PDBID|CHAIN|SEQUENCE
GQSPGFGQGGSV
""")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=sequences,
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].n_missing_start == 3
  assert v.chains[0].n_missing_end == 3
  assert v.chains[0].identity == 1.0
  assert v.chains[0].alignment.match_codes == 'iiimmmmmmiii'
  #
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM      2  CA  ALA A   2      -8.453  57.214 -12.754  1.00 52.95           C
ATOM      7  CA  LEU A   3      -8.574  59.274  -9.471  1.00 24.33           C
ATOM     15  CA  ARG A   4     -12.178  60.092  -8.575  1.00 28.40           C
ATOM     26  CA  GLY A   5     -14.170  61.485  -5.667  1.00 26.54           C
ATOM     30  CA  THR A   6     -17.784  60.743  -4.783  1.00 31.78           C
ATOM     37  CA  VAL A   7     -19.080  64.405  -4.464  1.00 21.31           C
""")
  seq = iotbx.bioinformatics.sequence("XALRGTV")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq],
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].n_missing_start == 1
  assert v.chains[0].n_missing_end == 0
  assert v.chains[0].identity == 1.0
  assert v.chains[0].alignment.match_codes == 'immmmmm'
  #
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM   2171  CA  ASP I 355       5.591 -11.903   1.133  1.00 41.60           C
ATOM   2175  CA  PHE I 356       7.082  -8.454   0.828  1.00 39.82           C
ATOM   2186  CA  GLU I 357       5.814  -6.112  -1.877  1.00 41.12           C
ATOM   2195  CA  GLU I 358       8.623  -5.111  -4.219  1.00 42.70           C
ATOM   2199  CA  ILE I 359      10.346  -1.867  -3.363  1.00 43.32           C
ATOM   2207  CA  PRO I 360      11.658   0.659  -5.880  1.00 44.86           C
ATOM   2214  CA  GLU I 361      14.921  -0.125  -7.592  1.00 44.32           C
ATOM   2219  CA  GLU I 362      15.848   3.489  -6.866  1.00 44.27           C
HETATM 2224  CA  TYS I 363      16.482   2.005  -3.448  1.00 44.52           C
""")
  seq = iotbx.bioinformatics.sequence("NGDFEEIPEEYL")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq],
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].n_missing_start == 2
  assert v.chains[0].n_missing_end == 1
  assert v.chains[0].identity == 1.0
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM    450  CA  ASN A   1      37.242  41.665  44.160  1.00 35.89           C
ATOM    458  CA  GLY A   2      37.796  38.269  42.523  1.00 30.13           C
HETATM  463  CA AMSE A   3      35.878  39.005  39.326  0.54 22.83           C
HETATM  464  CA BMSE A   3      35.892  39.018  39.323  0.46 22.96           C
ATOM    478  CA  ILE A   4      37.580  38.048  36.061  1.00 22.00           C
ATOM    486  CA  SER A   5      37.593  40.843  33.476  1.00 18.73           C
ATOM    819  CA  ALA A   8      25.982  34.781  27.220  1.00 18.43           C
ATOM    824  CA  ALA A   9      23.292  32.475  28.614  1.00 19.60           C
HETATM  830  CA BMSE A  10      22.793  30.814  25.223  0.41 22.60           C
HETATM  831  CA CMSE A  10      22.801  30.850  25.208  0.59 22.54           C
ATOM    845  CA  GLU A  11      26.504  30.054  24.966  1.00 25.19           C
ATOM    854  CA  GLY A  12      25.907  28.394  28.320  1.00 38.88           C
""")
  seq = iotbx.bioinformatics.sequence("NGMISAAAAMEG")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq],
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)
  assert v.chains[0].alignment.a == 'NGMISXXAAMEG'
  assert v.chains[0].alignment.b == 'NGMISAAAAMEG'
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM   4615  CA  ALA C   1       1.000   1.000   1.000  1.00 10.00
ATOM   4622  CA  ALA C   2       1.000   1.000   1.000  1.00 10.00
ATOM   4627  CA  ALA C   3       1.000   1.000   1.000  1.00 10.00
ATOM   4634  CA  ALA C   4       1.000   1.000   1.000  1.00 10.00
ATOM   4646  CA  ALA C   5       1.000   1.000   1.000  1.00 10.00
ATOM   4658  CA  ALA C   6       1.000   1.000   1.000  1.00 10.00
ATOM   4664  CA  ALA C   7       1.000   1.000   1.000  1.00 10.00
ATOM   4669  CA  ALA C   8       1.000   1.000   1.000  1.00 10.00
ATOM   4680  CA  ARG C   9       1.000   1.000   1.000  1.00 10.00
ATOM   4690  CA  GLY C  10       1.000   1.000   1.000  1.00 10.00
ATOM   4698  CA  PRO C  11       1.000   1.000   1.000  1.00 10.00
ATOM   4705  CA  LYS C  12       1.000   1.000   1.000  1.00 10.00
ATOM   4712  CA  TRP C  13       1.000   1.000   1.000  1.00 10.00
ATOM   4726  CA  GLU C  14       1.000   1.000   1.000  1.00 10.00
ATOM   4738  CA  SER C  15       1.000   1.000   1.000  1.00 10.00
ATOM   4744  CA  THR C  16       1.000   1.000   1.000  1.00 10.00
ATOM   4751  CA  GLY C  17       1.000   1.000   1.000  1.00 10.00
ATOM   4755  CA  TYR C  18       1.000   1.000   1.000  1.00 10.00
ATOM   4767  CA  PHE C  19       1.000   1.000   1.000  1.00 10.00
ATOM   4778  CA  ALA C  20       1.000   1.000   1.000  1.00 10.00
ATOM   4786  CA  ALA C  21       1.000   1.000   1.000  1.00 10.00
ATOM   4798  CA  TRP C  22       1.000   1.000   1.000  1.00 10.00
ATOM   4812  CA  GLY C  23       1.000   1.000   1.000  1.00 10.00
ATOM   4816  CA  GLN C  24       1.000   1.000   1.000  1.00 10.00
ATOM   4822  CA  GLY C  25       1.000   1.000   1.000  1.00 10.00
ATOM   4826  CA  THR C  26       1.000   1.000   1.000  1.00 10.00
ATOM   4833  CA  LEU C  27       1.000   1.000   1.000  1.00 10.00
ATOM   4841  CA  VAL C  28       1.000   1.000   1.000  1.00 10.00
ATOM   4848  CA  THR C  29       1.000   1.000   1.000  1.00 10.00
ATOM   4855  CA  VAL C  30       1.000   1.000   1.000  1.00 10.00
ATOM   4862  CA  SER C  31       1.000   1.000   1.000  1.00 10.00
ATOM   4868  CA  SER C  32       1.000   1.000   1.000  1.00 10.00
END
""")
  seq = iotbx.bioinformatics.sequence(
    "AAAAAAAARGKWESPAALLKKAAWCSGTLVTVSSASAPKWKSTSGCYFAAPWNKRALRVTVLQSS")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=[seq],
    log=null_out(),
    nproc=1,)
  out = StringIO()
  v.show(out=out)

  # check that shortest matching sequence is chosen
  # example from 6H4N, chain a, and I
  sequences, _ = iotbx.bioinformatics.fasta_sequence_parse.parse("""\
>6H4N:a|PDBID|CHAIN|SEQUENCE
AAUUGAAGAGUUUGAUCAUGGCUCAGAUUGAACGCUGGCGGCAGGCCUAACACAUGCAAGUCGAACGGUAACAGGAAGAA
GCUUGCUUCUUUGCUGACGAGUGGCGGACGGGUGAGUAAUGUCUGGGAAACUGCCUGAUGGAGGGGGAUAACUACUGGAA
ACGGUAGCUAAUACCGCAUAACGUCGCAAGACCAAAGAGGGGGACCUUCGGGCCUCUUGCCAUCGGAUGUGCCCAGAUGG
GAUUAGCUAGUAGGUGGGGUAACGGCUCACCUAGGCGACGAUCCCUAGCUGGUCUGAGAGGAUGACCAGCCACACUGGAA
CUGAGACACGGUCCAGACUCCUACGGGAGGCAGCAGUGGGGAAUAUUGCACAAUGGGCGCAAGCCUGAUGCAGCCAUGCC
GCGUGUAUGAAGAAGGCCUUCGGGUUGUAAAGUACUUUCAGCGGGGAGGAAGGGAGUAAAGUUAAUACCUUUGCUCAUUG
ACGUUACCCGCAGAAGAAGCACCGGCUAACUCCGUGCCAGCAGCCGCGGUAAUACGGAGGGUGCAAGCGUUAAUCGGAAU
UACUGGGCGUAAAGCGCACGCAGGCGGUUUGUUAAGUCAGAUGUGAAAUCCCCGGGCUCAACCUGGGAACUGCAUCUGAU
ACUGGCAAGCUUGAGUCUCGUAGAGGGGGGUAGAAUUCCAGGUGUAGCGGUGAAAUGCGUAGAGAUCUGGAGGAAUACCG
GUGGCGAAGGCGGCCCCCUGGACGAAGACUGACGCUCAGGUGCGAAAGCGUGGGGAGCAAACAGGAUUAGAUACCCUGGU
AGUCCACGCCGUAAACGAUGUCGACUUGGAGGUUGUGCCCUUGAGGCGUGGCUUCCGGAGCUAACGCGUUAAGUCGACCG
CCUGGGGAGUACGGCCGCAAGGUUAAAACUCAAAUGAAUUGACGGGGGCCCGCACAAGCGGUGGAGCAUGUGGUUUAAUU
CGAUGCAACGCGAAGAACCUUACCUGGUCUUGACAUCCACGGAAGUUUUCAGAGAUGAGAAUGUGCCUUCGGGAACCGUG
AGACAGGUGCUGCAUGGCUGUCGUCAGCUCGUGUUGUGAAAUGUUGGGUUAAGUCCCGCAACGAGCGCAACCCUUAUCCU
UUGUUGCCAGCGGUCCGGCCGGGAACUCAAAGGAGACUGCCAGUGAUAAACUGGAGGAAGGUGGGGAUGACGUCAAGUCA
UCAUGGCCCUUACGACCAGGGCUACACACGUGCUACAAUGGCGCAUACAAAGAGAAGCGACCUCGCGAGAGCAAGCGGAC
CUCAUAAAGUGCGUCGUAGUCCGGAUUGGAGUCUGCAACUCGACUCCAUGAAGUCGGAAUCGCUAGUAAUCGUGGAUCAG
AAUGCCACGGUGAAUACGUUCCCGGGCCUUGUACACACCGCCCGUCACACCAUGGGAGUGGGUUGCAAAAGAAGUAGGUA
GCUUAACCUUCGGGAGGGCGCUUACCACUUUGUGAUUCAUGACUGGGGUGAAGUCGUAACAAGGUAACCGUAGGGGAACC
UGCGGUUGGAUCAC
>6H4N:I|PDBID|CHAIN|SEQUENCE
CUCCU
""")
  pdb_in = iotbx.pdb.input(source_info=None, lines="""\
ATOM  95502  P     C I1536     211.989 143.717 147.208  1.00 16.47           P
ATOM  95503  OP1   C I1536     213.292 143.696 146.494  1.00 16.47           O
ATOM  95504  OP2   C I1536     211.250 144.996 147.359  1.00 16.47           O
ATOM  95505  O5'   C I1536     211.021 142.666 146.541  1.00 16.47           O
ATOM  95506  C5'   C I1536     211.671 141.536 146.021  1.00 16.47           C
ATOM  95507  C4'   C I1536     211.059 140.260 146.502  1.00 16.47           C
ATOM  95508  O4'   C I1536     209.764 140.432 147.128  1.00 16.47           O
ATOM  95509  C3'   C I1536     210.818 139.353 145.303  1.00 16.47           C
ATOM  95510  O3'   C I1536     211.011 137.993 145.604  1.00 16.47           O
ATOM  95511  C2'   C I1536     209.372 139.646 144.938  1.00 16.47           C
ATOM  95512  O2'   C I1536     208.735 138.572 144.276  1.00 16.47           O
ATOM  95513  C1'   C I1536     208.757 139.866 146.316  1.00 16.47           C
ATOM  95514  N1    C I1536     207.618 140.788 146.322  1.00 16.47           N
ATOM  95515  C2    C I1536     206.610 140.626 145.378  1.00 16.47           C
ATOM  95516  O2    C I1536     206.712 139.721 144.535  1.00 16.47           O
ATOM  95517  N3    C I1536     205.560 141.463 145.396  1.00 16.47           N
ATOM  95518  C4    C I1536     205.492 142.420 146.320  1.00 16.47           C
ATOM  95519  N4    C I1536     204.429 143.227 146.302  1.00 16.47           N
ATOM  95520  C5    C I1536     206.496 142.595 147.306  1.00 16.47           C
ATOM  95521  C6    C I1536     207.522 141.754 147.283  1.00 16.47           C
ATOM  95522  P     U I1537     212.458 137.366 145.505  1.00 11.96           P
ATOM  95523  OP1   U I1537     212.292 135.894 145.567  1.00 11.96           O
ATOM  95524  OP2   U I1537     213.344 138.045 146.479  1.00 11.96           O
ATOM  95525  O5'   U I1537     212.962 137.720 144.038  1.00 11.96           O
ATOM  95526  C5'   U I1537     214.363 137.934 143.772  1.00 11.96           C
ATOM  95527  C4'   U I1537     214.522 138.678 142.472  1.00 11.96           C
ATOM  95528  O4'   U I1537     213.714 137.951 141.515  1.00 11.96           O
ATOM  95529  C3'   U I1537     213.970 140.098 142.549  1.00 11.96           C
ATOM  95530  O3'   U I1537     214.924 141.159 142.799  1.00 11.96           O
ATOM  95531  C2'   U I1537     212.939 140.210 141.413  1.00 11.96           C
ATOM  95532  O2'   U I1537     212.980 141.292 140.508  1.00 11.96           O
ATOM  95533  C1'   U I1537     212.990 138.848 140.714  1.00 11.96           C
ATOM  95534  N1    U I1537     211.632 138.324 140.509  1.00 11.96           N
ATOM  95535  C2    U I1537     211.212 138.082 139.216  1.00 11.96           C
ATOM  95536  O2    U I1537     211.943 138.228 138.252  1.00 11.96           O
ATOM  95537  N3    U I1537     209.897 137.730 139.076  1.00 11.96           N
ATOM  95538  C4    U I1537     208.966 137.602 140.074  1.00 11.96           C
ATOM  95539  O4    U I1537     207.834 137.203 139.798  1.00 11.96           O
ATOM  95540  C5    U I1537     209.473 137.843 141.382  1.00 11.96           C
ATOM  95541  C6    U I1537     210.749 138.206 141.544  1.00 11.96           C
ATOM  95542  P     C I1538     216.031 141.722 141.738  1.00 11.10           P
ATOM  95543  OP1   C I1538     216.814 142.772 142.428  1.00 11.10           O
ATOM  95544  OP2   C I1538     215.385 142.057 140.453  1.00 11.10           O
ATOM  95545  O5'   C I1538     217.081 140.541 141.538  1.00 11.10           O
ATOM  95546  C5'   C I1538     218.494 140.848 141.429  1.00 11.10           C
ATOM  95547  C4'   C I1538     218.962 140.916 139.986  1.00 11.10           C
ATOM  95548  O4'   C I1538     218.034 140.280 139.091  1.00 11.10           O
ATOM  95549  C3'   C I1538     219.276 142.298 139.408  1.00 11.10           C
ATOM  95550  O3'   C I1538     220.629 142.126 139.044  1.00 11.10           O
ATOM  95551  C2'   C I1538     218.657 142.315 138.005  1.00 11.10           C
ATOM  95552  O2'   C I1538     219.358 142.774 136.857  1.00 11.10           O
ATOM  95553  C1'   C I1538     218.164 140.883 137.832  1.00 11.10           C
ATOM  95554  N1    C I1538     216.943 140.702 137.064  1.00 11.10           N
ATOM  95555  C2    C I1538     217.041 140.096 135.813  1.00 11.10           C
ATOM  95556  O2    C I1538     218.163 139.770 135.401  1.00 11.10           O
ATOM  95557  N3    C I1538     215.932 139.850 135.093  1.00 11.10           N
ATOM  95558  C4    C I1538     214.748 140.195 135.580  1.00 11.10           C
ATOM  95559  N4    C I1538     213.670 139.968 134.827  1.00 11.10           N
ATOM  95560  C5    C I1538     214.617 140.827 136.842  1.00 11.10           C
ATOM  95561  C6    C I1538     215.722 141.024 137.566  1.00 11.10           C
ATOM  95562  P     C I1539     221.798 142.624 139.940  1.00 17.77           P
ATOM  95563  OP1   C I1539     221.300 143.669 140.865  1.00 17.77           O
ATOM  95564  OP2   C I1539     222.961 142.899 139.061  1.00 17.77           O
ATOM  95565  O5'   C I1539     222.148 141.341 140.812  1.00 17.77           O
ATOM  95566  C5'   C I1539     223.493 140.934 140.997  1.00 17.77           C
ATOM  95567  C4'   C I1539     223.633 139.444 140.845  1.00 17.77           C
ATOM  95568  O4'   C I1539     222.661 138.972 139.877  1.00 17.77           O
ATOM  95569  C3'   C I1539     224.967 138.959 140.300  1.00 17.77           C
ATOM  95570  O3'   C I1539     225.970 138.853 141.295  1.00 17.77           O
ATOM  95571  C2'   C I1539     224.602 137.629 139.658  1.00 17.77           C
ATOM  95572  O2'   C I1539     224.482 136.616 140.642  1.00 17.77           O
ATOM  95573  C1'   C I1539     223.209 137.924 139.109  1.00 17.77           C
ATOM  95574  N1    C I1539     223.219 138.333 137.681  1.00 17.77           N
ATOM  95575  C2    C I1539     223.353 137.370 136.683  1.00 17.77           C
ATOM  95576  O2    C I1539     223.476 136.178 136.982  1.00 17.77           O
ATOM  95577  N3    C I1539     223.342 137.742 135.392  1.00 17.77           N
ATOM  95578  C4    C I1539     223.202 139.017 135.059  1.00 17.77           C
ATOM  95579  N4    C I1539     223.202 139.332 133.762  1.00 17.77           N
ATOM  95580  C5    C I1539     223.059 140.033 136.041  1.00 17.77           C
ATOM  95581  C6    C I1539     223.067 139.642 137.318  1.00 17.77           C
ATOM  95582  P     U I1540     227.517 139.071 140.915  1.00 25.44           P
ATOM  95583  OP1   U I1540     228.321 138.910 142.156  1.00 25.44           O
ATOM  95584  OP2   U I1540     227.626 140.309 140.102  1.00 25.44           O
ATOM  95585  O5'   U I1540     227.868 137.833 139.978  1.00 25.44           O
ATOM  95586  C5'   U I1540     228.014 136.524 140.520  1.00 25.44           C
ATOM  95587  C4'   U I1540     228.308 135.503 139.447  1.00 25.44           C
ATOM  95588  O4'   U I1540     227.513 135.808 138.268  1.00 25.44           O
ATOM  95589  C3'   U I1540     229.761 135.445 138.980  1.00 25.44           C
ATOM  95590  O3'   U I1540     230.104 134.098 138.659  1.00 25.44           O
ATOM  95591  C2'   U I1540     229.740 136.281 137.705  1.00 25.44           C
ATOM  95592  O2'   U I1540     230.767 135.976 136.785  1.00 25.44           O
ATOM  95593  C1'   U I1540     228.360 135.950 137.145  1.00 25.44           C
ATOM  95594  N1    U I1540     227.809 136.996 136.268  1.00 25.44           N
ATOM  95595  C2    U I1540     227.053 136.589 135.186  1.00 25.44           C
ATOM  95596  O2    U I1540     226.815 135.418 134.956  1.00 25.44           O
ATOM  95597  N3    U I1540     226.574 137.600 134.393  1.00 25.44           N
ATOM  95598  C4    U I1540     226.781 138.951 134.566  1.00 25.44           C
ATOM  95599  O4    U I1540     226.286 139.746 133.765  1.00 25.44           O
ATOM  95600  C5    U I1540     227.583 139.293 135.701  1.00 25.44           C
ATOM  95601  C6    U I1540     228.061 138.329 136.493  1.00 25.44           C
END
""")
  v = validation(
    pdb_hierarchy=pdb_in.construct_hierarchy(),
    sequences=sequences,
    log=null_out(),
    nproc=1,)
  assert(v.chains[0].get_alignment() == ['CUCCU', 'CUCCU'])

  # all tests below here have additional dependencies
  if (not libtbx.env.has_module("ksdssp")):
    print("Skipping advanced tests (require ksdssp module)")
    return
  pdb_file = libtbx.env.find_in_repositories(
    relative_path="phenix_regression/pdb/1ywf.pdb",
    test=os.path.isfile)
  if (pdb_file is not None):
    seq = iotbx.bioinformatics.sequence("MGSSHHHHHHSSGLVPRGSHMAVRELPGAWNFRDVADTATALRPGRLFRSSELSRLDDAGRATLRRLGITDVADLRSSREVARRGPGRVPDGIDVHLLPFPDLADDDADDSAPHETAFKRLLTNDGSNGESGESSQSINDAATRYMTDEYRQFPTRNGAQRALHRVVTLLAAGRPVLTHCFAGKDRTGFVVALVLEAVGLDRDVIVADYLRSNDSVPQLRARISEMIQQRFDTELAPEVVTFTKARLSDGVLGVRAEYLAAARQTIDETYGSLGGYLRDAGISQATVNRMRGVLLG")
    hierarchy = iotbx.pdb.input(pdb_file).construct_hierarchy()
    v = validation(
      pdb_hierarchy=hierarchy,
      sequences=[seq],
      log=null_out(),
      nproc=1,
      include_secondary_structure=True,
      extract_coordinates=True)
    out = StringIO()
    v.show(out=out)
    aln1, aln2, ss = v.chains[0].get_alignment(include_sec_str=True)
    assert ("HHH" in ss) and ("LLL" in ss) and ("---" in ss)
    cif_block = v.sequence_as_cif_block()
    assert cif_block['_struct_ref.pdbx_seq_one_letter_code'] == seq.sequence
    # assert list(
    #   cif_block['_struct_ref_seq.pdbx_auth_seq_align_beg']) == ['4', '117']
    # assert list(
    #   cif_block['_struct_ref_seq.pdbx_auth_seq_align_end']) == ['85', '275']
    # assert list(cif_block['_struct_ref_seq.seq_align_beg']) == ['1', '114']
    # assert list(cif_block['_struct_ref_seq.seq_align_end']) == ['82', '272']
    # determine relative counts of sequences and chains
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq] * 4,
      copies_from_xtriage=4,
      out=null_out())
    assert (n_seq == 1)
    hierarchy = hierarchy.deep_copy()
    chain2 = hierarchy.only_model().chains()[0].detached_copy()
    hierarchy.only_model().append_chain(chain2)
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq] * 4,
      copies_from_xtriage=2,
      out=null_out())
    assert (n_seq == 1)
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq],
      copies_from_xtriage=2,
      out=null_out())
    assert (n_seq == 4)
    try :
      n_seq = get_sequence_n_copies(
        pdb_hierarchy=hierarchy,
        sequences=[seq] * 3,
        copies_from_xtriage=2,
        out=null_out())
    except Sorry as s :
      assert ("round number" in str(s))
    else :
      raise Exception_expected
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq] * 3,
      copies_from_xtriage=2,
      force_accept_composition=True,
      out=null_out())
    assert (n_seq == 1)
    try :
      n_seq = get_sequence_n_copies(
        pdb_hierarchy=hierarchy,
        sequences=[seq] * 4,
        copies_from_xtriage=1,
        out=null_out())
    except Sorry as s :
      assert ("less than" in str(s))
    else :
      raise Exception_expected
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq] * 4,
      copies_from_xtriage=1,
      assume_xtriage_copies_from_sequence_file=True,
      out=null_out())
    assert (n_seq == 0.5)
    hierarchy = hierarchy.deep_copy()
    chain2 = hierarchy.only_model().chains()[0].detached_copy()
    hierarchy.only_model().append_chain(chain2)
    try :
      n_seq = get_sequence_n_copies(
        pdb_hierarchy=hierarchy,
        sequences=[seq] * 2,
        copies_from_xtriage=2,
        out=null_out())
    except Sorry as s :
      assert ("round number" in str(s))
    else :
      raise Exception_expected
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq],
      copies_from_xtriage=1,
      out=null_out())
    assert (n_seq == 3)
    hierarchy = hierarchy.deep_copy()
    chain2 = hierarchy.only_model().chains()[0].detached_copy()
    hierarchy.only_model().append_chain(chain2)
    n_seq = get_sequence_n_copies(
      pdb_hierarchy=hierarchy,
      sequences=[seq] * 2,
      copies_from_xtriage=2,
      out=null_out())
    assert (n_seq == 4)
    # now with files as input
    seq_file = "tmp_mmtbx_validation_sequence.fa"
    open(seq_file, "w").write(">1ywf\n%s" % seq.sequence)
    n_seq = get_sequence_n_copies_from_files(
      pdb_file=pdb_file,
      seq_file=seq_file,
      copies_from_xtriage=4,
      out=null_out())
    try :
      assert (n_seq == 4)
    finally :
      os.remove(seq_file)

def test_modified_residues():
  # modified amino acid example from 1e0z
  seq_str1 = """\
>pdb|1e0z|A
PTVEYLNYETLDDQGWDMDDDDLFEKAADAGLDGEDYGTMEVAEGEYILEAAEAQGYDWPFSCRAGACANCASIVKEG
EIDMDMQQILSDEEVEEKDVRLTCIGSPAADEVKIVYNAKHLDYLQNRVI
"""
  pdb_str1 = """\
HETATM 1707  OH  ALY A 118       9.253 -11.285  16.293  1.00  0.00           O
HETATM 1708  CH  ALY A 118       8.541 -10.835  15.417  1.00  0.00           C
HETATM 1709  CH3 ALY A 118       8.924  -9.562  14.659  1.00  0.00           C
HETATM 1710  NZ  ALY A 118       7.420 -11.417  15.087  1.00 50.00           N
HETATM 1711  CE  ALY A 118       7.573 -12.895  15.202  1.00 50.00           C
HETATM 1712  CD  ALY A 118       6.273 -13.470  14.634  1.00 12.50           C
HETATM 1713  CG  ALY A 118       5.506 -14.188  15.746  1.00 12.50           C
HETATM 1714  CB  ALY A 118       6.259 -15.458  16.148  1.00 12.50           C
HETATM 1715  CA  ALY A 118       5.885 -15.846  17.580  1.00 12.50           C
HETATM 1716  N   ALY A 118       4.407 -15.666  17.660  1.00 12.50           N
HETATM 1717  C   ALY A 118       6.576 -14.924  18.588  1.00 12.50           C
HETATM 1718  O   ALY A 118       7.674 -15.190  19.036  1.00 12.50           O
HETATM 1719 HH31 ALY A 118       9.665  -9.016  15.224  1.00  0.00           H
HETATM 1720 HH32 ALY A 118       8.047  -8.945  14.525  1.00  0.00           H
HETATM 1721 HH33 ALY A 118       9.329  -9.826  13.694  1.00  0.00           H
HETATM 1722  HE3 ALY A 118       7.690 -13.181  16.237  1.00  0.00           H
HETATM 1723  HE2 ALY A 118       8.419 -13.232  14.620  1.00  0.00           H
HETATM 1724  HD3 ALY A 118       6.503 -14.171  13.845  1.00  0.00           H
HETATM 1725  HD2 ALY A 118       5.667 -12.668  14.239  1.00  0.00           H
HETATM 1726  HG3 ALY A 118       4.520 -14.451  15.392  1.00  0.00           H
HETATM 1727  HG2 ALY A 118       5.419 -13.535  16.602  1.00  0.00           H
HETATM 1728  HB3 ALY A 118       7.323 -15.279  16.091  1.00  0.00           H
HETATM 1729  HB2 ALY A 118       5.994 -16.261  15.477  1.00  0.00           H
HETATM 1730  HCA ALY A 118       6.150 -16.875  17.765  1.00  0.00           H
HETATM 1731  H   ALY A 118       3.878 -15.580  16.839  1.00 99.00           H
"""
  # modified nucleic acid example from 4eec
  seq_str2 = """\
>4EEC_1|Chains A,B|StaL|Streptomyces toyocaensis (55952)
MGSSHHHHHHSSGLVPRGSMCWIASYPKAGGHWLRCMLTSYVTGEPVETWPGIQAGVPHLEGLLRDGEAPSADPDEQV
LLATHFTADRPVLRFYRESTAKVVCLIRNPRDAMLSLMRMKGIPPEDVEACRKIAETFIADEGFSSVRIWAGEGSWPE
NIRSWTDSVHESFPNAAVLAVRYEDLRKDPEGELWKVVDFLELGGRDGVADAVANCTLERMREMEERSKLLGLETTGL
MTRGGKQLPFVGKGGQRKSLKFMGDDIEKAYADLLHGETDFAHYARLYGYAE
>4EEC_2|Chain C|desulfo-A47934|Streptomyces toyocaensis (55952)
GXXGXXX
"""
  pdb_str2 = """\
HETATM 3866  P1  A3P A 301     -32.928   0.112  -1.515  1.00 60.90           P
HETATM 3867  O1P A3P A 301     -32.567   0.971  -2.721  1.00 58.74           O
HETATM 3868  O2P A3P A 301     -33.836  -1.041  -1.926  1.00 60.18           O
HETATM 3869  O3P A3P A 301     -33.351   0.858  -0.247  1.00 59.07           O
HETATM 3870  P2  A3P A 301     -26.843  -0.504   2.943  1.00 61.59           P
HETATM 3871  O4P A3P A 301     -25.377  -0.388   2.609  1.00 57.50           O
HETATM 3872  O5P A3P A 301     -27.164  -1.892   3.467  1.00 62.98           O
HETATM 3873  O6P A3P A 301     -27.445   0.681   3.730  1.00 62.21           O
HETATM 3874  O5' A3P A 301     -27.694  -0.432   1.563  1.00 60.14           O
HETATM 3875  C5' A3P A 301     -29.109  -0.472   1.636  1.00 57.46           C
HETATM 3876  C4' A3P A 301     -29.649  -0.859   0.288  1.00 58.10           C
HETATM 3877  O4' A3P A 301     -29.334  -2.235   0.029  1.00 59.74           O
HETATM 3878  C3' A3P A 301     -31.164  -0.780   0.284  1.00 58.44           C
HETATM 3879  O3' A3P A 301     -31.539  -0.556  -1.069  1.00 59.37           O
HETATM 3880  C2' A3P A 301     -31.538  -2.197   0.626  1.00 58.35           C
HETATM 3881  O2' A3P A 301     -32.890  -2.542   0.343  1.00 58.12           O
HETATM 3882  C1' A3P A 301     -30.561  -2.939  -0.264  1.00 58.48           C
HETATM 3883  N9  A3P A 301     -30.576  -4.401   0.059  1.00 58.16           N
HETATM 3884  C8  A3P A 301     -30.559  -4.926   1.312  1.00 57.04           C
HETATM 3885  N7  A3P A 301     -30.604  -6.285   1.255  1.00 57.35           N
HETATM 3886  C5  A3P A 301     -30.645  -6.664  -0.042  1.00 55.60           C
HETATM 3887  C6  A3P A 301     -30.683  -7.957  -0.767  1.00 54.29           C
HETATM 3888  N6  A3P A 301     -30.686  -9.129  -0.066  1.00 54.08           N
HETATM 3889  N1  A3P A 301     -30.706  -7.913  -2.130  1.00 53.41           N
HETATM 3890  C2  A3P A 301     -30.703  -6.743  -2.815  1.00 52.74           C
HETATM 3891  N3  A3P A 301     -30.659  -5.530  -2.220  1.00 53.74           N
HETATM 3892  C4  A3P A 301     -30.631  -5.420  -0.849  1.00 56.63           C
"""

  for pdb_str, seq_str in [(pdb_str1, seq_str1), (pdb_str2, seq_str2)]:
    seq_file = tempfile.NamedTemporaryFile(suffix='.fasta', mode='w')
    seq_file.write(seq_str)
    seq_file.flush()
    model_file = tempfile.NamedTemporaryFile(suffix='.pdb', mode='w')
    model_file.write(pdb_str)
    model_file.flush()
    dm = DataManager()
    dm.process_model_file(model_file.name)
    dm.process_sequence_file(seq_file.name)
    model = dm.get_model()
    seq = dm.get_sequence()
    model.set_sequences(seq)
    model_file.close()
    seq_file.close()
    # model._sequence_validation.show()

if (__name__ == "__main__"):
  exercise()
  test_modified_residues()
  print("OK")


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_sort_hetatms.py

from __future__ import absolute_import, division, print_function
from mmtbx.command_line import sort_hetatms
import iotbx.pdb
from six.moves import cStringIO as StringIO
import os.path as op
import os

def exercise():
  pdb_raw = """\
CRYST1   21.937    4.866   23.477  90.00 107.08  90.00 P 1 21 1      2
ATOM      1  N   GLY A   1      -9.009   4.612   6.102  1.00 16.77           N
ATOM      2  CA  GLY A   1      -9.052   4.207   4.651  1.00 16.57           C
ATOM      3  C   GLY A   1      -8.015   3.140   4.419  1.00 16.16           C
ATOM      4  O   GLY A   1      -7.523   2.521   5.381  1.00 16.78           O
ATOM      5  N   ASN A   2      -7.656   2.923   3.155  1.00 15.02           N
ATOM      6  CA  ASN A   2      -6.522   2.038   2.831  1.00 14.10           C
ATOM      7  C   ASN A   2      -5.241   2.537   3.427  1.00 13.13           C
ATOM      8  O   ASN A   2      -4.978   3.742   3.426  1.00 11.91           O
ATOM      9  CB  ASN A   2      -6.346   1.881   1.341  1.00 15.38           C
ATOM     10  CG  ASN A   2      -7.584   1.342   0.692  1.00 14.08           C
ATOM     11  OD1 ASN A   2      -8.025   0.227   1.016  1.00 17.46           O
ATOM     12  ND2 ASN A   2      -8.204   2.155  -0.169  1.00 11.72           N
ATOM     13  N   ASN A   3      -4.438   1.590   3.905  1.00 12.26           N
ATOM     14  CA  ASN A   3      -3.193   1.904   4.589  1.00 11.74           C
ATOM     15  C   ASN A   3      -1.955   1.332   3.895  1.00 11.10           C
ATOM     16  O   ASN A   3      -1.872   0.119   3.648  1.00 10.42           O
ATOM     17  CB  ASN A   3      -3.259   1.378   6.042  1.00 12.15           C
ATOM     18  CG  ASN A   3      -2.006   1.739   6.861  1.00 12.82           C
ATOM     19  OD1 ASN A   3      -1.702   2.925   7.072  1.00 15.05           O
ATOM     20  ND2 ASN A   3      -1.271   0.715   7.306  1.00 13.48           N
ATOM     21  N   GLN A   4      -1.005   2.228   3.598  1.00 10.29           N
ATOM     22  CA  GLN A   4       0.384   1.888   3.199  1.00 10.53           C
ATOM     23  C   GLN A   4       1.435   2.606   4.088  1.00 10.24           C
ATOM     24  O   GLN A   4       1.547   3.843   4.115  1.00  8.86           O
ATOM     25  CB  GLN A   4       0.656   2.148   1.711  1.00  9.80           C
ATOM     26  CG  GLN A   4       1.944   1.458   1.213  1.00 10.25           C
ATOM     27  CD  GLN A   4       2.504   2.044  -0.089  1.00 12.43           C
ATOM     28  OE1 GLN A   4       2.744   3.268  -0.190  1.00 14.62           O
ATOM     29  NE2 GLN A   4       2.750   1.161  -1.091  1.00  9.05           N
TER
ATOM     30  N   GLN B   1       2.154   1.821   4.871  1.00 10.38           N
ATOM     31  CA  GLN B   1       3.270   2.361   5.640  1.00 11.39           C
ATOM     32  C   GLN B   1       4.594   1.768   5.172  1.00 11.52           C
ATOM     33  O   GLN B   1       4.768   0.546   5.054  1.00 12.05           O
ATOM     34  CB  GLN B   1       3.056   2.183   7.147  1.00 11.96           C
ATOM     35  CG  GLN B   1       1.829   2.950   7.647  1.00 10.81           C
ATOM     36  CD  GLN B   1       1.344   2.414   8.954  1.00 13.10           C
ATOM     37  OE1 GLN B   1       0.774   1.325   9.002  1.00 10.65           O
ATOM     38  NE2 GLN B   1       1.549   3.187  10.039  1.00 12.30           N
ATOM     39  N   ASN B   2       5.514   2.664   4.856  1.00 11.99           N
ATOM     40  CA  ASN B   2       6.831   2.310   4.318  1.00 12.30           C
ATOM     41  C   ASN B   2       7.854   2.761   5.324  1.00 13.40           C
ATOM     42  O   ASN B   2       8.219   3.943   5.374  1.00 13.92           O
ATOM     43  CB  ASN B   2       7.065   3.016   2.993  1.00 12.13           C
ATOM     44  CG  ASN B   2       5.961   2.735   2.003  1.00 12.77           C
ATOM     45  OD1 ASN B   2       5.798   1.604   1.551  1.00 14.27           O
ATOM     46  ND2 ASN B   2       5.195   3.747   1.679  1.00 10.07           N
ATOM     47  N   TYR B   3       8.292   1.817   6.147  1.00 14.70           N
ATOM     48  CA  TYR B   3       9.159   2.144   7.299  1.00 15.18           C
ATOM     49  C   TYR B   3      10.603   2.331   6.885  1.00 15.91           C
ATOM     50  O   TYR B   3      11.041   1.811   5.855  1.00 15.76           O
ATOM     51  CB  TYR B   3       9.061   1.065   8.369  1.00 15.35           C
ATOM     52  CG  TYR B   3       7.665   0.929   8.902  1.00 14.45           C
ATOM     53  CD1 TYR B   3       6.771   0.021   8.327  1.00 15.68           C
ATOM     54  CD2 TYR B   3       7.210   1.756   9.920  1.00 14.80           C
ATOM     55  CE1 TYR B   3       5.480  -0.094   8.796  1.00 13.46           C
ATOM     56  CE2 TYR B   3       5.904   1.649  10.416  1.00 14.33           C
ATOM     57  CZ  TYR B   3       5.047   0.729   9.831  1.00 15.09           C
ATOM     58  OH  TYR B   3       3.766   0.589  10.291  1.00 14.39           O
ATOM     59  OXT TYR B   3      11.358   2.999   7.612  1.00 17.49           O
TER
HETATM   61  O   HOH A   8      -6.471   5.227   7.124  1.00 22.62           O
HETATM   62  O   HOH A   9      10.431   1.858   3.216  1.00 19.71           O
HETATM   63  O   HOH A  10     -11.286   1.756  -1.468  1.00 17.08           O
HETATM   64  O   HOH A  11      11.808   4.179   9.970  1.00 23.99           O
HETATM   65  O   HOH A  12      13.605   1.327   9.198  1.00 26.17           O
HETATM   66  O   HOH A  13      -2.749   3.429  10.024  1.00 39.15           O
HETATM   67  O   HOH A  14      -1.500   0.682  10.967  1.00 43.49           O
END
"""
  pdb_file = "unsorted.pdb"
  with open(pdb_file, "w") as f:
    f.write(pdb_raw)
  if (op.exists("unsorted_sorted.pdb")):
    os.remove("unsorted_sorted.pdb")
  out = StringIO()
  sort_hetatms.run(
    args=[pdb_file, "--verbose"],
    out=out)
  assert ("""Residue group pdb=" O   HOH    10 " added to chain A (distance = 2.814, symop = -x-1,y-1/2,-z)""" in out.getvalue())
  hierarchy = iotbx.pdb.input("unsorted_sorted.pdb").construct_hierarchy()
  chains = hierarchy.models()[0].chains()
  assert (len(chains) == 4)
  rgsA = chains[-2].residue_groups()
  rgsB = chains[-1].residue_groups()
  assert (len(rgsA) == 3) and (len(rgsB) == 4)
  sort_hetatms.run(
    args=[pdb_file, "preserve_chain_id=True", "renumber=False"],
    out=StringIO())
  hierarchy = iotbx.pdb.input("unsorted_sorted.pdb").construct_hierarchy()
  chains = hierarchy.models()[0].chains()
  assert (len(chains) == 3)
  assert (chains[-1].id == "A")
  pdb_raw2 = """\
CRYST1   21.937   10.000   23.477  90.00 107.08  90.00 P 1 21 1      2
ATOM      1  N   GLY A   1      -9.009   4.612   6.102  1.00 16.77           N
ATOM      2  CA  GLY A   1      -9.052   4.207   4.651  1.00 16.57           C
ATOM      3  C   GLY A   1      -8.015   3.140   4.419  1.00 16.16           C
ATOM      4  O   GLY A   1      -7.523   2.521   5.381  1.00 16.78           O
ATOM      5  N   ASN A   2      -7.656   2.923   3.155  1.00 15.02           N
ATOM      6  CA  ASN A   2      -6.522   2.038   2.831  1.00 14.10           C
ATOM      7  C   ASN A   2      -5.241   2.537   3.427  1.00 13.13           C
ATOM      8  O   ASN A   2      -4.978   3.742   3.426  1.00 11.91           O
ATOM      9  CB  ASN A   2      -6.346   1.881   1.341  1.00 15.38           C
ATOM     10  CG  ASN A   2      -7.584   1.342   0.692  1.00 14.08           C
ATOM     11  OD1 ASN A   2      -8.025   0.227   1.016  1.00 17.46           O
ATOM     12  ND2 ASN A   2      -8.204   2.155  -0.169  1.00 11.72           N
ATOM     13  N   ASN A   3      -4.438   1.590   3.905  1.00 12.26           N
ATOM     14  CA  ASN A   3      -3.193   1.904   4.589  1.00 11.74           C
ATOM     15  C   ASN A   3      -1.955   1.332   3.895  1.00 11.10           C
ATOM     16  O   ASN A   3      -1.872   0.119   3.648  1.00 10.42           O
ATOM     17  CB  ASN A   3      -3.259   1.378   6.042  1.00 12.15           C
ATOM     18  CG  ASN A   3      -2.006   1.739   6.861  1.00 12.82           C
ATOM     19  OD1 ASN A   3      -1.702   2.925   7.072  1.00 15.05           O
ATOM     20  ND2 ASN A   3      -1.271   0.715   7.306  1.00 13.48           N
TER      21      ASN A   3
HETATM   61  O   HOH A   8      -6.471   5.227   7.124  1.00 22.62           O
HETATM   62  O   HOH A   9      10.431   1.858   3.216  1.00 19.71           O
HETATM   63  O   HOH A  10     -11.286   1.756  -1.468  1.00 17.08           O
HETATM   64  O   HOH A  11       6.127   3.965  10.368  1.00 23.99           O
HETATM   65  O   HOH A  12      13.605   1.327   9.198  1.00 26.17           O
HETATM   66  O   HOH A  13      -2.749   3.429  10.024  1.00 39.15           O
HETATM   67  O   HOH A  14      -1.500   0.682  10.967  1.00 43.49           O
END
"""
  pdb_file = "unsorted2.pdb"
  with open(pdb_file, "w") as f:
    f.write(pdb_raw2)
  if (op.exists("unsorted2_sorted.pdb")):
    os.remove("unsorted2_sorted.pdb")
  out = StringIO()
  sort_hetatms.run(
    args=[pdb_file, "--verbose", "--remove_waters_outside_radius"],
    out=out)
  assert ("Water     11  is not near any polymer chain, will delete" in
          out.getvalue())
  out = StringIO()
  sort_hetatms.run(
    args=[pdb_file, "--verbose",],
    out=out)
  assert ("Residue group A   11  is not near any macromolecule chain" in
          out.getvalue())
  pdb_raw = """\
HEADER    LIGASE                                  31-AUG-98   1BS2
CRYST1  100.374  100.374  204.341  90.00  90.00  90.00 P 43 21 2     8
ATOM   1094  N   LYS A 143      22.992  81.325 -18.373  1.00 63.31           N
ATOM   1095  CA  LYS A 143      24.003  82.214 -18.922  1.00 53.83           C
ATOM   1096  C   LYS A 143      24.725  81.433 -20.002  1.00 49.46           C
ATOM   1097  O   LYS A 143      25.026  80.249 -19.833  1.00 48.59           O
ATOM   1098  CB  LYS A 143      24.980  82.658 -17.835  1.00 58.17           C
ATOM   1099  CG  LYS A 143      24.831  84.114 -17.432  1.00 65.92           C
ATOM   1100  CD  LYS A 143      23.422  84.434 -16.967  1.00 69.21           C
ATOM   1101  CE  LYS A 143      23.253  85.929 -16.742  1.00 67.51           C
ATOM   1102  NZ  LYS A 143      21.905  86.254 -16.193  1.00 74.33           N
ATOM   1103  N   LYS A 144      24.985  82.095 -21.120  1.00 46.52           N
ATOM   1104  CA  LYS A 144      25.641  81.453 -22.246  1.00 48.43           C
ATOM   1105  C   LYS A 144      26.946  82.162 -22.583  1.00 49.19           C
ATOM   1106  O   LYS A 144      27.014  83.395 -22.623  1.00 47.13           O
ATOM   1107  CB  LYS A 144      24.704  81.475 -23.458  1.00 55.29           C
ATOM   1108  CG  LYS A 144      25.183  80.676 -24.659  1.00 63.36           C
ATOM   1109  CD  LYS A 144      24.334  80.964 -25.899  1.00 61.42           C
ATOM   1110  CE  LYS A 144      22.874  80.579 -25.705  1.00 58.72           C
ATOM   1111  NZ  LYS A 144      22.078  80.793 -26.946  1.00 61.59           N
ATOM   1112  N   VAL A 145      27.986  81.373 -22.819  1.00 42.70           N
ATOM   1113  CA  VAL A 145      29.280  81.932 -23.158  1.00 38.93           C
ATOM   1114  C   VAL A 145      29.869  81.233 -24.374  1.00 40.05           C
ATOM   1115  O   VAL A 145      29.715  80.021 -24.553  1.00 45.68           O
ATOM   1116  CB  VAL A 145      30.274  81.815 -21.972  1.00 30.33           C
ATOM   1117  CG1 VAL A 145      30.431  80.356 -21.569  1.00 35.25           C
ATOM   1118  CG2 VAL A 145      31.627  82.424 -22.351  1.00 15.32           C
ATOM   1119  N   ILE A 146      30.519  82.013 -25.225  1.00 36.19           N
ATOM   1120  CA  ILE A 146      31.157  81.457 -26.399  1.00 42.19           C
ATOM   1121  C   ILE A 146      32.640  81.522 -26.106  1.00 46.89           C
ATOM   1122  O   ILE A 146      33.161  82.577 -25.735  1.00 42.54           O
ATOM   1123  CB  ILE A 146      30.886  82.283 -27.666  1.00 43.82           C
ATOM   1124  CG1 ILE A 146      29.406  82.226 -28.030  1.00 46.47           C
ATOM   1125  CG2 ILE A 146      31.723  81.741 -28.816  1.00 39.50           C
ATOM   1126  CD1 ILE A 146      29.048  83.115 -29.197  1.00 46.73           C
ATOM   1127  N   ILE A 147      33.311  80.387 -26.250  1.00 47.64           N
ATOM   1128  CA  ILE A 147      34.740  80.323 -26.019  1.00 47.32           C
ATOM   1129  C   ILE A 147      35.406  79.905 -27.326  1.00 49.89           C
ATOM   1130  O   ILE A 147      35.276  78.766 -27.777  1.00 46.22           O
ATOM   1131  CB  ILE A 147      35.078  79.325 -24.887  1.00 43.61           C
ATOM   1132  CG1 ILE A 147      34.402  79.775 -23.586  1.00 40.57           C
ATOM   1133  CG2 ILE A 147      36.585  79.257 -24.688  1.00 40.81           C
ATOM   1134  CD1 ILE A 147      34.584  78.825 -22.424  1.00 34.81           C
ATOM   1135  N   GLU A 148      36.102  80.855 -27.940  1.00 49.93           N
ATOM   1136  CA  GLU A 148      36.788  80.613 -29.199  1.00 50.03           C
ATOM   1137  C   GLU A 148      38.263  80.328 -28.913  1.00 44.28           C
ATOM   1138  O   GLU A 148      38.943  81.145 -28.301  1.00 43.55           O
ATOM   1139  CB  GLU A 148      36.646  81.846 -30.106  1.00 47.09           C
ATOM   1140  CG  GLU A 148      37.243  81.679 -31.489  1.00 40.60           C
ATOM   1141  CD  GLU A 148      37.982  82.916 -31.943  1.00 48.19           C
ATOM   1142  OE1 GLU A 148      37.324  83.935 -32.246  1.00 52.87           O
ATOM   1143  OE2 GLU A 148      39.228  82.873 -31.982  1.00 45.83           O
ATOM   1144  N   PHE A 149      38.754  79.172 -29.347  1.00 37.67           N
ATOM   1145  CA  PHE A 149      40.147  78.828 -29.106  1.00 39.79           C
ATOM   1146  C   PHE A 149      40.775  77.925 -30.159  1.00 42.70           C
ATOM   1147  O   PHE A 149      40.079  77.314 -30.966  1.00 45.66           O
ATOM   1148  CB  PHE A 149      40.305  78.199 -27.718  1.00 37.53           C
ATOM   1149  CG  PHE A 149      39.387  77.039 -27.461  1.00 33.29           C
ATOM   1150  CD1 PHE A 149      38.009  77.226 -27.387  1.00 29.22           C
ATOM   1151  CD2 PHE A 149      39.903  75.760 -27.270  1.00 28.26           C
ATOM   1152  CE1 PHE A 149      37.156  76.154 -27.124  1.00 26.87           C
ATOM   1153  CE2 PHE A 149      39.062  74.681 -27.006  1.00 29.29           C
ATOM   1154  CZ  PHE A 149      37.683  74.879 -26.934  1.00 30.14           C
ATOM   1155  N   SER A 150      42.106  77.852 -30.120  1.00 44.78           N
ATOM   1156  CA  SER A 150      42.924  77.077 -31.057  1.00 38.94           C
ATOM   1157  C   SER A 150      42.996  77.839 -32.378  1.00 35.66           C
ATOM   1158  O   SER A 150      44.039  78.374 -32.718  1.00 38.02           O
ATOM   1159  CB  SER A 150      42.353  75.676 -31.283  1.00 32.93           C
ATOM   1160  OG  SER A 150      43.261  74.895 -32.047  1.00 31.61           O
ATOM   1161  N   SER A 151      41.879  77.879 -33.104  1.00 36.86           N
ATOM   1162  CA  SER A 151      41.745  78.598 -34.377  1.00 32.32           C
ATOM   1163  C   SER A 151      42.958  78.629 -35.304  1.00 36.45           C
ATOM   1164  O   SER A 151      43.531  79.692 -35.565  1.00 35.55           O
ATOM   1165  CB  SER A 151      41.305  80.038 -34.107  1.00 27.79           C
ATOM   1166  OG  SER A 151      40.065  80.069 -33.429  1.00 35.13           O
ATOM   1167  N   PRO A 152      43.356  77.468 -35.836  1.00 40.61           N
ATOM   1168  CA  PRO A 152      44.512  77.444 -36.736  1.00 42.49           C
ATOM   1169  C   PRO A 152      44.150  77.973 -38.125  1.00 42.14           C
ATOM   1170  O   PRO A 152      42.991  78.288 -38.397  1.00 40.80           O
ATOM   1171  CB  PRO A 152      44.883  75.968 -36.760  1.00 42.76           C
ATOM   1172  CG  PRO A 152      43.534  75.304 -36.693  1.00 42.42           C
ATOM   1173  CD  PRO A 152      42.812  76.112 -35.631  1.00 39.19           C
ATOM   1174  N   ASN A 153      45.148  78.086 -38.993  1.00 44.89           N
ATOM   1175  CA  ASN A 153      44.921  78.542 -40.362  1.00 45.11           C
ATOM   1176  C   ASN A 153      45.092  77.307 -41.232  1.00 46.15           C
ATOM   1177  O   ASN A 153      45.996  76.502 -41.003  1.00 50.16           O
ATOM   1178  CB  ASN A 153      45.951  79.592 -40.770  1.00 45.30           C
ATOM   1179  CG  ASN A 153      46.044  80.729 -39.781  1.00 43.47           C
ATOM   1180  OD1 ASN A 153      45.093  81.487 -39.590  1.00 46.50           O
ATOM   1181  ND2 ASN A 153      47.196  80.853 -39.143  1.00 33.35           N
TER    4875      MET A 607
HETATM 4876  N   ARG X 900      43.972  82.052 -36.884  1.00 37.31           N
HETATM 4877  CA  ARG X 900      44.639  83.205 -36.209  1.00 43.51           C
HETATM 4878  C   ARG X 900      46.150  83.005 -36.147  1.00 44.70           C
HETATM 4879  O   ARG X 900      46.842  83.928 -35.666  1.00 51.15           O
HETATM 4880  CB  ARG X 900      44.080  83.392 -34.788  1.00 31.47           C
HETATM 4881  CG  ARG X 900      42.619  83.803 -34.755  1.00 31.50           C
HETATM 4882  CD  ARG X 900      42.116  83.982 -33.337  1.00 38.70           C
HETATM 4883  NE  ARG X 900      40.700  84.343 -33.288  1.00 42.91           N
HETATM 4884  CZ  ARG X 900      40.206  85.521 -33.660  1.00 48.35           C
HETATM 4885  NH1 ARG X 900      41.014  86.471 -34.114  1.00 45.64           N
HETATM 4886  NH2 ARG X 900      38.899  85.751 -33.584  1.00 46.85           N
HETATM 4887  OXT ARG X 900      46.623  81.932 -36.581  1.00 42.67           O
HETATM 4963  O   HOH X 976      48.036  82.421 -33.012  1.00 30.31           O
HETATM 4964  O   HOH X 977      44.190  81.253 -31.435  1.00 48.82           O
HETATM 4965  O   HOH X 978      41.198  81.209 -30.407  1.00 48.77           O
"""
  pdb_file = "unsorted3.pdb"
  with open(pdb_file, "w") as f:
    f.write(pdb_raw)
  if (op.exists("unsorted3_sorted.pdb")):
    os.remove("unsorted3_sorted.pdb")
  out = StringIO()
  sort_hetatms.run(
    args=[pdb_file, "--verbose",],
    out=out)
  assert op.isfile("unsorted3_sorted.pdb")
  hierarchy = iotbx.pdb.input("unsorted3_sorted.pdb").construct_hierarchy()
  for atom in hierarchy.atoms():
    assert atom.fetch_labels().chain_id == "A"
  # now with ARG ligand minus waters, but still flagged as HETATM
  pdb_in = iotbx.pdb.input("unsorted3.pdb")
  hierarchy = pdb_in.construct_hierarchy()
  sel_str = "not resname HOH"
  sel_cache = hierarchy.atom_selection_cache()
  sel = sel_cache.selection(sel_str)
  hierarchy_new = hierarchy.select(sel)
  with open("unsorted4.pdb", "w") as f:
    f.write(hierarchy_new.as_pdb_string(
      crystal_symmetry=pdb_in.crystal_symmetry()))
  if (op.exists("unsorted4_sorted.pdb")):
    os.remove("unsorted4_sorted.pdb")
  out = StringIO()
  sort_hetatms.run(
    args=["unsorted4.pdb", "--verbose",],
    out=out)
  assert op.isfile("unsorted4_sorted.pdb")
  hierarchy = iotbx.pdb.input("unsorted4_sorted.pdb").construct_hierarchy()
  for atom in hierarchy.atoms():
    assert atom.fetch_labels().chain_id == "A"
  print("OK")

if (__name__ == "__main__"):
  exercise()


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_special_term_at_end.py
from __future__ import absolute_import, division, print_function
import sys
import mmtbx.model
from iotbx import pdb
from libtbx.utils import null_out

pdb_str = '''
CRYST1   74.901   73.950   81.107  90.00  90.00  90.00 P 1
SCALE1      0.013351  0.000000  0.000000        0.00000
SCALE2      0.000000  0.013523  0.000000        0.00000
SCALE3      0.000000  0.000000  0.012329        0.00000
ATOM      1  N   ALA A  10      20.479  70.180  20.146  1.00 35.17           N
ATOM      2  CA  ALA A  10      21.143  71.035  21.111  1.00 34.92           C
ATOM      3  C   ALA A  10      21.840  70.184  22.154  1.00 43.85           C
ATOM      4  O   ALA A  10      21.298  69.164  22.607  1.00 46.47           O
ATOM      5  CB  ALA A  10      20.146  71.953  21.787  1.00 44.05           C
ATOM      6  H   ALA A  10      19.794  69.554  20.569  0.00 35.17           H
ATOM      7  HA  ALA A  10      21.895  71.643  20.608  0.00 34.92           H
ATOM      8  HB1 ALA A  10      20.673  72.582  22.505  0.00 44.05           H
ATOM      9  HB2 ALA A  10      19.666  72.574  21.031  0.00 44.05           H
ATOM     10  HB3 ALA A  10      19.399  71.348  22.301  0.00 44.05           H
TER
ATOM         H2  ALA A  10      20.046  70.688  19.542  1.00 35.17           H
TER
ATOM         HC  ALA A  10      22.748  70.442  22.485  1.00 43.85           H
'''

def main(filename=None):
  if filename is None:
    filename = 'ala_term.pdb'
    with open(filename, 'w') as f:
      f.write(pdb_str)
  pdb_inp = pdb.input(filename)
  hierarchy = pdb_inp.construct_hierarchy()
  params = mmtbx.model.manager.get_default_pdb_interpretation_params()
  params.pdb_interpretation.use_neutron_distances = True
  params.pdb_interpretation.restraints_library.cdl = False
  print(len(hierarchy.atoms()))
  asc = hierarchy.atom_selection_cache()
  sel = asc.selection("element H or element D")
  print('sel len',len(sel))
  print(len(hierarchy.atoms()))
  hierarchy.show()

  model = mmtbx.model.manager(
    model_input               = None,
    pdb_hierarchy             = hierarchy,
    crystal_symmetry          = pdb_inp.crystal_symmetry(),
    log                       = null_out(),
    )
  print('m1',len(model.get_hierarchy().atoms()))
  for atom in model.get_hierarchy().atoms(): print(atom.format_atom_record())
  model.process(make_restraints=True,
                grm_normalization=True,
                pdb_interpretation_params = params)
  print('m2',len(model.get_hierarchy().atoms()))
  for atom in model.get_hierarchy().atoms(): print(atom.format_atom_record())
  model.idealize_h_riding()
  model.set_occupancies(0., selection=sel)

if __name__ == '__main__':
  main(*tuple(sys.argv[1:]))


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_statistics_output.py
from __future__ import absolute_import, division, print_function
import iotbx.pdb
import mmtbx.model.statistics
from six.moves import cStringIO as StringIO
from libtbx.utils import null_out
import mmtbx.model

pdb_str = """\
CRYST1   75.460  158.580   93.580  90.00  90.00  90.00 C 2 2 21
SCALE1      0.013252  0.000000  0.000000        0.00000
SCALE2      0.000000  0.006306  0.000000        0.00000
SCALE3      0.000000  0.000000  0.010686        0.00000
ATOM      1  N   THR A   7     -22.717 -50.890   5.476  1.00141.14           N
ATOM      2  CA  THR A   7     -23.899 -50.050   5.310  1.00136.21           C
ATOM      3  C   THR A   7     -23.861 -48.839   6.242  1.00132.81           C
ATOM      4  O   THR A   7     -24.260 -48.928   7.404  1.00131.01           O
ATOM      5  CB  THR A   7     -25.193 -50.847   5.568  1.00134.75           C
ATOM      6  OG1 THR A   7     -25.230 -51.272   6.936  1.00136.94           O
ATOM      7  CG2 THR A   7     -25.257 -52.066   4.659  1.00137.71           C
ATOM      8  N   ILE A   8     -23.387 -47.709   5.725  1.00131.81           N
ATOM      9  CA  ILE A   8     -23.246 -46.495   6.526  1.00131.70           C
ATOM     10  C   ILE A   8     -24.367 -45.494   6.208  1.00126.04           C
ATOM     11  O   ILE A   8     -24.786 -45.359   5.057  1.00127.64           O
ATOM     12  CB  ILE A   8     -21.849 -45.850   6.305  1.00122.41           C
ATOM     13  CG1 ILE A   8     -21.569 -44.758   7.340  1.00110.30           C
ATOM     14  CG2 ILE A   8     -21.697 -45.333   4.877  1.00128.50           C
ATOM     15  CD1 ILE A   8     -20.114 -44.324   7.369  1.00107.55           C
ATOM     16  N   SER A   9     -24.860 -44.808   7.238  1.00118.07           N
ATOM     17  CA  SER A   9     -26.035 -43.945   7.109  1.00115.52           C
ATOM     18  C   SER A   9     -25.681 -42.514   6.708  1.00109.50           C
ATOM     19  O   SER A   9     -24.673 -41.971   7.156  1.00109.49           O
ATOM     20  CB  SER A   9     -26.821 -43.925   8.421  1.00113.58           C
ATOM     21  OG  SER A   9     -26.071 -43.309   9.452  1.00110.08           O
ATOM     22  N   GLY A  10     -26.523 -41.900   5.881  1.00103.14           N
ATOM     23  CA  GLY A  10     -26.266 -40.558   5.384  1.00 92.45           C
ATOM     24  C   GLY A  10     -26.310 -39.481   6.451  1.00 84.77           C
ATOM     25  O   GLY A  10     -26.826 -39.700   7.547  1.00 77.99           O
ATOM     26  N   VAL A  11     -25.753 -38.316   6.134  1.00 71.51           N
ATOM     27  CA  VAL A  11     -25.857 -37.162   7.016  1.00 69.96           C
ATOM     28  C   VAL A  11     -27.212 -36.488   6.816  1.00 72.87           C
ATOM     29  O   VAL A  11     -27.539 -36.029   5.721  1.00 72.60           O
ATOM     30  CB  VAL A  11     -24.713 -36.145   6.780  1.00 74.36           C
ATOM     31  CG1 VAL A  11     -24.429 -35.982   5.291  1.00 93.11           C
ATOM     32  CG2 VAL A  11     -25.045 -34.808   7.429  1.00 70.19           C
ATOM     33  N   THR A  12     -28.006 -36.453   7.880  1.00 67.58           N
ATOM     34  CA  THR A  12     -29.359 -35.919   7.810  1.00 56.36           C
ATOM     35  C   THR A  12     -29.386 -34.419   8.081  1.00 56.13           C
ATOM     36  O   THR A  12     -28.861 -33.957   9.093  1.00 52.01           O
ATOM     37  CB  THR A  12     -30.285 -36.629   8.808  1.00 66.11           C
ATOM     38  OG1 THR A  12     -30.238 -38.043   8.581  1.00 70.25           O
ATOM     39  CG2 THR A  12     -31.709 -36.143   8.649  1.00 65.09           C
ATOM     40  N   PRO A  13     -29.997 -33.651   7.168  1.00 56.19           N
ATOM     41  CA  PRO A  13     -30.121 -32.203   7.348  1.00 51.55           C
ATOM     42  C   PRO A  13     -31.151 -31.828   8.412  1.00 49.07           C
ATOM     43  O   PRO A  13     -32.260 -32.367   8.429  1.00 51.23           O
ATOM     44  CB  PRO A  13     -30.561 -31.715   5.963  1.00 52.91           C
ATOM     45  CG  PRO A  13     -31.258 -32.884   5.363  1.00 59.36           C
ATOM     46  CD  PRO A  13     -30.530 -34.096   5.867  1.00 62.94           C
ATOM     47  N   VAL A  14     -30.769 -30.919   9.301  1.00 48.63           N
ATOM     48  CA  VAL A  14     -31.683 -30.370  10.289  1.00 46.07           C
ATOM     49  C   VAL A  14     -31.733 -28.864  10.081  1.00 41.16           C
ATOM     50  O   VAL A  14     -30.914 -28.114  10.615  1.00 47.97           O
ATOM     51  CB  VAL A  14     -31.254 -30.717  11.728  1.00 54.55           C
ATOM     52  CG1 VAL A  14     -32.167 -30.041  12.741  1.00 49.75           C
ATOM     53  CG2 VAL A  14     -31.267 -32.221  11.925  1.00 53.30           C
ATOM     54  N   ALA A  15     -32.688 -28.433   9.265  1.00 48.44           N
ATOM     55  CA  ALA A  15     -32.791 -27.035   8.878  1.00 48.71           C
ATOM     56  C   ALA A  15     -33.746 -26.288   9.793  1.00 44.49           C
ATOM     57  O   ALA A  15     -34.893 -26.698   9.981  1.00 56.01           O
ATOM     58  CB  ALA A  15     -33.241 -26.919   7.424  1.00 47.71           C
ATOM     59  N   VAL A  16     -33.258 -25.196  10.371  1.00 47.55           N
ATOM     60  CA  VAL A  16     -34.070 -24.359  11.244  1.00 51.32           C
ATOM     61  C   VAL A  16     -33.896 -22.898  10.849  1.00 51.13           C
ATOM     62  O   VAL A  16     -32.884 -22.527  10.255  1.00 53.69           O
ATOM     63  CB  VAL A  16     -33.694 -24.547  12.729  1.00 48.59           C
ATOM     64  CG1 VAL A  16     -33.883 -26.001  13.147  1.00 49.08           C
ATOM     65  CG2 VAL A  16     -32.261 -24.105  12.976  1.00 44.32           C
HETATM   66  N   MSE A  17     -34.886 -22.071  11.165  1.00 46.28           N
HETATM   67  CA  MSE A  17     -34.799 -20.648  10.861  1.00 51.69           C
HETATM   68  C   MSE A  17     -34.630 -19.811  12.117  1.00 49.49           C
HETATM   69  O   MSE A  17     -35.085 -20.191  13.196  1.00 58.95           O
HETATM   70  CB  MSE A  17     -36.041 -20.170  10.113  1.00 50.07           C
HETATM   71  CG  MSE A  17     -36.182 -20.707   8.709  1.00 76.34           C
HETATM   72 SE   MSE A  17     -37.379 -19.594   7.653  1.00 73.34          Se
HETATM   73  CE  MSE A  17     -36.261 -18.004   7.506  1.00 73.69           C
ATOM     74  N   THR A  18     -33.982 -18.662  11.967  1.00 53.24           N
ATOM     75  CA  THR A  18     -33.883 -17.707  13.060  1.00 61.39           C
ATOM     76  C   THR A  18     -35.062 -16.746  13.006  1.00 58.85           C
ATOM     77  O   THR A  18     -35.795 -16.708  12.018  1.00 53.50           O
ATOM     78  CB  THR A  18     -32.565 -16.925  13.011  1.00 71.15           C
ATOM     79  OG1 THR A  18     -32.433 -16.286  11.735  1.00 64.88           O
ATOM     80  CG2 THR A  18     -31.405 -17.873  13.214  1.00 70.61           C
ATOM     81  N   LYS A  19     -35.242 -15.977  14.074  1.00 54.96           N
ATOM     82  CA  LYS A  19     -36.374 -15.066  14.179  1.00 60.47           C
ATOM     83  C   LYS A  19     -36.300 -13.969  13.122  1.00 58.72           C
ATOM     84  O   LYS A  19     -35.214 -13.636  12.642  1.00 50.86           O
ATOM     85  CB  LYS A  19     -36.436 -14.448  15.581  1.00 58.87           C
ATOM     86  CG  LYS A  19     -35.279 -13.521  15.917  1.00 54.97           C
ATOM     87  CD  LYS A  19     -35.405 -12.998  17.344  1.00 59.63           C
ATOM     88  CE  LYS A  19     -34.270 -12.050  17.696  1.00 57.53           C
ATOM     89  NZ  LYS A  19     -34.391 -11.532  19.091  1.00 67.01           N
ATOM     90  N   PRO A  20     -37.461 -13.420  12.736  1.00 62.97           N
ATOM     91  CA  PRO A  20     -37.478 -12.268  11.832  1.00 64.92           C
ATOM     92  C   PRO A  20     -36.710 -11.091  12.424  1.00 62.14           C
ATOM     93  O   PRO A  20     -37.006 -10.652  13.535  1.00 62.63           O
ATOM     94  CB  PRO A  20     -38.970 -11.948  11.697  1.00 60.68           C
ATOM     95  CG  PRO A  20     -39.650 -13.246  11.965  1.00 61.23           C
ATOM     96  CD  PRO A  20     -38.819 -13.915  13.019  1.00 56.73           C
ATOM     97  N   LEU A  21     -35.724 -10.601  11.682  1.00 61.25           N
ATOM     98  CA  LEU A  21     -34.863  -9.520  12.147  1.00 65.78           C
ATOM     99  C   LEU A  21     -35.074  -8.255  11.324  1.00 73.45           C
ATOM    100  O   LEU A  21     -35.473  -8.328  10.162  1.00 78.02           O
ATOM    101  CB  LEU A  21     -33.396  -9.952  12.081  1.00 61.86           C
ATOM    102  CG  LEU A  21     -33.000 -11.138  12.959  1.00 69.12           C
ATOM    103  CD1 LEU A  21     -31.669 -11.712  12.507  1.00 75.44           C
ATOM    104  CD2 LEU A  21     -32.938 -10.720  14.421  1.00 61.28           C
ATOM    105  N   PRO A  22     -34.812  -7.085  11.927  1.00 80.07           N
ATOM    106  CA  PRO A  22     -34.861  -5.835  11.163  1.00 80.43           C
ATOM    107  C   PRO A  22     -33.764  -5.794  10.103  1.00 77.69           C
ATOM    108  O   PRO A  22     -32.770  -6.511  10.233  1.00 65.58           O
ATOM    109  CB  PRO A  22     -34.641  -4.758  12.231  1.00 82.27           C
ATOM    110  CG  PRO A  22     -33.926  -5.462  13.336  1.00 85.55           C
ATOM    111  CD  PRO A  22     -34.481  -6.855  13.344  1.00 84.87           C
ATOM    112  N   CYS A  23     -33.948  -4.978   9.070  1.00 71.30           N
ATOM    113  CA  CYS A  23     -32.962  -4.870   8.001  1.00 73.58           C
ATOM    114  C   CYS A  23     -31.622  -4.379   8.541  1.00 76.74           C
ATOM    115  O   CYS A  23     -31.571  -3.402   9.287  1.00 82.00           O
ATOM    116  CB  CYS A  23     -33.466  -3.936   6.899  1.00 66.71           C
ATOM    117  SG  CYS A  23     -34.965  -4.514   6.065  1.00 66.86           S
ATOM    118  N   PRO A  24     -30.532  -5.071   8.170  1.00 72.17           N
ATOM    119  CA  PRO A  24     -29.168  -4.750   8.609  1.00 81.68           C
ATOM    120  C   PRO A  24     -28.769  -3.307   8.306  1.00 89.16           C
ATOM    121  O   PRO A  24     -28.013  -2.706   9.069  1.00 98.94           O
ATOM    122  CB  PRO A  24     -28.306  -5.731   7.808  1.00 80.64           C
ATOM    123  CG  PRO A  24     -29.211  -6.877   7.527  1.00 74.52           C
ATOM    124  CD  PRO A  24     -30.564  -6.268   7.311  1.00 66.69           C
ATOM    125  N   GLY A  25     -29.277  -2.762   7.206  1.00 85.32           N
ATOM    126  CA  GLY A  25     -28.992  -1.387   6.839  1.00 87.53           C
ATOM    127  C   GLY A  25     -30.041  -0.424   7.358  1.00 90.38           C
ATOM    128  O   GLY A  25     -31.112  -0.837   7.804  1.00 94.35           O
ATOM    129  N   LYS A  26     -29.730   0.868   7.305  1.00 89.41           N
ATOM    130  CA  LYS A  26     -30.661   1.897   7.755  1.00 86.86           C
ATOM    131  C   LYS A  26     -31.308   2.599   6.563  1.00 90.33           C
ATOM    132  O   LYS A  26     -30.694   3.441   5.912  1.00101.18           O
ATOM    133  CB  LYS A  26     -29.952   2.913   8.648  1.00 84.96           C
ATOM    134  CG  LYS A  26     -29.486   2.344   9.977  0.00 80.43           C
ATOM    135  CD  LYS A  26     -30.657   1.836  10.800  0.00 76.05           C
ATOM    136  CE  LYS A  26     -30.193   1.281  12.135  0.00 75.33           C
ATOM    137  NZ  LYS A  26     -31.332   0.774  12.952  0.00 74.04           N
ATOM    138  N   CYS A  27     -32.556   2.237   6.285  1.00 85.64           N
ATOM    139  CA  CYS A  27     -33.291   2.780   5.150  1.00 77.39           C
ATOM    140  C   CYS A  27     -34.772   2.896   5.487  1.00 72.58           C
ATOM    141  O   CYS A  27     -35.398   1.920   5.897  1.00 74.86           O
ATOM    142  CB  CYS A  27     -33.090   1.900   3.913  1.00 79.70           C
ATOM    143  SG  CYS A  27     -34.077   2.365   2.467  1.00 80.11           S
ATOM    144  N   ILE A  28     -35.325   4.092   5.314  1.00 69.97           N
ATOM    145  CA  ILE A  28     -36.721   4.349   5.649  1.00 76.39           C
ATOM    146  C   ILE A  28     -37.694   3.646   4.715  1.00 80.84           C
ATOM    147  O   ILE A  28     -38.854   3.441   5.064  1.00 82.69           O
ATOM    148  CB  ILE A  28     -37.030   5.855   5.634  1.00 80.11           C
ATOM    149  CG1 ILE A  28     -36.697   6.453   4.266  1.00 80.69           C
ATOM    150  CG2 ILE A  28     -36.259   6.553   6.734  1.00 90.32           C
ATOM    151  CD1 ILE A  28     -37.070   7.912   4.128  1.00 91.41           C
ATOM    152  N   TYR A  29     -37.220   3.274   3.531  1.00 81.51           N
ATOM    153  CA  TYR A  29     -38.069   2.610   2.549  1.00 77.44           C
ATOM    154  C   TYR A  29     -38.055   1.092   2.727  1.00 73.25           C
ATOM    155  O   TYR A  29     -38.963   0.401   2.274  1.00 73.34           O
ATOM    156  CB  TYR A  29     -37.633   2.980   1.126  1.00 76.25           C
ATOM    157  CG  TYR A  29     -37.935   4.409   0.725  1.00 74.08           C
ATOM    158  CD1 TYR A  29     -39.157   4.750   0.163  1.00 75.09           C
ATOM    159  CD2 TYR A  29     -36.993   5.411   0.894  1.00 74.97           C
ATOM    160  CE1 TYR A  29     -39.436   6.053  -0.212  1.00 78.36           C
ATOM    161  CE2 TYR A  29     -37.260   6.717   0.524  1.00 79.94           C
ATOM    162  CZ  TYR A  29     -38.483   7.032  -0.029  1.00 82.42           C
ATOM    163  OH  TYR A  29     -38.746   8.331  -0.396  1.00 86.23           O
ATOM    164  N   CYS A  30     -37.021   0.584   3.389  1.00 70.96           N
ATOM    165  CA  CYS A  30     -36.869  -0.853   3.598  1.00 67.97           C
ATOM    166  C   CYS A  30     -38.021  -1.434   4.421  1.00 70.27           C
ATOM    167  O   CYS A  30     -38.601  -0.743   5.263  1.00 72.56           O
ATOM    168  CB  CYS A  30     -35.533  -1.153   4.279  1.00 69.53           C
ATOM    169  SG  CYS A  30     -34.146  -1.304   3.123  1.00 69.36           S
ATOM    170  N   PRO A  31     -38.368  -2.708   4.164  1.00 67.43           N
ATOM    171  CA  PRO A  31     -39.465  -3.384   4.868  1.00 69.29           C
ATOM    172  C   PRO A  31     -39.198  -3.540   6.359  1.00 69.55           C
ATOM    173  O   PRO A  31     -38.062  -3.369   6.802  1.00 70.38           O
ATOM    174  CB  PRO A  31     -39.533  -4.755   4.181  1.00 72.69           C
ATOM    175  CG  PRO A  31     -38.180  -4.952   3.597  1.00 73.92           C
ATOM    176  CD  PRO A  31     -37.744  -3.590   3.163  1.00 73.00           C
ATOM    177  N   THR A  32     -40.245  -3.861   7.113  1.00 70.59           N
ATOM    178  CA  THR A  32     -40.155  -4.005   8.562  1.00 69.97           C
ATOM    179  C   THR A  32     -39.098  -5.029   8.966  1.00 73.22           C
ATOM    180  O   THR A  32     -38.285  -4.780   9.857  1.00 74.53           O
ATOM    181  CB  THR A  32     -41.514  -4.416   9.160  1.00 76.52           C
ATOM    182  OG1 THR A  32     -42.505  -3.440   8.813  1.00 89.31           O
ATOM    183  CG2 THR A  32     -41.426  -4.529  10.673  1.00 71.42           C
ATOM    184  N   PHE A  33     -39.112  -6.178   8.298  1.00 70.62           N
ATOM    185  CA  PHE A  33     -38.148  -7.235   8.576  1.00 66.95           C
ATOM    186  C   PHE A  33     -37.263  -7.505   7.364  1.00 65.06           C
ATOM    187  O   PHE A  33     -37.677  -7.299   6.221  1.00 67.72           O
ATOM    188  CB  PHE A  33     -38.865  -8.516   9.004  1.00 64.24           C
ATOM    189  CG  PHE A  33     -39.684  -8.361  10.254  1.00 68.23           C
ATOM    190  CD1 PHE A  33     -39.077  -8.357  11.499  1.00 67.67           C
ATOM    191  CD2 PHE A  33     -41.061  -8.219  10.185  1.00 77.30           C
ATOM    192  CE1 PHE A  33     -39.826  -8.213  12.653  1.00 68.67           C
ATOM    193  CE2 PHE A  33     -41.817  -8.076  11.336  1.00 76.73           C
ATOM    194  CZ  PHE A  33     -41.197  -8.072  12.571  1.00 72.63           C
ATOM    195  N   ALA A  34     -36.040  -7.957   7.624  1.00 58.71           N
ATOM    196  CA  ALA A  34     -35.093  -8.263   6.560  1.00 64.71           C
ATOM    197  C   ALA A  34     -35.614  -9.397   5.687  1.00 67.53           C
ATOM    198  O   ALA A  34     -36.133 -10.392   6.191  1.00 68.38           O
ATOM    199  CB  ALA A  34     -33.737  -8.619   7.145  1.00 60.73           C
ATOM    200  N   ALA A  35     -35.480  -9.240   4.375  1.00 61.56           N
ATOM    201  CA  ALA A  35     -35.961 -10.245   3.436  1.00 64.90           C
ATOM    202  C   ALA A  35     -35.106 -11.507   3.487  1.00 69.74           C
ATOM    203  O   ALA A  35     -33.877 -11.440   3.513  1.00 80.68           O
ATOM    204  CB  ALA A  35     -35.989  -9.682   2.023  1.00 63.48           C
ATOM    205  N   THR A  36     -35.770 -12.657   3.506  1.00 64.39           N
ATOM    206  CA  THR A  36     -35.087 -13.943   3.474  1.00 70.17           C
ATOM    207  C   THR A  36     -35.335 -14.618   2.128  1.00 67.50           C
ATOM    208  O   THR A  36     -36.337 -14.339   1.472  1.00 66.50           O
ATOM    209  CB  THR A  36     -35.564 -14.864   4.616  1.00 69.84           C
ATOM    210  OG1 THR A  36     -36.957 -15.153   4.449  1.00 75.81           O
ATOM    211  CG2 THR A  36     -35.348 -14.196   5.966  1.00 73.14           C
ATOM    212  N   PRO A  37     -34.413 -15.494   1.698  1.00 79.75           N
ATOM    213  CA  PRO A  37     -34.642 -16.266   0.471  1.00 80.19           C
ATOM    214  C   PRO A  37     -35.881 -17.149   0.591  1.00 81.47           C
ATOM    215  O   PRO A  37     -36.626 -17.327  -0.379  1.00 82.30           O
ATOM    216  CB  PRO A  37     -33.374 -17.116   0.347  1.00 85.42           C
ATOM    217  CG  PRO A  37     -32.338 -16.364   1.109  1.00 89.77           C
ATOM    218  CD  PRO A  37     -33.066 -15.721   2.250  1.00 84.17           C
ATOM    219  N   GLN A  38     -36.104 -17.669   1.796  1.00 79.08           N
ATOM    220  CA  GLN A  38     -37.227 -18.556   2.079  1.00 81.89           C
ATOM    221  C   GLN A  38     -38.579 -17.874   1.872  1.00 84.39           C
ATOM    222  O   GLN A  38     -39.617 -18.534   1.865  1.00 85.71           O
ATOM    223  CB  GLN A  38     -37.132 -19.091   3.512  1.00 80.42           C
ATOM    224  CG  GLN A  38     -35.969 -20.049   3.753  1.00 75.46           C
ATOM    225  CD  GLN A  38     -34.627 -19.346   3.845  1.00 74.85           C
ATOM    226  OE1 GLN A  38     -34.552 -18.168   4.196  1.00 75.42           O
ATOM    227  NE2 GLN A  38     -33.559 -20.067   3.523  1.00 76.93           N
ATOM    228  N   SER A  39     -38.562 -16.555   1.704  1.00 85.62           N
ATOM    229  CA  SER A  39     -39.777 -15.808   1.399  1.00 97.26           C
ATOM    230  C   SER A  39     -40.317 -16.194   0.025  1.00 96.14           C
ATOM    231  O   SER A  39     -41.488 -15.960  -0.280  1.00 96.58           O
ATOM    232  CB  SER A  39     -39.516 -14.302   1.458  1.00105.82           C
ATOM    233  OG  SER A  39     -39.031 -13.917   2.732  1.00111.61           O
ATOM    234  N   TYR A  40     -39.460 -16.784  -0.804  1.00 87.68           N
ATOM    235  CA  TYR A  40     -39.884 -17.239  -2.122  1.00 97.23           C
ATOM    236  C   TYR A  40     -39.979 -18.760  -2.168  1.00104.83           C
ATOM    237  O   TYR A  40     -40.199 -19.351  -3.225  1.00108.84           O
ATOM    238  CB  TYR A  40     -38.936 -16.709  -3.196  1.00 92.47           C
ATOM    239  CG  TYR A  40     -39.035 -15.209  -3.354  1.00 88.83           C
ATOM    240  CD1 TYR A  40     -38.300 -14.355  -2.539  1.00 76.94           C
ATOM    241  CD2 TYR A  40     -39.882 -14.646  -4.299  1.00 93.08           C
ATOM    242  CE1 TYR A  40     -38.397 -12.984  -2.672  1.00 87.23           C
ATOM    243  CE2 TYR A  40     -39.986 -13.275  -4.439  1.00 98.40           C
ATOM    244  CZ  TYR A  40     -39.241 -12.449  -3.623  1.00101.64           C
ATOM    245  OH  TYR A  40     -39.341 -11.084  -3.760  1.00112.79           O
ATOM    246  N   THR A  41     -39.805 -19.383  -1.006  1.00102.33           N
ATOM    247  CA  THR A  41     -40.142 -20.790  -0.811  1.00106.31           C
ATOM    248  C   THR A  41     -40.993 -20.921   0.451  1.00110.25           C
ATOM    249  O   THR A  41     -40.578 -21.560   1.420  1.00103.13           O
ATOM    250  CB  THR A  41     -38.888 -21.683  -0.682  1.00106.79           C
ATOM    251  OG1 THR A  41     -38.212 -21.391   0.548  1.00111.21           O
ATOM    252  CG2 THR A  41     -37.937 -21.458  -1.850  1.00101.78           C
ATOM    253  N   PRO A  42     -42.194 -20.316   0.441  1.00113.80           N
ATOM    254  CA  PRO A  42     -42.986 -20.165   1.667  1.00110.97           C
ATOM    255  C   PRO A  42     -43.636 -21.460   2.145  1.00110.08           C
ATOM    256  O   PRO A  42     -43.832 -21.633   3.348  1.00110.41           O
ATOM    257  CB  PRO A  42     -44.053 -19.147   1.260  1.00110.12           C
ATOM    258  CG  PRO A  42     -44.260 -19.404  -0.192  1.00107.22           C
ATOM    259  CD  PRO A  42     -42.916 -19.813  -0.743  1.00110.47           C
ATOM    260  N   GLU A  43     -43.962 -22.354   1.218  1.00105.22           N
ATOM    261  CA  GLU A  43     -44.668 -23.580   1.568  1.00108.25           C
ATOM    262  C   GLU A  43     -43.708 -24.711   1.919  1.00105.34           C
ATOM    263  O   GLU A  43     -44.118 -25.864   2.056  1.00108.85           O
ATOM    264  CB  GLU A  43     -45.594 -24.005   0.426  1.00121.70           C
ATOM    265  CG  GLU A  43     -46.605 -22.940   0.024  1.00131.01           C
ATOM    266  CD  GLU A  43     -47.459 -22.468   1.189  1.00133.22           C
ATOM    267  OE1 GLU A  43     -47.850 -23.309   2.026  1.00136.07           O
ATOM    268  OE2 GLU A  43     -47.736 -21.252   1.268  1.00129.74           O
ATOM    269  N   SER A  44     -42.429 -24.378   2.063  1.00 99.09           N
ATOM    270  CA  SER A  44     -41.439 -25.350   2.506  1.00106.19           C
ATOM    271  C   SER A  44     -41.767 -25.803   3.925  1.00107.23           C
ATOM    272  O   SER A  44     -42.185 -24.994   4.753  1.00104.68           O
ATOM    273  CB  SER A  44     -40.029 -24.758   2.441  1.00104.26           C
ATOM    274  OG  SER A  44     -39.057 -25.696   2.869  1.00104.42           O
ATOM    275  N   PRO A  45     -41.597 -27.105   4.205  1.00108.14           N
ATOM    276  CA  PRO A  45     -41.902 -27.647   5.534  1.00113.32           C
ATOM    277  C   PRO A  45     -41.140 -26.939   6.652  1.00111.79           C
ATOM    278  O   PRO A  45     -41.704 -26.702   7.719  1.00113.39           O
ATOM    279  CB  PRO A  45     -41.465 -29.111   5.423  1.00111.53           C
ATOM    280  CG  PRO A  45     -41.573 -29.424   3.969  1.00111.83           C
ATOM    281  CD  PRO A  45     -41.183 -28.158   3.260  1.00110.97           C
ATOM    282  N   ALA A  46     -39.884 -26.588   6.392  1.00109.98           N
ATOM    283  CA  ALA A  46     -39.005 -26.043   7.421  1.00107.66           C
ATOM    284  C   ALA A  46     -39.359 -24.614   7.842  1.00102.03           C
ATOM    285  O   ALA A  46     -39.212 -24.265   9.012  1.00101.29           O
ATOM    286  CB  ALA A  46     -37.562 -26.102   6.950  1.00103.69           C
ATOM    287  N   VAL A  47     -39.811 -23.786   6.903  1.00 84.97           N
ATOM    288  CA  VAL A  47     -40.151 -22.400   7.228  1.00 77.98           C
ATOM    289  C   VAL A  47     -41.511 -22.323   7.927  1.00 83.12           C
ATOM    290  O   VAL A  47     -41.685 -21.579   8.902  1.00 92.24           O
ATOM    291  CB  VAL A  47     -40.143 -21.494   5.964  1.00 84.67           C
ATOM    292  CG1 VAL A  47     -40.873 -22.153   4.810  1.00 94.15           C
ATOM    293  CG2 VAL A  47     -40.737 -20.122   6.271  1.00 71.35           C
ATOM    294  N   LEU A  48     -42.466 -23.106   7.436  1.00 79.25           N
ATOM    295  CA  LEU A  48     -43.767 -23.212   8.080  1.00 77.68           C
ATOM    296  C   LEU A  48     -43.597 -23.763   9.494  1.00 70.05           C
ATOM    297  O   LEU A  48     -44.224 -23.280  10.443  1.00 79.39           O
ATOM    298  CB  LEU A  48     -44.702 -24.096   7.254  1.00 83.99           C
ATOM    299  CG  LEU A  48     -45.066 -23.518   5.883  1.00 86.06           C
ATOM    300  CD1 LEU A  48     -45.712 -24.572   5.003  1.00 86.62           C
ATOM    301  CD2 LEU A  48     -45.981 -22.308   6.027  1.00 80.17           C
ATOM    302  N   ARG A  49     -42.728 -24.762   9.627  1.00 58.53           N
ATOM    303  CA  ARG A  49     -42.389 -25.322  10.930  1.00 67.68           C
ATOM    304  C   ARG A  49     -41.741 -24.267  11.821  1.00 68.91           C
ATOM    305  O   ARG A  49     -42.007 -24.206  13.020  1.00 74.99           O
ATOM    306  CB  ARG A  49     -41.456 -26.521  10.769  1.00 72.61           C
ATOM    307  CG  ARG A  49     -41.916 -27.777  11.482  1.00 93.81           C
ATOM    308  CD  ARG A  49     -41.520 -29.016  10.699  1.00107.33           C
ATOM    309  NE  ARG A  49     -40.120 -28.986  10.287  1.00115.11           N
ATOM    310  CZ  ARG A  49     -39.649 -29.604   9.208  1.00120.81           C
ATOM    311  NH1 ARG A  49     -40.470 -30.297   8.428  1.00124.29           N
ATOM    312  NH2 ARG A  49     -38.361 -29.525   8.903  1.00121.03           N
ATOM    313  N   ALA A  50     -40.890 -23.438  11.222  1.00 68.23           N
ATOM    314  CA  ALA A  50     -40.203 -22.377  11.950  1.00 64.85           C
ATOM    315  C   ALA A  50     -41.198 -21.381  12.530  1.00 68.18           C
ATOM    316  O   ALA A  50     -41.090 -20.993  13.693  1.00 59.54           O
ATOM    317  CB  ALA A  50     -39.208 -21.667  11.044  1.00 56.30           C
ATOM    318  N   LYS A  51     -42.169 -20.971  11.719  1.00 64.44           N
ATOM    319  CA  LYS A  51     -43.185 -20.039  12.193  1.00 63.16           C
ATOM    320  C   LYS A  51     -44.092 -20.702  13.227  1.00 64.81           C
ATOM    321  O   LYS A  51     -44.565 -20.047  14.158  1.00 71.24           O
ATOM    322  CB  LYS A  51     -44.018 -19.499  11.029  1.00 71.36           C
ATOM    323  CG  LYS A  51     -44.984 -18.394  11.436  1.00 75.25           C
ATOM    324  CD  LYS A  51     -45.763 -17.857  10.249  1.00 87.11           C
ATOM    325  CE  LYS A  51     -46.734 -16.768  10.681  1.00 91.29           C
ATOM    326  NZ  LYS A  51     -47.512 -16.224   9.535  1.00 91.07           N
ATOM    327  N   SER A  52     -44.327 -22.002  13.068  1.00 52.43           N
ATOM    328  CA  SER A  52     -45.190 -22.729  13.995  1.00 58.53           C
ATOM    329  C   SER A  52     -44.539 -22.901  15.370  1.00 58.67           C
ATOM    330  O   SER A  52     -45.217 -23.198  16.354  1.00 64.23           O
ATOM    331  CB  SER A  52     -45.564 -24.097  13.420  1.00 63.78           C
ATOM    332  OG  SER A  52     -44.461 -24.984  13.448  1.00 71.72           O
ATOM    333  N   CYS A  53     -43.223 -22.714  15.431  1.00 60.26           N
ATOM    334  CA  CYS A  53     -42.477 -22.848  16.680  1.00 60.47           C
ATOM    335  C   CYS A  53     -42.082 -21.489  17.252  1.00 56.22           C
ATOM    336  O   CYS A  53     -41.304 -21.417  18.204  1.00 61.75           O
ATOM    337  CB  CYS A  53     -41.218 -23.698  16.467  1.00 50.21           C
ATOM    338  SG  CYS A  53     -41.510 -25.449  16.115  1.00 57.59           S
ATOM    339  N   GLU A  54     -42.622 -20.422  16.666  1.00 52.53           N
ATOM    340  CA  GLU A  54     -42.229 -19.048  16.987  1.00 54.54           C
ATOM    341  C   GLU A  54     -40.720 -18.850  16.867  1.00 54.57           C
ATOM    342  O   GLU A  54     -40.130 -18.060  17.604  1.00 52.02           O
ATOM    343  CB  GLU A  54     -42.696 -18.651  18.392  1.00 67.56           C
ATOM    344  CG  GLU A  54     -44.193 -18.392  18.510  1.00 72.56           C
ATOM    345  CD  GLU A  54     -45.006 -19.665  18.655  1.00 98.52           C
ATOM    346  OE1 GLU A  54     -46.103 -19.743  18.061  1.00111.16           O
ATOM    347  OE2 GLU A  54     -44.556 -20.588  19.369  1.00104.18           O
ATOM    348  N   TYR A  55     -40.113 -19.580  15.934  1.00 47.45           N
ATOM    349  CA  TYR A  55     -38.691 -19.461  15.614  1.00 52.16           C
ATOM    350  C   TYR A  55     -37.772 -19.837  16.779  1.00 52.35           C
ATOM    351  O   TYR A  55     -36.620 -19.408  16.824  1.00 50.39           O
ATOM    352  CB  TYR A  55     -38.374 -18.040  15.134  1.00 51.19           C
ATOM    353  CG  TYR A  55     -39.187 -17.614  13.930  1.00 63.08           C
ATOM    354  CD1 TYR A  55     -38.743 -17.874  12.640  1.00 68.41           C
ATOM    355  CD2 TYR A  55     -40.401 -16.955  14.084  1.00 65.05           C
ATOM    356  CE1 TYR A  55     -39.484 -17.487  11.535  1.00 63.58           C
ATOM    357  CE2 TYR A  55     -41.150 -16.568  12.987  1.00 59.78           C
ATOM    358  CZ  TYR A  55     -40.686 -16.835  11.716  1.00 66.74           C
ATOM    359  OH  TYR A  55     -41.431 -16.448  10.625  1.00 75.96           O
ATOM    360  N   GLN A  56     -38.277 -20.643  17.709  1.00 52.69           N
ATOM    361  CA  GLN A  56     -37.459 -21.136  18.817  1.00 46.95           C
ATOM    362  C   GLN A  56     -36.509 -22.225  18.337  1.00 45.95           C
ATOM    363  O   GLN A  56     -36.940 -23.215  17.752  1.00 51.66           O
ATOM    364  CB  GLN A  56     -38.334 -21.679  19.946  1.00 51.46           C
ATOM    365  CG  GLN A  56     -39.290 -20.673  20.555  1.00 46.97           C
ATOM    366  CD  GLN A  56     -40.284 -21.330  21.492  1.00 60.64           C
ATOM    367  OE1 GLN A  56     -41.472 -21.010  21.479  1.00 69.11           O
ATOM    368  NE2 GLN A  56     -39.803 -22.259  22.310  1.00 49.82           N
ATOM    369  N   ALA A  57     -35.218 -22.042  18.597  1.00 43.83           N
ATOM    370  CA  ALA A  57     -34.195 -22.983  18.141  1.00 53.99           C
ATOM    371  C   ALA A  57     -34.377 -24.386  18.723  1.00 51.18           C
ATOM    372  O   ALA A  57     -34.435 -25.373  17.979  1.00 44.05           O
ATOM    373  CB  ALA A  57     -32.813 -22.454  18.483  1.00 42.69           C
ATOM    374  N   TYR A  58     -34.462 -24.468  20.051  1.00 47.42           N
ATOM    375  CA  TYR A  58     -34.574 -25.754  20.734  1.00 44.10           C
ATOM    376  C   TYR A  58     -35.791 -26.530  20.244  1.00 43.38           C
ATOM    377  O   TYR A  58     -35.690 -27.709  19.896  1.00 45.42           O
ATOM    378  CB  TYR A  58     -34.651 -25.562  22.257  1.00 42.82           C
ATOM    379  CG  TYR A  58     -34.650 -26.869  23.021  1.00 45.37           C
ATOM    380  CD1 TYR A  58     -33.458 -27.468  23.409  1.00 46.58           C
ATOM    381  CD2 TYR A  58     -35.841 -27.514  23.340  1.00 50.15           C
ATOM    382  CE1 TYR A  58     -33.452 -28.667  24.097  1.00 50.01           C
ATOM    383  CE2 TYR A  58     -35.842 -28.713  24.025  1.00 52.43           C
ATOM    384  CZ  TYR A  58     -34.646 -29.285  24.400  1.00 52.11           C
ATOM    385  OH  TYR A  58     -34.644 -30.479  25.084  1.00 64.97           O
ATOM    386  N   LYS A  59     -36.935 -25.855  20.209  1.00 44.80           N
ATOM    387  CA  LYS A  59     -38.186 -26.477  19.794  1.00 44.79           C
ATOM    388  C   LYS A  59     -38.130 -26.929  18.331  1.00 47.37           C
ATOM    389  O   LYS A  59     -38.605 -28.015  17.991  1.00 46.14           O
ATOM    390  CB  LYS A  59     -39.354 -25.511  20.013  1.00 52.18           C
ATOM    391  CG  LYS A  59     -40.727 -26.145  19.881  1.00 55.02           C
ATOM    392  CD  LYS A  59     -41.816 -25.182  20.326  1.00 51.40           C
ATOM    393  CE  LYS A  59     -43.195 -25.815  20.219  1.00 52.38           C
ATOM    394  NZ  LYS A  59     -44.267 -24.907  20.706  1.00 55.04           N
ATOM    395  N   GLN A  60     -37.541 -26.097  17.475  1.00 41.88           N
ATOM    396  CA  GLN A  60     -37.391 -26.434  16.059  1.00 51.29           C
ATOM    397  C   GLN A  60     -36.555 -27.691  15.878  1.00 42.14           C
ATOM    398  O   GLN A  60     -36.949 -28.610  15.153  1.00 46.20           O
ATOM    399  CB  GLN A  60     -36.748 -25.281  15.282  1.00 42.12           C
ATOM    400  CG  GLN A  60     -37.701 -24.177  14.858  1.00 43.23           C
ATOM    401  CD  GLN A  60     -37.009 -23.120  14.014  1.00 51.55           C
ATOM    402  OE1 GLN A  60     -36.883 -23.266  12.799  1.00 51.71           O
ATOM    403  NE2 GLN A  60     -36.544 -22.056  14.659  1.00 40.17           N
ATOM    404  N   VAL A  61     -35.402 -27.730  16.542  1.00 45.14           N
ATOM    405  CA  VAL A  61     -34.503 -28.873  16.414  1.00 45.45           C
ATOM    406  C   VAL A  61     -35.124 -30.149  16.988  1.00 55.56           C
ATOM    407  O   VAL A  61     -35.036 -31.213  16.376  1.00 53.93           O
ATOM    408  CB  VAL A  61     -33.148 -28.609  17.101  1.00 43.40           C
ATOM    409  CG1 VAL A  61     -32.254 -29.834  17.002  1.00 44.08           C
ATOM    410  CG2 VAL A  61     -32.463 -27.406  16.472  1.00 47.20           C
ATOM    411  N   ALA A  62     -35.754 -30.042  18.155  1.00 49.15           N
ATOM    412  CA  ALA A  62     -36.404 -31.195  18.776  1.00 45.67           C
ATOM    413  C   ALA A  62     -37.512 -31.754  17.883  1.00 48.27           C
ATOM    414  O   ALA A  62     -37.598 -32.973  17.655  1.00 51.19           O
ATOM    415  CB  ALA A  62     -36.963 -30.817  20.144  1.00 45.78           C
ATOM    416  N   LEU A  63     -38.354 -30.855  17.378  1.00 44.94           N
ATOM    417  CA  LEU A  63     -39.439 -31.242  16.482  1.00 54.81           C
ATOM    418  C   LEU A  63     -38.900 -31.918  15.227  1.00 48.12           C
ATOM    419  O   LEU A  63     -39.416 -32.958  14.800  1.00 54.79           O
ATOM    420  CB  LEU A  63     -40.282 -30.024  16.103  1.00 57.34           C
ATOM    421  CG  LEU A  63     -41.427 -30.285  15.123  1.00 74.65           C
ATOM    422  CD1 LEU A  63     -42.381 -31.333  15.675  1.00 79.23           C
ATOM    423  CD2 LEU A  63     -42.168 -28.997  14.816  1.00 76.35           C
ATOM    424  N   ARG A  64     -37.856 -31.331  14.647  1.00 47.19           N
ATOM    425  CA  ARG A  64     -37.252 -31.884  13.438  1.00 54.07           C
ATOM    426  C   ARG A  64     -36.706 -33.286  13.689  1.00 61.74           C
ATOM    427  O   ARG A  64     -36.940 -34.199  12.898  1.00 56.04           O
ATOM    428  CB  ARG A  64     -36.143 -30.966  12.914  1.00 54.09           C
ATOM    429  CG  ARG A  64     -35.504 -31.455  11.627  1.00 64.34           C
ATOM    430  CD  ARG A  64     -36.559 -31.787  10.576  1.00 68.37           C
ATOM    431  NE  ARG A  64     -35.975 -32.368   9.370  1.00 87.17           N
ATOM    432  CZ  ARG A  64     -36.682 -32.792   8.326  1.00 86.22           C
ATOM    433  NH1 ARG A  64     -38.008 -32.703   8.333  1.00 75.95           N
ATOM    434  NH2 ARG A  64     -36.065 -33.307   7.272  1.00 88.53           N
ATOM    435  N   LEU A  65     -35.990 -33.450  14.796  1.00 54.42           N
ATOM    436  CA  LEU A  65     -35.469 -34.755  15.187  1.00 53.91           C
ATOM    437  C   LEU A  65     -36.594 -35.776  15.315  1.00 55.08           C
ATOM    438  O   LEU A  65     -36.483 -36.900  14.811  1.00 54.07           O
ATOM    439  CB  LEU A  65     -34.693 -34.660  16.505  1.00 52.87           C
ATOM    440  CG  LEU A  65     -33.306 -34.016  16.451  1.00 56.49           C
ATOM    441  CD1 LEU A  65     -32.715 -33.888  17.847  1.00 60.24           C
ATOM    442  CD2 LEU A  65     -32.381 -34.819  15.550  1.00 63.18           C
ATOM    443  N   ARG A  66     -37.681 -35.384  15.975  1.00 49.04           N
ATOM    444  CA  ARG A  66     -38.824 -36.286  16.114  1.00 50.12           C
ATOM    445  C   ARG A  66     -39.406 -36.683  14.754  1.00 60.90           C
ATOM    446  O   ARG A  66     -39.724 -37.850  14.526  1.00 60.50           O
ATOM    447  CB  ARG A  66     -39.917 -35.653  16.973  1.00 59.79           C
ATOM    448  CG  ARG A  66     -41.089 -36.584  17.229  1.00 69.86           C
ATOM    449  CD  ARG A  66     -42.321 -35.819  17.668  1.00 80.79           C
ATOM    450  NE  ARG A  66     -42.770 -34.875  16.649  0.00 72.17           N
ATOM    451  CZ  ARG A  66     -43.626 -35.176  15.677  0.00 70.35           C
ATOM    452  NH1 ARG A  66     -44.128 -36.399  15.589  0.00 72.05           N
ATOM    453  NH2 ARG A  66     -43.979 -34.253  14.793  0.00 69.24           N
ATOM    454  N   ILE A  67     -39.546 -35.712  13.855  1.00 57.98           N
ATOM    455  CA  ILE A  67     -40.091 -35.980  12.525  1.00 64.30           C
ATOM    456  C   ILE A  67     -39.212 -36.957  11.740  1.00 55.55           C
ATOM    457  O   ILE A  67     -39.699 -37.956  11.195  1.00 61.64           O
ATOM    458  CB  ILE A  67     -40.253 -34.680  11.716  1.00 63.94           C
ATOM    459  CG1 ILE A  67     -41.344 -33.808  12.339  1.00 64.75           C
ATOM    460  CG2 ILE A  67     -40.586 -34.988  10.264  1.00 71.79           C
ATOM    461  CD1 ILE A  67     -41.549 -32.494  11.631  1.00 68.29           C
ATOM    462  N   ILE A  68     -37.915 -36.663  11.700  1.00 51.89           N
ATOM    463  CA  ILE A  68     -36.944 -37.515  11.021  1.00 54.53           C
ATOM    464  C   ILE A  68     -36.974 -38.931  11.583  1.00 64.18           C
ATOM    465  O   ILE A  68     -36.931 -39.909  10.836  1.00 63.94           O
ATOM    466  CB  ILE A  68     -35.516 -36.952  11.145  1.00 54.27           C
ATOM    467  CG1 ILE A  68     -35.434 -35.571  10.497  1.00 60.48           C
ATOM    468  CG2 ILE A  68     -34.514 -37.888  10.499  1.00 59.92           C
ATOM    469  CD1 ILE A  68     -34.192 -34.800  10.881  1.00 66.87           C
ATOM    470  N   GLN A  69     -37.061 -39.036  12.904  1.00 68.80           N
ATOM    471  CA  GLN A  69     -37.111 -40.342  13.550  1.00 63.93           C
ATOM    472  C   GLN A  69     -38.404 -41.081  13.207  1.00 69.75           C
ATOM    473  O   GLN A  69     -38.415 -42.306  13.079  1.00 69.40           O
ATOM    474  CB  GLN A  69     -36.965 -40.191  15.064  1.00 74.86           C
ATOM    475  CG  GLN A  69     -36.797 -41.503  15.803  1.00 94.34           C
ATOM    476  CD  GLN A  69     -35.995 -41.349  17.078  1.00107.86           C
ATOM    477  OE1 GLN A  69     -35.446 -40.282  17.354  1.00110.37           O
ATOM    478  NE2 GLN A  69     -35.921 -42.417  17.864  1.00112.28           N
ATOM    479  N   ASP A  70     -39.490 -40.331  13.047  1.00 64.21           N
ATOM    480  CA  ASP A  70     -40.780 -40.924  12.711  1.00 63.32           C
ATOM    481  C   ASP A  70     -40.831 -41.363  11.252  1.00 67.39           C
ATOM    482  O   ASP A  70     -41.616 -42.238  10.891  1.00 64.17           O
ATOM    483  CB  ASP A  70     -41.919 -39.945  13.000  1.00 76.11           C
ATOM    484  CG  ASP A  70     -42.171 -39.763  14.483  1.00 92.11           C
ATOM    485  OD1 ASP A  70     -41.733 -40.627  15.274  1.00 88.52           O
ATOM    486  OD2 ASP A  70     -42.815 -38.761  14.859  1.00101.69           O
HETATM  487  N   MSE A  71     -40.000 -40.754  10.412  1.00 62.20           N
HETATM  488  CA  MSE A  71     -39.916 -41.167   9.014  1.00 70.12           C
HETATM  489  C   MSE A  71     -39.126 -42.462   8.859  1.00 74.52           C
HETATM  490  O   MSE A  71     -39.194 -43.118   7.819  1.00 79.12           O
HETATM  491  CB  MSE A  71     -39.273 -40.077   8.160  1.00 71.96           C
HETATM  492  CG  MSE A  71     -40.067 -38.795   8.075  1.00 77.78           C
HETATM  493 SE   MSE A  71     -39.328 -37.624   6.713  1.00 92.57          Se
HETATM  494  CE  MSE A  71     -37.478 -37.568   7.325  1.00 81.51           C
ATOM    495  N   GLY A  72     -38.373 -42.823   9.892  1.00 69.18           N
ATOM    496  CA  GLY A  72     -37.537 -44.007   9.842  1.00 66.69           C
ATOM    497  C   GLY A  72     -36.145 -43.700   9.320  1.00 68.24           C
ATOM    498  O   GLY A  72     -35.404 -44.605   8.937  1.00 78.54           O
ATOM    499  N   HIS A  73     -35.795 -42.417   9.304  1.00 61.29           N
ATOM    500  CA  HIS A  73     -34.480 -41.974   8.848  1.00 65.19           C
ATOM    501  C   HIS A  73     -33.503 -41.848  10.020  1.00 74.89           C
ATOM    502  O   HIS A  73     -33.913 -41.557  11.144  1.00 77.57           O
ATOM    503  CB  HIS A  73     -34.595 -40.636   8.110  1.00 66.50           C
ATOM    504  CG  HIS A  73     -35.343 -40.721   6.815  1.00 78.85           C
ATOM    505  ND1 HIS A  73     -35.270 -39.736   5.850  1.00 75.73           N
ATOM    506  CD2 HIS A  73     -36.178 -41.664   6.325  1.00 77.55           C
ATOM    507  CE1 HIS A  73     -36.027 -40.073   4.824  1.00 83.16           C
ATOM    508  NE2 HIS A  73     -36.591 -41.239   5.085  1.00 89.26           N
ATOM    509  N   PRO A  74     -32.203 -42.068   9.760  1.00 82.16           N
ATOM    510  CA  PRO A  74     -31.181 -42.014  10.812  1.00 77.56           C
ATOM    511  C   PRO A  74     -30.925 -40.603  11.331  1.00 74.18           C
ATOM    512  O   PRO A  74     -31.099 -39.630  10.598  1.00 74.28           O
ATOM    513  CB  PRO A  74     -29.934 -42.564  10.114  1.00 76.67           C
ATOM    514  CG  PRO A  74     -30.148 -42.247   8.677  1.00 82.30           C
ATOM    515  CD  PRO A  74     -31.621 -42.424   8.453  1.00 87.81           C
ATOM    516  N   THR A  75     -30.509 -40.503  12.590  1.00 69.55           N
ATOM    517  CA  THR A  75     -30.204 -39.215  13.202  1.00 64.05           C
ATOM    518  C   THR A  75     -28.849 -39.238  13.905  1.00 62.31           C
ATOM    519  O   THR A  75     -28.521 -38.327  14.665  1.00 63.22           O
ATOM    520  CB  THR A  75     -31.286 -38.800  14.221  1.00 66.69           C
ATOM    521  OG1 THR A  75     -31.522 -39.879  15.134  1.00 68.77           O
ATOM    522  CG2 THR A  75     -32.585 -38.458  13.513  1.00 77.60           C
ATOM    523  N   ASP A  76     -28.065 -40.281  13.646  1.00 55.41           N
ATOM    524  CA  ASP A  76     -26.758 -40.428  14.279  1.00 56.70           C
ATOM    525  C   ASP A  76     -25.754 -39.430  13.710  1.00 58.64           C
ATOM    526  O   ASP A  76     -24.806 -39.039  14.389  1.00 60.81           O
ATOM    527  CB  ASP A  76     -26.240 -41.860  14.118  1.00 70.43           C
ATOM    528  CG  ASP A  76     -26.051 -42.254  12.667  1.00 95.76           C
ATOM    529  OD1 ASP A  76     -27.055 -42.595  12.006  1.00102.12           O
ATOM    530  OD2 ASP A  76     -24.898 -42.231  12.189  1.00107.19           O
ATOM    531  N   LYS A  77     -25.964 -39.023  12.461  1.00 60.14           N
ATOM    532  CA  LYS A  77     -25.156 -37.974  11.847  1.00 58.08           C
ATOM    533  C   LYS A  77     -26.054 -36.863  11.322  1.00 62.20           C
ATOM    534  O   LYS A  77     -26.923 -37.098  10.485  1.00 62.54           O
ATOM    535  CB  LYS A  77     -24.294 -38.527  10.715  1.00 56.14           C
ATOM    536  CG  LYS A  77     -23.320 -39.608  11.131  1.00 62.94           C
ATOM    537  CD  LYS A  77     -22.400 -39.955   9.976  1.00 72.85           C
ATOM    538  CE  LYS A  77     -21.862 -41.367  10.093  1.00 81.00           C
ATOM    539  NZ  LYS A  77     -20.984 -41.681   8.938  1.00 91.16           N
ATOM    540  N   VAL A  78     -25.828 -35.650  11.809  1.00 51.08           N
ATOM    541  CA  VAL A  78     -26.713 -34.530  11.518  1.00 48.05           C
ATOM    542  C   VAL A  78     -25.935 -33.307  11.045  1.00 51.71           C
ATOM    543  O   VAL A  78     -24.854 -33.016  11.557  1.00 62.11           O
ATOM    544  CB  VAL A  78     -27.563 -34.168  12.770  1.00 62.15           C
ATOM    545  CG1 VAL A  78     -27.827 -32.670  12.861  1.00 60.64           C
ATOM    546  CG2 VAL A  78     -28.864 -34.961  12.782  1.00 64.36           C
ATOM    547  N   GLU A  79     -26.476 -32.606  10.052  1.00 45.18           N
ATOM    548  CA  GLU A  79     -25.943 -31.302   9.680  1.00 41.20           C
ATOM    549  C   GLU A  79     -26.940 -30.203  10.020  1.00 45.39           C
ATOM    550  O   GLU A  79     -28.004 -30.112   9.413  1.00 55.52           O
ATOM    551  CB  GLU A  79     -25.596 -31.241   8.191  1.00 51.05           C
ATOM    552  CG  GLU A  79     -24.977 -29.910   7.782  1.00 65.11           C
ATOM    553  CD  GLU A  79     -24.696 -29.812   6.296  1.00 77.37           C
ATOM    554  OE1 GLU A  79     -25.334 -30.550   5.516  1.00 96.34           O
ATOM    555  OE2 GLU A  79     -23.835 -28.995   5.909  1.00 70.83           O
ATOM    556  N   LEU A  80     -26.590 -29.371  10.995  1.00 46.30           N
ATOM    557  CA  LEU A  80     -27.412 -28.224  11.351  1.00 45.73           C
ATOM    558  C   LEU A  80     -27.341 -27.164  10.263  1.00 48.78           C
ATOM    559  O   LEU A  80     -26.253 -26.787   9.826  1.00 50.95           O
ATOM    560  CB  LEU A  80     -26.966 -27.627  12.690  1.00 48.02           C
ATOM    561  CG  LEU A  80     -27.385 -28.360  13.962  1.00 56.11           C
ATOM    562  CD1 LEU A  80     -26.747 -27.711  15.179  1.00 51.53           C
ATOM    563  CD2 LEU A  80     -28.900 -28.365  14.085  1.00 50.33           C
ATOM    564  N   ILE A  81     -28.501 -26.686   9.827  1.00 48.19           N
ATOM    565  CA  ILE A  81     -28.547 -25.630   8.827  1.00 44.24           C
ATOM    566  C   ILE A  81     -29.329 -24.433   9.349  1.00 41.04           C
ATOM    567  O   ILE A  81     -30.535 -24.521   9.590  1.00 48.94           O
ATOM    568  CB  ILE A  81     -29.174 -26.121   7.506  1.00 49.22           C
ATOM    569  CG1 ILE A  81     -28.421 -27.348   6.987  1.00 49.49           C
ATOM    570  CG2 ILE A  81     -29.168 -25.004   6.474  1.00 51.14           C
ATOM    571  CD1 ILE A  81     -28.967 -27.895   5.684  1.00 57.15           C
ATOM    572  N   ILE A  82     -28.628 -23.319   9.535  1.00 47.33           N
ATOM    573  CA  ILE A  82     -29.237 -22.093  10.037  1.00 44.71           C
ATOM    574  C   ILE A  82     -29.654 -21.188   8.882  1.00 49.92           C
ATOM    575  O   ILE A  82     -28.811 -20.570   8.229  1.00 50.19           O
ATOM    576  CB  ILE A  82     -28.276 -21.318  10.961  1.00 51.47           C
ATOM    577  CG1 ILE A  82     -27.612 -22.261  11.969  1.00 61.87           C
ATOM    578  CG2 ILE A  82     -29.011 -20.187  11.660  1.00 43.41           C
ATOM    579  CD1 ILE A  82     -28.581 -22.979  12.871  1.00 53.47           C
HETATM  580  N   MSE A  83     -30.957 -21.109   8.640  1.00 46.91           N
HETATM  581  CA  MSE A  83     -31.484 -20.365   7.502  1.00 54.34           C
HETATM  582  C   MSE A  83     -31.916 -18.950   7.871  1.00 59.25           C
HETATM  583  O   MSE A  83     -32.252 -18.669   9.022  1.00 54.11           O
HETATM  584  CB  MSE A  83     -32.663 -21.117   6.884  1.00 53.12           C
HETATM  585  CG  MSE A  83     -32.301 -22.480   6.320  1.00 54.31           C
HETATM  586 SE   MSE A  83     -33.834 -23.382   5.523  1.00 66.79          Se
HETATM  587  CE  MSE A  83     -34.909 -23.634   7.128  1.00 56.97           C
ATOM    588  N   GLY A  84     -31.908 -18.065   6.879  1.00 59.44           N
ATOM    589  CA  GLY A  84     -32.315 -16.686   7.076  1.00 64.47           C
ATOM    590  C   GLY A  84     -31.434 -15.703   6.329  1.00 58.95           C
ATOM    591  O   GLY A  84     -31.926 -14.766   5.700  1.00 63.63           O
ATOM    592  N   GLY A  85     -30.124 -15.916   6.405  1.00 54.45           N
ATOM    593  CA  GLY A  85     -29.167 -15.056   5.735  1.00 48.72           C
ATOM    594  C   GLY A  85     -28.856 -13.789   6.507  1.00 61.48           C
ATOM    595  O   GLY A  85     -27.971 -13.024   6.127  1.00 66.89           O
ATOM    596  N   THR A  86     -29.583 -13.570   7.599  1.00 59.47           N
ATOM    597  CA  THR A  86     -29.445 -12.348   8.383  1.00 71.94           C
ATOM    598  C   THR A  86     -29.056 -12.649   9.827  1.00 70.62           C
ATOM    599  O   THR A  86     -28.985 -11.749  10.662  1.00 71.05           O
ATOM    600  CB  THR A  86     -30.750 -11.533   8.373  1.00 83.02           C
ATOM    601  OG1 THR A  86     -31.809 -12.316   8.939  1.00 76.03           O
ATOM    602  CG2 THR A  86     -31.120 -11.146   6.950  1.00 90.57           C
ATOM    603  N   PHE A  87     -28.799 -13.924  10.102  1.00 66.41           N
ATOM    604  CA  PHE A  87     -28.494 -14.407  11.445  1.00 65.08           C
ATOM    605  C   PHE A  87     -27.294 -13.709  12.086  1.00 65.68           C
ATOM    606  O   PHE A  87     -27.326 -13.366  13.267  1.00 57.71           O
ATOM    607  CB  PHE A  87     -28.255 -15.919  11.394  1.00 64.73           C
ATOM    608  CG  PHE A  87     -27.767 -16.510  12.685  1.00 57.26           C
ATOM    609  CD1 PHE A  87     -28.484 -16.345  13.855  1.00 55.35           C
ATOM    610  CD2 PHE A  87     -26.600 -17.257  12.719  1.00 60.30           C
ATOM    611  CE1 PHE A  87     -28.044 -16.904  15.037  1.00 53.75           C
ATOM    612  CE2 PHE A  87     -26.151 -17.814  13.899  1.00 58.53           C
ATOM    613  CZ  PHE A  87     -26.874 -17.638  15.059  1.00 51.00           C
ATOM    614  N   LEU A  88     -26.244 -13.490  11.303  1.00 62.73           N
ATOM    615  CA  LEU A  88     -25.007 -12.923  11.831  1.00 60.19           C
ATOM    616  C   LEU A  88     -25.119 -11.432  12.143  1.00 62.54           C
ATOM    617  O   LEU A  88     -24.244 -10.864  12.796  1.00 66.58           O
ATOM    618  CB  LEU A  88     -23.858 -13.164  10.850  1.00 60.62           C
ATOM    619  CG  LEU A  88     -23.510 -14.634  10.609  1.00 65.34           C
ATOM    620  CD1 LEU A  88     -22.408 -14.770   9.570  1.00 68.14           C
ATOM    621  CD2 LEU A  88     -23.107 -15.303  11.914  1.00 58.65           C
ATOM    622  N   SER A  89     -26.196 -10.803  11.682  1.00 63.87           N
ATOM    623  CA  SER A  89     -26.412  -9.380  11.930  1.00 64.68           C
ATOM    624  C   SER A  89     -27.239  -9.151  13.192  1.00 65.84           C
ATOM    625  O   SER A  89     -27.502  -8.011  13.573  1.00 73.11           O
ATOM    626  CB  SER A  89     -27.102  -8.721  10.735  1.00 66.94           C
ATOM    627  OG  SER A  89     -28.455  -9.133  10.639  1.00 74.48           O
ATOM    628  N   ALA A  90     -27.651 -10.240  13.832  1.00 68.16           N
ATOM    629  CA  ALA A  90     -28.439 -10.151  15.056  1.00 69.30           C
ATOM    630  C   ALA A  90     -27.543  -9.939  16.268  1.00 72.91           C
ATOM    631  O   ALA A  90     -26.319 -10.023  16.168  1.00 76.29           O
ATOM    632  CB  ALA A  90     -29.282 -11.402  15.236  1.00 66.44           C
ATOM    633  N   ASP A  91     -28.165  -9.662  17.409  1.00 65.23           N
ATOM    634  CA  ASP A  91     -27.445  -9.499  18.665  1.00 64.41           C
ATOM    635  C   ASP A  91     -26.615 -10.742  18.986  1.00 64.33           C
ATOM    636  O   ASP A  91     -27.058 -11.868  18.761  1.00 64.98           O
ATOM    637  CB  ASP A  91     -28.430  -9.198  19.797  1.00 82.13           C
ATOM    638  CG  ASP A  91     -27.817  -9.371  21.168  1.00103.30           C
ATOM    639  OD1 ASP A  91     -27.090  -8.461  21.619  1.00120.68           O
ATOM    640  OD2 ASP A  91     -28.071 -10.417  21.798  1.00105.62           O
ATOM    641  N   ILE A  92     -25.409 -10.521  19.503  1.00 67.35           N
ATOM    642  CA  ILE A  92     -24.447 -11.592  19.764  1.00 73.98           C
ATOM    643  C   ILE A  92     -24.986 -12.661  20.724  1.00 65.53           C
ATOM    644  O   ILE A  92     -24.923 -13.868  20.435  1.00 67.04           O
ATOM    645  CB  ILE A  92     -23.135 -11.013  20.339  1.00 77.96           C
ATOM    646  CG1 ILE A  92     -22.680  -9.802  19.520  1.00 80.39           C
ATOM    647  CG2 ILE A  92     -22.051 -12.070  20.375  1.00 74.21           C
ATOM    648  CD1 ILE A  92     -22.348 -10.127  18.077  1.00 79.78           C
ATOM    649  N   THR A  93     -25.513 -12.203  21.859  1.00 67.48           N
ATOM    650  CA  THR A  93     -26.123 -13.078  22.860  1.00 65.02           C
ATOM    651  C   THR A  93     -27.206 -13.964  22.246  1.00 63.03           C
ATOM    652  O   THR A  93     -27.298 -15.154  22.558  1.00 74.23           O
ATOM    653  CB  THR A  93     -26.739 -12.264  24.022  1.00 70.41           C
ATOM    654  OG1 THR A  93     -25.723 -11.473  24.650  1.00 64.85           O
ATOM    655  CG2 THR A  93     -27.361 -13.185  25.058  1.00 68.49           C
ATOM    656  N   TYR A  94     -28.019 -13.381  21.368  1.00 55.82           N
ATOM    657  CA  TYR A  94     -29.049 -14.141  20.667  1.00 57.31           C
ATOM    658  C   TYR A  94     -28.442 -15.241  19.806  1.00 51.20           C
ATOM    659  O   TYR A  94     -28.925 -16.369  19.814  1.00 57.51           O
ATOM    660  CB  TYR A  94     -29.914 -13.232  19.791  1.00 59.76           C
ATOM    661  CG  TYR A  94     -30.848 -14.008  18.890  1.00 57.13           C
ATOM    662  CD1 TYR A  94     -32.010 -14.575  19.391  1.00 57.07           C
ATOM    663  CD2 TYR A  94     -30.561 -14.189  17.545  1.00 54.81           C
ATOM    664  CE1 TYR A  94     -32.868 -15.294  18.577  1.00 57.96           C
ATOM    665  CE2 TYR A  94     -31.413 -14.911  16.720  1.00 50.74           C
ATOM    666  CZ  TYR A  94     -32.564 -15.459  17.243  1.00 56.98           C
ATOM    667  OH  TYR A  94     -33.414 -16.173  16.432  1.00 49.46           O
ATOM    668  N   GLN A  95     -27.394 -14.902  19.058  1.00 53.97           N
ATOM    669  CA  GLN A  95     -26.726 -15.863  18.184  1.00 58.58           C
ATOM    670  C   GLN A  95     -26.180 -17.051  18.975  1.00 57.33           C
ATOM    671  O   GLN A  95     -26.510 -18.223  18.693  1.00 57.08           O
ATOM    672  CB  GLN A  95     -25.591 -15.183  17.409  1.00 62.42           C
ATOM    673  CG  GLN A  95     -26.038 -14.013  16.541  1.00 64.19           C
ATOM    674  CD  GLN A  95     -24.884 -13.334  15.817  1.00 65.91           C
ATOM    675  OE1 GLN A  95     -23.933 -13.986  15.387  1.00 65.96           O
ATOM    676  NE2 GLN A  95     -24.965 -12.015  15.684  1.00 63.40           N
ATOM    677  N   TYR A  96     -25.352 -16.739  19.972  1.00 60.32           N
ATOM    678  CA  TYR A  96     -24.748 -17.773  20.810  1.00 54.94           C
ATOM    679  C   TYR A  96     -25.803 -18.625  21.514  1.00 50.21           C
ATOM    680  O   TYR A  96     -25.673 -19.846  21.587  1.00 54.32           O
ATOM    681  CB  TYR A  96     -23.798 -17.144  21.835  1.00 52.60           C
ATOM    682  CG  TYR A  96     -22.428 -16.825  21.271  1.00 64.79           C
ATOM    683  CD1 TYR A  96     -22.189 -15.633  20.602  1.00 72.57           C
ATOM    684  CD2 TYR A  96     -21.377 -17.722  21.401  1.00 66.24           C
ATOM    685  CE1 TYR A  96     -20.939 -15.341  20.080  1.00 70.09           C
ATOM    686  CE2 TYR A  96     -20.124 -17.440  20.885  1.00 65.18           C
ATOM    687  CZ  TYR A  96     -19.911 -16.247  20.225  1.00 67.85           C
ATOM    688  OH  TYR A  96     -18.669 -15.960  19.709  1.00 71.32           O
ATOM    689  N   GLY A  97     -26.853 -17.979  22.015  1.00 58.70           N
ATOM    690  CA  GLY A  97     -27.938 -18.689  22.671  1.00 58.62           C
ATOM    691  C   GLY A  97     -28.688 -19.606  21.720  1.00 58.59           C
ATOM    692  O   GLY A  97     -29.147 -20.680  22.108  1.00 57.38           O
ATOM    693  N   PHE A  98     -28.808 -19.177  20.468  1.00 50.33           N
ATOM    694  CA  PHE A  98     -29.482 -19.952  19.430  1.00 47.78           C
ATOM    695  C   PHE A  98     -28.696 -21.220  19.120  1.00 47.02           C
ATOM    696  O   PHE A  98     -29.233 -22.341  19.172  1.00 58.49           O
ATOM    697  CB  PHE A  98     -29.651 -19.104  18.164  1.00 50.34           C
ATOM    698  CG  PHE A  98     -30.589 -19.695  17.151  1.00 46.41           C
ATOM    699  CD1 PHE A  98     -30.148 -20.649  16.249  1.00 41.91           C
ATOM    700  CD2 PHE A  98     -31.910 -19.285  17.092  1.00 48.04           C
ATOM    701  CE1 PHE A  98     -31.010 -21.193  15.314  1.00 47.17           C
ATOM    702  CE2 PHE A  98     -32.777 -19.821  16.158  1.00 51.74           C
ATOM    703  CZ  PHE A  98     -32.328 -20.776  15.269  1.00 45.80           C
ATOM    704  N   ILE A  99     -27.418 -21.035  18.799  1.00 48.78           N
ATOM    705  CA  ILE A  99     -26.550 -22.172  18.505  1.00 43.80           C
ATOM    706  C   ILE A  99     -26.506 -23.146  19.691  1.00 49.50           C
ATOM    707  O   ILE A  99     -26.634 -24.370  19.526  1.00 44.18           O
ATOM    708  CB  ILE A  99     -25.125 -21.705  18.158  1.00 51.25           C
ATOM    709  CG1 ILE A  99     -25.158 -20.751  16.962  1.00 51.79           C
ATOM    710  CG2 ILE A  99     -24.230 -22.890  17.855  1.00 56.96           C
ATOM    711  CD1 ILE A  99     -25.723 -21.377  15.708  1.00 51.57           C
ATOM    712  N   LYS A 100     -26.347 -22.586  20.886  1.00 49.11           N
ATOM    713  CA  LYS A 100     -26.308 -23.375  22.110  1.00 50.75           C
ATOM    714  C   LYS A 100     -27.598 -24.173  22.285  1.00 46.32           C
ATOM    715  O   LYS A 100     -27.562 -25.339  22.672  1.00 50.95           O
ATOM    716  CB  LYS A 100     -26.068 -22.467  23.321  1.00 51.25           C
ATOM    717  CG  LYS A 100     -25.564 -23.177  24.566  1.00 61.98           C
ATOM    718  CD  LYS A 100     -26.700 -23.536  25.504  1.00 67.52           C
ATOM    719  CE  LYS A 100     -26.173 -24.121  26.803  1.00 58.13           C
ATOM    720  NZ  LYS A 100     -27.285 -24.573  27.681  1.00 49.67           N
ATOM    721  N   ASP A 101     -28.734 -23.546  21.991  1.00 48.69           N
ATOM    722  CA  ASP A 101     -30.020 -24.235  22.047  1.00 46.50           C
ATOM    723  C   ASP A 101     -30.059 -25.407  21.072  1.00 55.09           C
ATOM    724  O   ASP A 101     -30.537 -26.496  21.412  1.00 50.62           O
ATOM    725  CB  ASP A 101     -31.168 -23.269  21.746  1.00 58.04           C
ATOM    726  CG  ASP A 101     -31.601 -22.475  22.964  1.00 70.45           C
ATOM    727  OD1 ASP A 101     -31.411 -22.967  24.097  1.00 80.82           O
ATOM    728  OD2 ASP A 101     -32.141 -21.362  22.789  1.00 73.67           O
ATOM    729  N   CYS A 102     -29.556 -25.179  19.860  1.00 50.25           N
ATOM    730  CA  CYS A 102     -29.482 -26.252  18.869  1.00 46.96           C
ATOM    731  C   CYS A 102     -28.675 -27.438  19.388  1.00 40.35           C
ATOM    732  O   CYS A 102     -29.123 -28.593  19.321  1.00 42.57           O
ATOM    733  CB  CYS A 102     -28.872 -25.741  17.564  1.00 43.72           C
ATOM    734  SG  CYS A 102     -29.883 -24.523  16.710  1.00 47.93           S
ATOM    735  N   TYR A 103     -27.487 -27.150  19.913  1.00 39.77           N
ATOM    736  CA  TYR A 103     -26.634 -28.209  20.445  1.00 48.51           C
ATOM    737  C   TYR A 103     -27.279 -28.936  21.623  1.00 52.44           C
ATOM    738  O   TYR A 103     -27.156 -30.153  21.745  1.00 52.06           O
ATOM    739  CB  TYR A 103     -25.275 -27.650  20.862  1.00 49.91           C
ATOM    740  CG  TYR A 103     -24.322 -27.483  19.706  1.00 49.17           C
ATOM    741  CD1 TYR A 103     -23.900 -28.582  18.972  1.00 52.42           C
ATOM    742  CD2 TYR A 103     -23.845 -26.231  19.345  1.00 47.23           C
ATOM    743  CE1 TYR A 103     -23.032 -28.440  17.910  1.00 58.39           C
ATOM    744  CE2 TYR A 103     -22.971 -26.080  18.285  1.00 52.00           C
ATOM    745  CZ  TYR A 103     -22.570 -27.186  17.571  1.00 57.31           C
ATOM    746  OH  TYR A 103     -21.702 -27.035  16.516  1.00 58.76           O
ATOM    747  N   ASP A 104     -27.965 -28.192  22.484  1.00 59.04           N
ATOM    748  CA  ASP A 104     -28.677 -28.790  23.610  1.00 51.24           C
ATOM    749  C   ASP A 104     -29.751 -29.745  23.115  1.00 52.58           C
ATOM    750  O   ASP A 104     -29.925 -30.833  23.658  1.00 46.87           O
ATOM    751  CB  ASP A 104     -29.311 -27.716  24.498  1.00 46.79           C
ATOM    752  CG  ASP A 104     -28.312 -27.063  25.432  1.00 48.69           C
ATOM    753  OD1 ASP A 104     -27.175 -27.568  25.543  1.00 53.33           O
ATOM    754  OD2 ASP A 104     -28.669 -26.049  26.067  1.00 61.06           O
ATOM    755  N   ALA A 105     -30.467 -29.336  22.074  1.00 50.99           N
ATOM    756  CA  ALA A 105     -31.517 -30.175  21.514  1.00 54.66           C
ATOM    757  C   ALA A 105     -30.932 -31.435  20.880  1.00 54.10           C
ATOM    758  O   ALA A 105     -31.524 -32.512  20.966  1.00 49.57           O
ATOM    759  CB  ALA A 105     -32.329 -29.395  20.505  1.00 48.37           C
ATOM    760  N   LEU A 106     -29.766 -31.303  20.253  1.00 51.05           N
ATOM    761  CA  LEU A 106     -29.092 -32.473  19.689  1.00 52.01           C
ATOM    762  C   LEU A 106     -28.595 -33.428  20.777  1.00 56.51           C
ATOM    763  O   LEU A 106     -28.635 -34.647  20.612  1.00 55.13           O
ATOM    764  CB  LEU A 106     -27.921 -32.045  18.801  1.00 45.54           C
ATOM    765  CG  LEU A 106     -28.279 -31.402  17.463  1.00 52.33           C
ATOM    766  CD1 LEU A 106     -27.021 -31.074  16.673  1.00 48.29           C
ATOM    767  CD2 LEU A 106     -29.195 -32.320  16.664  1.00 42.12           C
ATOM    768  N   ASN A 107     -28.136 -32.869  21.890  1.00 51.16           N
ATOM    769  CA  ASN A 107     -27.516 -33.662  22.948  1.00 50.60           C
ATOM    770  C   ASN A 107     -28.514 -34.381  23.844  1.00 56.93           C
ATOM    771  O   ASN A 107     -28.199 -35.419  24.425  1.00 61.67           O
ATOM    772  CB  ASN A 107     -26.619 -32.776  23.812  1.00 50.63           C
ATOM    773  CG  ASN A 107     -25.392 -32.301  23.072  1.00 51.83           C
ATOM    774  OD1 ASN A 107     -24.966 -32.919  22.098  1.00 54.55           O
ATOM    775  ND2 ASN A 107     -24.810 -31.200  23.533  1.00 52.33           N
ATOM    776  N   GLY A 108     -29.711 -33.822  23.967  1.00 57.59           N
ATOM    777  CA  GLY A 108     -30.710 -34.376  24.860  1.00 52.76           C
ATOM    778  C   GLY A 108     -30.501 -33.910  26.288  1.00 60.80           C
ATOM    779  O   GLY A 108     -31.295 -34.221  27.175  1.00 66.63           O
ATOM    780  N   VAL A 109     -29.425 -33.164  26.512  1.00 56.65           N
ATOM    781  CA  VAL A 109     -29.139 -32.605  27.828  1.00 63.55           C
ATOM    782  C   VAL A 109     -28.810 -31.119  27.723  1.00 65.22           C
ATOM    783  O   VAL A 109     -28.328 -30.651  26.689  1.00 59.80           O
ATOM    784  CB  VAL A 109     -27.971 -33.339  28.518  1.00 66.66           C
ATOM    785  CG1 VAL A 109     -28.350 -34.784  28.812  1.00 61.92           C
ATOM    786  CG2 VAL A 109     -26.716 -33.275  27.661  1.00 59.83           C
ATOM    787  N   VAL A 110     -29.078 -30.381  28.795  1.00 66.32           N
ATOM    788  CA  VAL A 110     -28.805 -28.950  28.831  1.00 64.21           C
ATOM    789  C   VAL A 110     -27.444 -28.673  29.456  1.00 65.57           C
ATOM    790  O   VAL A 110     -27.219 -28.974  30.627  1.00 63.61           O
ATOM    791  CB  VAL A 110     -29.889 -28.190  29.617  1.00 67.29           C
ATOM    792  CG1 VAL A 110     -29.544 -26.711  29.704  1.00 72.84           C
ATOM    793  CG2 VAL A 110     -31.251 -28.395  28.971  1.00 65.75           C
ATOM    794  N   ALA A 111     -26.540 -28.098  28.670  1.00 62.50           N
ATOM    795  CA  ALA A 111     -25.186 -27.825  29.133  1.00 59.70           C
ATOM    796  C   ALA A 111     -25.090 -26.461  29.816  1.00 63.64           C
ATOM    797  O   ALA A 111     -26.014 -25.648  29.737  1.00 64.16           O
ATOM    798  CB  ALA A 111     -24.209 -27.906  27.974  1.00 57.40           C
ATOM    799  N   GLY A 112     -23.964 -26.216  30.480  1.00 76.52           N
ATOM    800  CA  GLY A 112     -23.747 -24.972  31.197  1.00 74.43           C
ATOM    801  C   GLY A 112     -23.250 -23.859  30.295  1.00 76.99           C
ATOM    802  O   GLY A 112     -23.280 -22.687  30.667  1.00 74.92           O
ATOM    803  N   SER A 113     -22.787 -24.230  29.105  1.00 71.89           N
ATOM    804  CA  SER A 113     -22.320 -23.258  28.122  1.00 69.39           C
ATOM    805  C   SER A 113     -22.312 -23.859  26.723  1.00 57.93           C
ATOM    806  O   SER A 113     -22.624 -25.036  26.542  1.00 62.23           O
ATOM    807  CB  SER A 113     -20.920 -22.755  28.479  1.00 75.60           C
ATOM    808  OG  SER A 113     -19.965 -23.800  28.405  1.00 73.49           O
ATOM    809  N   LEU A 114     -21.947 -23.044  25.739  1.00 57.96           N
ATOM    810  CA  LEU A 114     -21.861 -23.501  24.359  1.00 62.19           C
ATOM    811  C   LEU A 114     -20.707 -24.481  24.188  1.00 66.04           C
ATOM    812  O   LEU A 114     -20.833 -25.491  23.493  1.00 64.51           O
ATOM    813  CB  LEU A 114     -21.696 -22.313  23.409  1.00 50.85           C
ATOM    814  CG  LEU A 114     -21.448 -22.630  21.930  1.00 60.49           C
ATOM    815  CD1 LEU A 114     -22.567 -23.483  21.352  1.00 54.39           C
ATOM    816  CD2 LEU A 114     -21.285 -21.348  21.130  1.00 58.27           C
ATOM    817  N   GLU A 115     -19.584 -24.180  24.832  1.00 65.85           N
ATOM    818  CA  GLU A 115     -18.405 -25.033  24.743  1.00 66.52           C
ATOM    819  C   GLU A 115     -18.665 -26.418  25.324  1.00 67.78           C
ATOM    820  O   GLU A 115     -18.242 -27.429  24.754  1.00 69.02           O
ATOM    821  CB  GLU A 115     -17.218 -24.376  25.448  1.00 69.48           C
ATOM    822  CG  GLU A 115     -16.483 -23.369  24.583  1.00 84.06           C
ATOM    823  CD  GLU A 115     -15.936 -23.995  23.313  1.00 99.52           C
ATOM    824  OE1 GLU A 115     -15.354 -25.097  23.398  1.00107.83           O
ATOM    825  OE2 GLU A 115     -16.094 -23.392  22.231  1.00 96.95           O
ATOM    826  N   GLU A 116     -19.365 -26.464  26.453  1.00 65.67           N
ATOM    827  CA  GLU A 116     -19.707 -27.740  27.065  1.00 66.70           C
ATOM    828  C   GLU A 116     -20.706 -28.492  26.197  1.00 55.36           C
ATOM    829  O   GLU A 116     -20.664 -29.716  26.120  1.00 66.89           O
ATOM    830  CB  GLU A 116     -20.278 -27.548  28.472  1.00 67.83           C
ATOM    831  CG  GLU A 116     -20.541 -28.863  29.195  1.00 85.57           C
ATOM    832  CD  GLU A 116     -21.284 -28.686  30.504  1.00 99.26           C
ATOM    833  OE1 GLU A 116     -21.410 -29.677  31.253  1.00 94.32           O
ATOM    834  OE2 GLU A 116     -21.744 -27.559  30.782  1.00109.07           O
ATOM    835  N   ALA A 117     -21.603 -27.758  25.547  1.00 56.28           N
ATOM    836  CA  ALA A 117     -22.589 -28.370  24.660  1.00 60.66           C
ATOM    837  C   ALA A 117     -21.902 -29.031  23.467  1.00 53.98           C
ATOM    838  O   ALA A 117     -22.254 -30.146  23.072  1.00 53.08           O
ATOM    839  CB  ALA A 117     -23.597 -27.336  24.186  1.00 54.83           C
ATOM    840  N   LYS A 118     -20.920 -28.336  22.902  1.00 55.01           N
ATOM    841  CA  LYS A 118     -20.138 -28.870  21.791  1.00 56.34           C
ATOM    842  C   LYS A 118     -19.333 -30.095  22.226  1.00 59.55           C
ATOM    843  O   LYS A 118     -19.375 -31.152  21.573  1.00 57.56           O
ATOM    844  CB  LYS A 118     -19.216 -27.787  21.231  1.00 61.25           C
ATOM    845  CG  LYS A 118     -19.967 -26.642  20.560  1.00 58.83           C
ATOM    846  CD  LYS A 118     -19.129 -25.373  20.496  1.00 58.60           C
ATOM    847  CE  LYS A 118     -17.852 -25.586  19.708  1.00 64.97           C
ATOM    848  NZ  LYS A 118     -17.035 -24.342  19.653  1.00 66.58           N
ATOM    849  N   THR A 119     -18.610 -29.948  23.335  1.00 61.42           N
ATOM    850  CA  THR A 119     -17.827 -31.047  23.892  1.00 51.87           C
ATOM    851  C   THR A 119     -18.694 -32.286  24.102  1.00 54.08           C
ATOM    852  O   THR A 119     -18.295 -33.400  23.768  1.00 59.28           O
ATOM    853  CB  THR A 119     -17.170 -30.649  25.231  1.00 66.24           C
ATOM    854  OG1 THR A 119     -16.280 -29.545  25.019  1.00 69.70           O
ATOM    855  CG2 THR A 119     -16.389 -31.818  25.814  1.00 64.17           C
ATOM    856  N   ILE A 120     -19.886 -32.079  24.649  1.00 53.78           N
ATOM    857  CA  ILE A 120     -20.840 -33.162  24.853  1.00 55.77           C
ATOM    858  C   ILE A 120     -21.268 -33.763  23.515  1.00 57.93           C
ATOM    859  O   ILE A 120     -21.341 -34.985  23.371  1.00 61.29           O
ATOM    860  CB  ILE A 120     -22.081 -32.678  25.633  1.00 56.02           C
ATOM    861  CG1 ILE A 120     -21.736 -32.494  27.113  1.00 60.26           C
ATOM    862  CG2 ILE A 120     -23.228 -33.666  25.499  1.00 48.11           C
ATOM    863  CD1 ILE A 120     -22.834 -31.839  27.915  1.00 60.68           C
ATOM    864  N   ASN A 121     -21.530 -32.907  22.531  1.00 54.24           N
ATOM    865  CA  ASN A 121     -21.960 -33.392  21.225  1.00 50.03           C
ATOM    866  C   ASN A 121     -20.881 -34.214  20.532  1.00 48.62           C
ATOM    867  O   ASN A 121     -21.183 -35.029  19.659  1.00 71.63           O
ATOM    868  CB  ASN A 121     -22.382 -32.236  20.322  1.00 48.19           C
ATOM    869  CG  ASN A 121     -23.010 -32.720  19.026  1.00 54.14           C
ATOM    870  OD1 ASN A 121     -22.340 -32.827  18.000  1.00 53.18           O
ATOM    871  ND2 ASN A 121     -24.299 -33.036  19.074  1.00 48.27           N
ATOM    872  N   GLU A 122     -19.626 -34.006  20.927  1.00 59.16           N
ATOM    873  CA  GLU A 122     -18.518 -34.776  20.359  1.00 64.73           C
ATOM    874  C   GLU A 122     -18.709 -36.291  20.504  1.00 72.10           C
ATOM    875  O   GLU A 122     -18.238 -37.059  19.666  1.00 75.77           O
ATOM    876  CB  GLU A 122     -17.191 -34.362  20.997  1.00 64.08           C
ATOM    877  CG  GLU A 122     -16.775 -32.933  20.682  1.00 68.86           C
ATOM    878  CD  GLU A 122     -15.399 -32.591  21.219  1.00 74.42           C
ATOM    879  OE1 GLU A 122     -14.654 -33.522  21.588  1.00 79.21           O
ATOM    880  OE2 GLU A 122     -15.064 -31.389  21.273  1.00 83.46           O
ATOM    881  N   THR A 123     -19.402 -36.718  21.558  1.00 66.47           N
ATOM    882  CA  THR A 123     -19.666 -38.142  21.766  1.00 56.18           C
ATOM    883  C   THR A 123     -21.153 -38.441  21.979  1.00 58.36           C
ATOM    884  O   THR A 123     -21.509 -39.461  22.574  1.00 64.99           O
ATOM    885  CB  THR A 123     -18.879 -38.701  22.979  1.00 70.90           C
ATOM    886  OG1 THR A 123     -19.328 -38.061  24.180  1.00 63.55           O
ATOM    887  CG2 THR A 123     -17.377 -38.474  22.811  1.00 72.03           C
ATOM    888  N   ALA A 124     -22.020 -37.556  21.500  1.00 56.76           N
ATOM    889  CA  ALA A 124     -23.457 -37.751  21.659  1.00 62.08           C
ATOM    890  C   ALA A 124     -23.998 -38.722  20.614  1.00 64.41           C
ATOM    891  O   ALA A 124     -23.280 -39.133  19.701  1.00 59.47           O
ATOM    892  CB  ALA A 124     -24.186 -36.420  21.576  1.00 51.82           C
ATOM    893  N   GLN A 125     -25.265 -39.093  20.756  1.00 58.65           N
ATOM    894  CA  GLN A 125     -25.908 -39.982  19.797  1.00 66.81           C
ATOM    895  C   GLN A 125     -26.154 -39.255  18.482  1.00 67.52           C
ATOM    896  O   GLN A 125     -25.851 -39.771  17.407  1.00 63.45           O
ATOM    897  CB  GLN A 125     -27.224 -40.518  20.354  1.00 81.41           C
ATOM    898  CG  GLN A 125     -27.981 -41.411  19.387  1.00 98.58           C
ATOM    899  CD  GLN A 125     -29.370 -41.751  19.882  1.00117.01           C
ATOM    900  OE1 GLN A 125     -29.812 -41.252  20.917  1.00122.68           O
ATOM    901  NE2 GLN A 125     -30.070 -42.604  19.142  1.00120.52           N
ATOM    902  N   HIS A 126     -26.709 -38.051  18.579  1.00 55.83           N
ATOM    903  CA  HIS A 126     -26.948 -37.216  17.410  1.00 51.68           C
ATOM    904  C   HIS A 126     -25.742 -36.327  17.136  1.00 51.06           C
ATOM    905  O   HIS A 126     -25.697 -35.178  17.572  1.00 55.81           O
ATOM    906  CB  HIS A 126     -28.201 -36.359  17.606  1.00 49.90           C
ATOM    907  CG  HIS A 126     -29.409 -37.142  18.013  1.00 59.09           C
ATOM    908  ND1 HIS A 126     -29.900 -38.193  17.268  1.00 65.05           N
ATOM    909  CD2 HIS A 126     -30.227 -37.027  19.086  1.00 68.33           C
ATOM    910  CE1 HIS A 126     -30.967 -38.693  17.867  1.00 68.90           C
ATOM    911  NE2 HIS A 126     -31.187 -38.002  18.971  1.00 70.70           N
ATOM    912  N   ARG A 127     -24.765 -36.868  16.417  1.00 51.72           N
ATOM    913  CA  ARG A 127     -23.545 -36.133  16.104  1.00 50.30           C
ATOM    914  C   ARG A 127     -23.804 -35.005  15.113  1.00 57.56           C
ATOM    915  O   ARG A 127     -24.427 -35.213  14.074  1.00 53.63           O
ATOM    916  CB  ARG A 127     -22.483 -37.078  15.536  1.00 58.64           C
ATOM    917  CG  ARG A 127     -22.108 -38.232  16.448  1.00 64.35           C
ATOM    918  CD  ARG A 127     -21.254 -37.771  17.617  1.00 63.02           C
ATOM    919  NE  ARG A 127     -20.731 -38.907  18.370  1.00 69.23           N
ATOM    920  CZ  ARG A 127     -19.552 -39.474  18.141  1.00 71.22           C
ATOM    921  NH1 ARG A 127     -18.763 -39.005  17.184  1.00 68.69           N
ATOM    922  NH2 ARG A 127     -19.158 -40.508  18.874  1.00 73.35           N
ATOM    923  N   CYS A 128     -23.325 -33.812  15.442  1.00 52.71           N
ATOM    924  CA  CYS A 128     -23.375 -32.690  14.515  1.00 53.51           C
ATOM    925  C   CYS A 128     -22.111 -32.689  13.661  1.00 53.60           C
ATOM    926  O   CYS A 128     -21.123 -32.039  14.003  1.00 46.72           O
ATOM    927  CB  CYS A 128     -23.517 -31.368  15.269  1.00 53.35           C
ATOM    928  SG  CYS A 128     -23.693 -29.913  14.211  1.00 57.01           S
ATOM    929  N   VAL A 129     -22.142 -33.429  12.558  1.00 56.86           N
ATOM    930  CA  VAL A 129     -20.961 -33.588  11.715  1.00 56.16           C
ATOM    931  C   VAL A 129     -20.739 -32.375  10.820  1.00 54.47           C
ATOM    932  O   VAL A 129     -19.729 -32.285  10.123  1.00 57.01           O
ATOM    933  CB  VAL A 129     -21.059 -34.850  10.835  1.00 56.70           C
ATOM    934  CG1 VAL A 129     -21.204 -36.089  11.704  1.00 52.15           C
ATOM    935  CG2 VAL A 129     -22.222 -34.731   9.861  1.00 48.54           C
ATOM    936  N   GLY A 130     -21.687 -31.444  10.844  1.00 54.06           N
ATOM    937  CA  GLY A 130     -21.581 -30.236  10.051  1.00 56.08           C
ATOM    938  C   GLY A 130     -22.569 -29.177  10.494  1.00 53.00           C
ATOM    939  O   GLY A 130     -23.657 -29.487  10.973  1.00 53.39           O
ATOM    940  N   LEU A 131     -22.182 -27.918  10.341  1.00 49.16           N
ATOM    941  CA  LEU A 131     -23.065 -26.808  10.660  1.00 48.47           C
ATOM    942  C   LEU A 131     -22.996 -25.775   9.543  1.00 49.08           C
ATOM    943  O   LEU A 131     -21.943 -25.191   9.290  1.00 47.60           O
ATOM    944  CB  LEU A 131     -22.688 -26.184  12.005  1.00 46.28           C
ATOM    945  CG  LEU A 131     -23.735 -25.346  12.749  1.00 62.27           C
ATOM    946  CD1 LEU A 131     -23.336 -25.196  14.208  1.00 61.73           C
ATOM    947  CD2 LEU A 131     -23.929 -23.977  12.117  1.00 61.78           C
ATOM    948  N   CYS A 132     -24.125 -25.550   8.880  1.00 47.88           N
ATOM    949  CA  CYS A 132     -24.172 -24.616   7.763  1.00 49.72           C
ATOM    950  C   CYS A 132     -24.953 -23.357   8.114  1.00 43.77           C
ATOM    951  O   CYS A 132     -26.056 -23.426   8.653  1.00 51.76           O
ATOM    952  CB  CYS A 132     -24.787 -25.281   6.531  1.00 56.96           C
ATOM    953  SG  CYS A 132     -24.976 -24.161   5.126  1.00 55.89           S
ATOM    954  N   ILE A 133     -24.372 -22.205   7.798  1.00 45.81           N
ATOM    955  CA  ILE A 133     -25.029 -20.931   8.042  1.00 48.54           C
ATOM    956  C   ILE A 133     -25.248 -20.165   6.743  1.00 50.95           C
ATOM    957  O   ILE A 133     -24.315 -19.972   5.964  1.00 53.18           O
ATOM    958  CB  ILE A 133     -24.212 -20.060   9.013  1.00 50.15           C
ATOM    959  CG1 ILE A 133     -24.206 -20.688  10.408  1.00 60.84           C
ATOM    960  CG2 ILE A 133     -24.773 -18.649   9.066  1.00 46.70           C
ATOM    961  CD1 ILE A 133     -23.530 -19.834  11.459  1.00 62.96           C
ATOM    962  N   GLU A 134     -26.487 -19.744   6.508  1.00 50.90           N
ATOM    963  CA  GLU A 134     -26.784 -18.840   5.405  1.00 56.96           C
ATOM    964  C   GLU A 134     -26.457 -17.415   5.815  1.00 54.60           C
ATOM    965  O   GLU A 134     -26.824 -16.979   6.905  1.00 58.11           O
ATOM    966  CB  GLU A 134     -28.252 -18.933   4.990  1.00 52.86           C
ATOM    967  CG  GLU A 134     -28.665 -20.264   4.392  1.00 72.95           C
ATOM    968  CD  GLU A 134     -30.112 -20.262   3.934  1.00 89.60           C
ATOM    969  OE1 GLU A 134     -30.832 -19.288   4.242  1.00 88.00           O
ATOM    970  OE2 GLU A 134     -30.530 -21.230   3.265  1.00 95.34           O
ATOM    971  N   THR A 135     -25.766 -16.689   4.946  1.00 53.53           N
ATOM    972  CA  THR A 135     -25.480 -15.287   5.213  1.00 59.77           C
ATOM    973  C   THR A 135     -25.374 -14.496   3.917  1.00 60.30           C
ATOM    974  O   THR A 135     -25.166 -15.063   2.843  1.00 61.62           O
ATOM    975  CB  THR A 135     -24.181 -15.113   6.023  1.00 61.09           C
ATOM    976  OG1 THR A 135     -24.079 -13.758   6.480  1.00 67.02           O
ATOM    977  CG2 THR A 135     -22.964 -15.454   5.176  1.00 53.64           C
ATOM    978  N   ARG A 136     -25.534 -13.183   4.027  1.00 62.94           N
ATOM    979  CA  ARG A 136     -25.382 -12.290   2.889  1.00 63.00           C
ATOM    980  C   ARG A 136     -23.903 -11.976   2.674  1.00 67.16           C
ATOM    981  O   ARG A 136     -23.125 -11.967   3.628  1.00 66.12           O
ATOM    982  CB  ARG A 136     -26.187 -11.005   3.108  1.00 62.87           C
ATOM    983  CG  ARG A 136     -27.675 -11.236   3.335  1.00 59.25           C
ATOM    984  CD  ARG A 136     -28.417  -9.922   3.528  1.00 64.78           C
ATOM    985  NE  ARG A 136     -29.844 -10.123   3.761  1.00 65.66           N
ATOM    986  CZ  ARG A 136     -30.721  -9.137   3.928  1.00 65.78           C
ATOM    987  NH1 ARG A 136     -30.319  -7.874   3.887  1.00 63.71           N
ATOM    988  NH2 ARG A 136     -32.001  -9.414   4.136  1.00 68.10           N
ATOM    989  N   PRO A 137     -23.506 -11.737   1.413  1.00 64.41           N
ATOM    990  CA  PRO A 137     -22.115 -11.424   1.059  1.00 59.54           C
ATOM    991  C   PRO A 137     -21.536 -10.236   1.827  1.00 66.24           C
ATOM    992  O   PRO A 137     -20.348 -10.242   2.154  1.00 68.48           O
ATOM    993  CB  PRO A 137     -22.204 -11.105  -0.435  1.00 61.09           C
ATOM    994  CG  PRO A 137     -23.372 -11.891  -0.908  1.00 60.33           C
ATOM    995  CD  PRO A 137     -24.362 -11.858   0.219  1.00 62.67           C
ATOM    996  N   ASP A 138     -22.361  -9.232   2.108  1.00 66.80           N
ATOM    997  CA  ASP A 138     -21.896  -8.044   2.818  1.00 76.92           C
ATOM    998  C   ASP A 138     -21.949  -8.232   4.335  1.00 76.70           C
ATOM    999  O   ASP A 138     -21.470  -7.385   5.090  1.00 84.40           O
ATOM   1000  CB  ASP A 138     -22.716  -6.818   2.403  1.00 83.91           C
ATOM   1001  CG  ASP A 138     -24.206  -7.022   2.583  1.00 94.03           C
ATOM   1002  OD1 ASP A 138     -24.661  -8.183   2.525  1.00 85.35           O
ATOM   1003  OD2 ASP A 138     -24.925  -6.019   2.777  1.00107.22           O
ATOM   1004  N   ILE A 139     -22.531  -9.343   4.775  1.00 70.77           N
ATOM   1005  CA  ILE A 139     -22.532  -9.699   6.189  1.00 73.27           C
ATOM   1006  C   ILE A 139     -21.699 -10.962   6.390  1.00 71.17           C
ATOM   1007  O   ILE A 139     -22.212 -12.004   6.801  1.00 72.30           O
ATOM   1008  CB  ILE A 139     -23.960  -9.928   6.726  1.00 71.77           C
ATOM   1009  CG1 ILE A 139     -24.923  -8.888   6.153  1.00 80.88           C
ATOM   1010  CG2 ILE A 139     -23.978  -9.890   8.250  1.00 68.40           C
ATOM   1011  CD1 ILE A 139     -26.350  -9.058   6.627  1.00 82.31           C
ATOM   1012  N   CYS A 140     -20.408 -10.864   6.088  1.00 71.47           N
ATOM   1013  CA  CYS A 140     -19.523 -12.018   6.154  1.00 65.85           C
ATOM   1014  C   CYS A 140     -18.069 -11.578   6.286  1.00 66.16           C
ATOM   1015  O   CYS A 140     -17.226 -11.929   5.462  1.00 62.63           O
ATOM   1016  CB  CYS A 140     -19.706 -12.897   4.914  1.00 65.83           C
ATOM   1017  SG  CYS A 140     -19.019 -14.564   5.043  1.00 68.95           S
ATOM   1018  N   GLY A 141     -17.785 -10.802   7.328  1.00 68.33           N
ATOM   1019  CA  GLY A 141     -16.442 -10.308   7.576  1.00 67.32           C
ATOM   1020  C   GLY A 141     -15.674 -11.182   8.548  1.00 62.62           C
ATOM   1021  O   GLY A 141     -16.133 -12.264   8.913  1.00 59.53           O
ATOM   1022  N   LYS A 142     -14.507 -10.707   8.973  1.00 65.99           N
ATOM   1023  CA  LYS A 142     -13.632 -11.474   9.856  1.00 70.43           C
ATOM   1024  C   LYS A 142     -14.287 -11.795  11.201  1.00 73.46           C
ATOM   1025  O   LYS A 142     -14.137 -12.902  11.723  1.00 73.30           O
ATOM   1026  CB  LYS A 142     -12.317 -10.721  10.081  1.00 70.45           C
ATOM   1027  CG  LYS A 142     -11.368 -11.407  11.050  1.00 78.56           C
ATOM   1028  CD  LYS A 142     -10.022 -10.703  11.107  1.00 79.90           C
ATOM   1029  CE  LYS A 142      -9.241 -10.900   9.819  0.00 76.06           C
ATOM   1030  NZ  LYS A 142      -8.906 -12.333   9.588  0.00 73.07           N
ATOM   1031  N   ALA A 143     -15.013 -10.827  11.753  1.00 73.40           N
ATOM   1032  CA  ALA A 143     -15.687 -11.009  13.035  1.00 76.91           C
ATOM   1033  C   ALA A 143     -16.790 -12.064  12.943  1.00 75.49           C
ATOM   1034  O   ALA A 143     -16.862 -12.982  13.771  1.00 74.60           O
ATOM   1035  CB  ALA A 143     -16.259  -9.687  13.522  1.00 78.81           C
ATOM   1036  N   GLU A 144     -17.647 -11.922  11.933  1.00 69.11           N
ATOM   1037  CA  GLU A 144     -18.722 -12.877  11.689  1.00 63.02           C
ATOM   1038  C   GLU A 144     -18.160 -14.281  11.528  1.00 64.33           C
ATOM   1039  O   GLU A 144     -18.685 -15.241  12.096  1.00 67.61           O
ATOM   1040  CB  GLU A 144     -19.526 -12.493  10.442  1.00 64.43           C
ATOM   1041  CG  GLU A 144     -20.416 -11.268  10.601  1.00 63.89           C
ATOM   1042  CD  GLU A 144     -19.652  -9.965  10.482  1.00 75.91           C
ATOM   1043  OE1 GLU A 144     -18.467 -10.002  10.091  1.00 81.55           O
ATOM   1044  OE2 GLU A 144     -20.239  -8.903  10.779  1.00 76.10           O
ATOM   1045  N   ILE A 145     -17.083 -14.389  10.758  1.00 62.67           N
ATOM   1046  CA  ILE A 145     -16.445 -15.675  10.516  1.00 67.79           C
ATOM   1047  C   ILE A 145     -15.887 -16.263  11.809  1.00 63.27           C
ATOM   1048  O   ILE A 145     -16.058 -17.450  12.070  1.00 60.74           O
ATOM   1049  CB  ILE A 145     -15.325 -15.557   9.464  1.00 71.93           C
ATOM   1050  CG1 ILE A 145     -15.934 -15.324   8.081  1.00 70.11           C
ATOM   1051  CG2 ILE A 145     -14.470 -16.812   9.444  1.00 68.98           C
ATOM   1052  CD1 ILE A 145     -14.919 -15.241   6.972  1.00 69.50           C
ATOM   1053  N   GLN A 146     -15.238 -15.435  12.623  1.00 63.60           N
ATOM   1054  CA  GLN A 146     -14.721 -15.900  13.908  1.00 63.56           C
ATOM   1055  C   GLN A 146     -15.846 -16.422  14.800  1.00 64.06           C
ATOM   1056  O   GLN A 146     -15.706 -17.469  15.449  1.00 71.55           O
ATOM   1057  CB  GLN A 146     -13.951 -14.784  14.616  1.00 73.15           C
ATOM   1058  CG  GLN A 146     -12.555 -14.557  14.056  1.00 88.95           C
ATOM   1059  CD  GLN A 146     -11.815 -13.432  14.754  1.00104.38           C
ATOM   1060  OE1 GLN A 146     -12.410 -12.426  15.140  1.00112.26           O
ATOM   1061  NE2 GLN A 146     -10.508 -13.600  14.922  1.00106.91           N
ATOM   1062  N   ARG A 147     -16.967 -15.704  14.821  1.00 63.77           N
ATOM   1063  CA  ARG A 147     -18.132 -16.171  15.567  1.00 62.54           C
ATOM   1064  C   ARG A 147     -18.621 -17.511  15.027  1.00 62.15           C
ATOM   1065  O   ARG A 147     -18.993 -18.398  15.798  1.00 65.17           O
ATOM   1066  CB  ARG A 147     -19.264 -15.144  15.522  1.00 66.48           C
ATOM   1067  CG  ARG A 147     -19.050 -13.954  16.437  1.00 79.79           C
ATOM   1068  CD  ARG A 147     -20.354 -13.233  16.723  1.00 79.85           C
ATOM   1069  NE  ARG A 147     -20.997 -12.752  15.505  1.00 72.76           N
ATOM   1070  CZ  ARG A 147     -20.718 -11.590  14.925  1.00 79.15           C
ATOM   1071  NH1 ARG A 147     -19.799 -10.789  15.447  1.00 77.29           N
ATOM   1072  NH2 ARG A 147     -21.355 -11.229  13.819  1.00 85.18           N
HETATM 1073  N   MSE A 148     -18.609 -17.662  13.705  1.00 56.76           N
HETATM 1074  CA  MSE A 148     -19.027 -18.918  13.089  1.00 53.20           C
HETATM 1075  C   MSE A 148     -18.102 -20.067  13.485  1.00 44.83           C
HETATM 1076  O   MSE A 148     -18.555 -21.195  13.679  1.00 53.05           O
HETATM 1077  CB  MSE A 148     -19.084 -18.780  11.567  1.00 56.55           C
HETATM 1078  CG  MSE A 148     -20.217 -17.892  11.087  1.00 59.73           C
HETATM 1079 SE   MSE A 148     -20.597 -18.083   9.188  1.00 71.20          Se
HETATM 1080  CE  MSE A 148     -18.945 -17.366   8.458  1.00 47.93           C
ATOM   1081  N   ILE A 149     -16.810 -19.775  13.609  1.00 48.66           N
ATOM   1082  CA  ILE A 149     -15.853 -20.750  14.118  1.00 59.53           C
ATOM   1083  C   ILE A 149     -16.231 -21.114  15.548  1.00 65.72           C
ATOM   1084  O   ILE A 149     -16.179 -22.282  15.935  1.00 67.97           O
ATOM   1085  CB  ILE A 149     -14.405 -20.222  14.093  1.00 64.82           C
ATOM   1086  CG1 ILE A 149     -14.030 -19.721  12.699  1.00 73.40           C
ATOM   1087  CG2 ILE A 149     -13.433 -21.304  14.548  1.00 60.75           C
ATOM   1088  CD1 ILE A 149     -14.116 -20.774  11.631  1.00 72.85           C
ATOM   1089  N   ASP A 150     -16.621 -20.109  16.329  1.00 62.19           N
ATOM   1090  CA  ASP A 150     -17.069 -20.353  17.699  1.00 66.87           C
ATOM   1091  C   ASP A 150     -18.311 -21.239  17.744  1.00 66.75           C
ATOM   1092  O   ASP A 150     -18.523 -21.976  18.707  1.00 62.39           O
ATOM   1093  CB  ASP A 150     -17.351 -19.033  18.421  1.00 61.87           C
ATOM   1094  CG  ASP A 150     -16.088 -18.339  18.881  1.00 74.94           C
ATOM   1095  OD1 ASP A 150     -15.081 -19.038  19.122  1.00 84.47           O
ATOM   1096  OD2 ASP A 150     -16.102 -17.097  19.008  1.00 87.95           O
ATOM   1097  N   PHE A 151     -19.129 -21.163  16.698  1.00 53.65           N
ATOM   1098  CA  PHE A 151     -20.364 -21.941  16.634  1.00 53.97           C
ATOM   1099  C   PHE A 151     -20.101 -23.389  16.238  1.00 55.45           C
ATOM   1100  O   PHE A 151     -20.912 -24.276  16.508  1.00 52.70           O
ATOM   1101  CB  PHE A 151     -21.345 -21.307  15.645  1.00 52.92           C
ATOM   1102  CG  PHE A 151     -21.785 -19.924  16.029  1.00 58.56           C
ATOM   1103  CD1 PHE A 151     -21.714 -19.501  17.346  1.00 59.72           C
ATOM   1104  CD2 PHE A 151     -22.271 -19.046  15.073  1.00 57.19           C
ATOM   1105  CE1 PHE A 151     -22.115 -18.230  17.704  1.00 58.62           C
ATOM   1106  CE2 PHE A 151     -22.676 -17.770  15.425  1.00 62.28           C
ATOM   1107  CZ  PHE A 151     -22.597 -17.363  16.744  1.00 58.64           C
ATOM   1108  N   GLY A 152     -18.964 -23.622  15.592  1.00 58.75           N
ATOM   1109  CA  GLY A 152     -18.657 -24.929  15.046  1.00 54.82           C
ATOM   1110  C   GLY A 152     -19.145 -25.043  13.612  1.00 54.74           C
ATOM   1111  O   GLY A 152     -19.559 -26.114  13.168  1.00 51.25           O
ATOM   1112  N   THR A 153     -19.100 -23.927  12.891  1.00 53.16           N
ATOM   1113  CA  THR A 153     -19.545 -23.879  11.501  1.00 49.32           C
ATOM   1114  C   THR A 153     -18.552 -24.581  10.574  1.00 50.27           C
ATOM   1115  O   THR A 153     -17.339 -24.473  10.754  1.00 58.69           O
ATOM   1116  CB  THR A 153     -19.740 -22.422  11.028  1.00 55.51           C
ATOM   1117  OG1 THR A 153     -20.577 -21.723  11.958  1.00 51.36           O
ATOM   1118  CG2 THR A 153     -20.373 -22.375   9.644  1.00 54.94           C
ATOM   1119  N   THR A 154     -19.072 -25.300   9.584  1.00 54.91           N
ATOM   1120  CA  THR A 154     -18.230 -26.011   8.630  1.00 56.40           C
ATOM   1121  C   THR A 154     -18.516 -25.588   7.192  1.00 57.96           C
ATOM   1122  O   THR A 154     -17.699 -25.805   6.298  1.00 58.89           O
ATOM   1123  CB  THR A 154     -18.422 -27.533   8.740  1.00 55.06           C
ATOM   1124  OG1 THR A 154     -19.781 -27.866   8.431  1.00 54.32           O
ATOM   1125  CG2 THR A 154     -18.095 -28.011  10.144  1.00 58.85           C
ATOM   1126  N   ARG A 155     -19.680 -24.986   6.974  1.00 54.21           N
ATOM   1127  CA  ARG A 155     -20.112 -24.627   5.629  1.00 59.62           C
ATOM   1128  C   ARG A 155     -20.893 -23.318   5.627  1.00 57.74           C
ATOM   1129  O   ARG A 155     -21.638 -23.030   6.562  1.00 55.06           O
ATOM   1130  CB  ARG A 155     -20.959 -25.755   5.031  1.00 56.49           C
ATOM   1131  CG  ARG A 155     -21.348 -25.550   3.577  1.00 60.10           C
ATOM   1132  CD  ARG A 155     -21.866 -26.839   2.957  1.00 63.58           C
ATOM   1133  NE  ARG A 155     -23.096 -27.314   3.587  1.00 49.07           N
ATOM   1134  CZ  ARG A 155     -24.316 -26.975   3.182  1.00 59.23           C
ATOM   1135  NH1 ARG A 155     -24.469 -26.152   2.152  1.00 59.84           N
ATOM   1136  NH2 ARG A 155     -25.383 -27.453   3.807  1.00 55.57           N
ATOM   1137  N   VAL A 156     -20.711 -22.522   4.578  1.00 52.16           N
ATOM   1138  CA  VAL A 156     -21.436 -21.265   4.438  1.00 47.87           C
ATOM   1139  C   VAL A 156     -22.115 -21.165   3.074  1.00 56.70           C
ATOM   1140  O   VAL A 156     -21.500 -21.430   2.040  1.00 58.37           O
ATOM   1141  CB  VAL A 156     -20.503 -20.053   4.636  1.00 55.13           C
ATOM   1142  CG1 VAL A 156     -21.222 -18.758   4.287  1.00 53.20           C
ATOM   1143  CG2 VAL A 156     -19.985 -20.009   6.067  1.00 59.41           C
ATOM   1144  N   GLU A 157     -23.394 -20.800   3.084  1.00 53.36           N
ATOM   1145  CA  GLU A 157     -24.122 -20.513   1.855  1.00 60.12           C
ATOM   1146  C   GLU A 157     -24.271 -19.005   1.677  1.00 57.30           C
ATOM   1147  O   GLU A 157     -25.072 -18.373   2.364  1.00 53.03           O
ATOM   1148  CB  GLU A 157     -25.501 -21.180   1.866  1.00 60.54           C
ATOM   1149  CG  GLU A 157     -25.468 -22.701   1.805  1.00 69.44           C
ATOM   1150  CD  GLU A 157     -26.853 -23.318   1.694  1.00 83.94           C
ATOM   1151  OE1 GLU A 157     -27.847 -22.562   1.678  1.00 80.04           O
ATOM   1152  OE2 GLU A 157     -26.948 -24.562   1.620  1.00 89.52           O
"""

def test_1():
  pdb_inp = iotbx.pdb.input(source_info=None, lines = pdb_str)
  model = mmtbx.model.manager(model_input = pdb_inp, log = null_out())
  model.process(make_restraints=True)
  model.get_restraints_manager()
  for cp in [True, False]:
    for fc in [True, False]:
      if not cp and fc:
        # incompatible parameters
        continue
      stats = mmtbx.model.statistics.geometry(
          model=model,
          condensed_probe=cp,
          fast_clash=fc)
      out = StringIO()
      stats.show(log=out)
      val = out.getvalue()
      exp = """
GEOMETRY RESTRAINTS LIBRARY: GEOSTD + MONOMER LIBRARY + CDL V1.2
DEVIATIONS FROM IDEAL VALUES - RMSD, RMSZ FOR BONDS AND ANGLES.
  BOND      :  0.004   0.020   1174  Z= 0.293
  ANGLE     :  0.914   4.674   1594  Z= 0.676
  CHIRALITY :  0.038   0.125    186
  PLANARITY :  0.003   0.018    205
  DIHEDRAL  : 11.055  85.166    440
  MIN NONBONDED DISTANCE : 2.457

MOLPROBITY STATISTICS.
  ALL-ATOM CLASHSCORE : 3.50
  RAMACHANDRAN PLOT:
    OUTLIERS :  0.00 %
    ALLOWED  :  2.68 %
    FAVORED  : 97.32 %
  ROTAMER:
    OUTLIERS :  2.36 %
    ALLOWED  :  0.79 %
    FAVORED  : 96.85 %
  CBETA DEVIATIONS :  0.00 %
  PEPTIDE PLANE:
    CIS-PROLINE     : 0.00 %
    CIS-GENERAL     : 0.00 %
    TWISTED PROLINE : 0.00 %
    TWISTED GENERAL : 0.00 %

RAMA-Z (RAMACHANDRAN PLOT Z-SCORE):
INTERPRETATION: BAD |RAMA-Z| > 3; SUSPICIOUS 2 < |RAMA-Z| < 3; GOOD |RAMA-Z| < 2.
SCORES FOR WHOLE/HELIX/SHEET/LOOP ARE SCALED INDEPENDENTLY;
THEREFORE, THE VALUES ARE NOT RELATED IN A SIMPLE MANNER.
  WHOLE: -0.62 (0.62), RESIDUES: 149
  HELIX:  0.29 (0.58), RESIDUES: 67
  SHEET: -1.83 (0.89), RESIDUES: 20
  LOOP : -0.50 (0.74), RESIDUES: 62

MAX DEVIATION FROM PLANES:
   TYPE  MAXDEV  MEANDEV LINEINFILE
   ARG   0.002   0.000   ARG A  49
   TYR   0.008   0.002   TYR A  40
   PHE   0.008   0.001   PHE A  87
   HIS   0.001   0.000   HIS A 126

DETAILS OF BONDING TYPE RMSD
  COVALENT GEOMETRY    : BOND        0.00413 ( 1174)
  COVALENT GEOMETRY    : ANGLE       0.91411 ( 1594)
"""
  val = [l.strip() for l in val.splitlines() if l.strip() != '']
  exp = [l.strip() for l in exp.splitlines() if l.strip() != '']
  if val!=exp:
    for a,b in zip(val,exp):
      if a!=b:
        print('------\n%s\n%s\n======' % (a,b))
  assert val == exp, '%s\n NOT EQUAL\n%s' % (val, exp)

if __name__ == '__main__':
  test_1()
  print ('OK')


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_superpose.py
"""Tests for superpose.py"""
from __future__ import absolute_import, division, print_function
import random
import os
import unittest

import iotbx.pdb
import libtbx.load_env
import libtbx.test_utils

import mmtbx.superpose as superpose
from six.moves import range

if (1):
  # Fix random seed to avoid rare failures
  random.seed(0)

def get_filename(filename):
  return libtbx.env.find_in_repositories(relative_path="phenix_regression/pdb/%s"%filename, test=os.path.isfile)

def random_pair(left, right):
  assert left < right
  x = random.randrange(left, right)
  y = random.randrange(left, right)
  if(y < x):
    tmp = x
    x = y
    y = tmp
  return x,y

# Don't test yet.
# class SuperposeTestExamples(unittest.TestCase):
class SuperposeExamples(object):
  def test_example_presets(self):
    # Do a basic Ca fitting (default)
    fixed = superpose.SuperposePDB(filename="1CBS.pdb", desc='fixed', preset='ca')
    moving = superpose.SuperposePDB(filename="1HMT.pdb", desc='moving', preset='ca')
    rmsd, lsq = moving.superpose(fixed)

    # ... or will all atoms
    moving.select_update(preset="all")
    rmsd, lsq = moving.superpose(fixed)

    # ... or with a specific selection string.
    moving.select_update(selection="""pepnames and (name ca) chain A""")
    rmsd, lsq = moving.superpose(fixed)

    # ... or use the Select-o-matic.
    moving.selectomatic(fixed)
    rmsd, lsq = moving.superpose(fixed)

    # Write output.
    # moving.output(lsq, filename="1HMT-fit-1CBS.pdb")

  def test_example_na(self):
    # Fit nucleic acid -- note the default settings will realize it's NA.
    fixed = superpose.SuperposePDB(filename="na1.pdb", desc='fixed')
    moving = superpose.SuperposePDB(filename="na2.pdb", desc='moving')
    rmsd, lsq = moving.superpose(fixed)
    # moving.output(lsq, filename="na-fit.pdb")

  def test_example_multiple(self):
    # Open multiple models for fitting and align chain A Ca's.
    fixed = superpose.SuperposePDB(filename="1OAN.pdb", desc='fixed', preset='ca')
    models = superpose.SuperposePDB.open_models(filename="1S6N.pdb", desc='moving', preset='ca')
    for model in models:
      rmsd, lsq = model.superpose(fixed)

  def test_example_pairwise(self):
    result = {}
    moving = superpose.SuperposePDB(filename="1AON.pdb")
    fixed = superpose.SuperposePDB(filename="1AON.pdb")
    for moving_chain in list(moving.pdb.chains())[:7]:
      for fixed_chain in list(fixed.pdb.chains())[:7]:
        fixed.select_update(preset='ca', chain=fixed_chain.id)
        moving.select_update(preset='ca', chain=moving_chain.id)
        result[(moving_chain.id, fixed_chain.id)] = moving.superpose(fixed)

    keys = set([i[0] for i in sorted(result.keys())])
    print("\t"+"\t".join(keys))
    for key1 in keys:
      rmsds = [result[(key1,key2)][0] for key2 in keys]
      print("%s:\t"%key1, "\t".join(["%0.2f"%i for i in rmsds]))

  def test_example_sieve(self):
    pass
    # Use an alternate fitting method.
    # fixed = SuperposePDBSieve(filename="1CBS.pdb", desc='fixed', preset='ca')
    # moving = superpose.SuperposePDBSieve(filename="1HMT.pdb", desc='moving', preset='ca')
    # rmsd, lsq = moving.superpose(fixed)
    # moving.output(lsq, filename="1HMT-fit-1CBS-sieve.pdb")

class SuperposeTest(unittest.TestCase):
    # OK!
    def test_alignment_used_1(self, filename='fab_a_cut_1.pdb', test='test_alignment_used_1', tolerance=0.003):
      filename = get_filename(filename)
      filename_shifted = "%s.shifted.pdb"%test
      cmd = """phenix.pdbtools %(filename)s suffix=none output.prefix=%(filename_shifted)s remove="%(gap_selection)s" %(shift)s"""%{
          'filename': filename,
          'filename_shifted': filename_shifted.replace(".pdb",""),
          'gap_selection': "chain A and (resid 5:30 or resid 32:50)",
          'shift': 'sites.rotate="10 20 30" sites.translate="10 20 30"'
      }
      libtbx.test_utils.run_command(command=cmd, result_file_names=[filename_shifted])
      moving = superpose.SuperposePDB(filename_shifted)
      target = superpose.SuperposePDB(filename)
      rmsd, lsq = moving.superpose(target)
      self.assertLess(rmsd, tolerance)

    # OK!
    def test_alignment_used_2(self, filename='fab_a_cut.pdb', test='test_alignment_used_2', tolerance=0.003):
      filename = get_filename(filename)
      for attempt in range(1):
        filename_shifted = '%s.%s.shifted.pdb'%(test, attempt)
        gap_selection = "chain A and (resid %s:%s or resid %s:%s or resid %s:%s)"%(tuple(
          random_pair(0, 15)+
          random_pair(16, 35)+
          random_pair(36, 50)))
        cmd = """phenix.pdbtools %(filename)s suffix=none output.prefix=%(filename_shifted)s remove="%(gap_selection)s" %(shift)s"""%{
            'filename': filename,
            'filename_shifted': filename_shifted.replace(".pdb",""),
            'gap_selection': gap_selection,
            'shift': 'sites.rotate="10 20 30" sites.translate="10 20 30"'
        }
        libtbx.test_utils.run_command(command=cmd, result_file_names=[filename_shifted])
        moving = superpose.SuperposePDB(filename_shifted)
        target = superpose.SuperposePDB(filename)
        rmsd, lsq = moving.superpose(target)
        self.assertLess(rmsd, tolerance)
      return

    # TODO: Not quite OK
    def test_comprehensive(self, filename='enk_gm.pdb', test='test_comprehensive'):
      filename = get_filename(filename)
      tests = [
        ["", "None", "None"], # OK
        ["""sites.rotate="1 2 3" sites.translate="4 5 6" """, "None", "None"], # OK
        ["""sites.rotate="1 2 3" sites.translate="4 5 6" """, "chain A or resname HOH", "not (chain A or resname HOH)"], # OK
        ["""sites.rotate="1 2 3" sites.translate="4 5 6" """, "chain A or chain C", "not (chain A or chain C)"], # OK
        # ["""sites.rotate="1 2 3" sites.translate="4 5 6" """, "resname HOH", "not (resname HOH)"], # FAILED
        ["""sites.rotate="1 2 3" sites.translate="4 5 6" """, "name CA", "not (name CA)"] # OK
      ]
      count = 0
      for shift, shift_selection, remove_selection in tests:
        print("========= shift: %s -- shift_selection: %s -- remove_selection: %s"%(shift, shift_selection, remove_selection))
        filename_shifted = '%s.%s.shifted.pdb'%(test, count)
        filename_fitted = '%s.%s.fitted.pdb'%(test, count)
        cmd = """phenix.pdbtools %(filename)s suffix=none output.prefix=%(filename_shifted)s selection="%(shift_selection)s" remove="%(remove_selection)s" %(shift)s"""%{
            'filename': filename,
            'filename_shifted': filename_shifted.replace(".pdb",""),
            'shift': shift,
            'shift_selection': shift_selection,
            'remove_selection': remove_selection
        }
        libtbx.test_utils.run_command(command=cmd)

        moving = superpose.SuperposePDB(filename_shifted, selection=shift_selection)
        target = superpose.SuperposePDB(filename, selection=shift_selection)
        rmsd, lsq = moving.superpose(target)
        moving.output(lsq, filename=filename_fitted)

        xs_shifted = iotbx.pdb.input(file_name=filename_shifted).xray_structure_simple()
        xs_fitted = iotbx.pdb.input(file_name=filename_fitted).xray_structure_simple()
        check = xs_fitted.mean_distance(other=xs_shifted)
        if shift:
          self.assertGreater(check, 5.0)
        else:
          self.assertAlmostEqual(check, 0)
        count += 1
      return

    # OK!
    def test_assert_anisou_warning_message(self, filename='phe_a.pdb', test='test_assert_anisou_warning_message'):
      filename = get_filename(filename)
      filename_output = '%s.noaniso.pdb'%test
      moving = superpose.SuperposePDB(filename)
      target = superpose.SuperposePDB(filename)
      rmsd, lsq = moving.superpose(target)
      moving.output(lsq, filename=filename_output)
      pi = iotbx.pdb.input(file_name=filename_output)
      ph = pi.construct_hierarchy()
      pa = ph.atoms()
      uij = pa.extract_uij().as_double()
      print(uij.all_eq(-1.0))
      assert uij.all_eq(-1.0)

    # Mostly OK!
    def test_erik_vogan_case(self, test='test_erik_vogan_case'):
      filename1 = get_filename('rebuild03_ckpt04.pdb')
      filename2 = get_filename('2C30.pdb')
      filename_output = '%s.fitted.pdb'%test

      moving = superpose.SuperposePDB(filename2)
      target = superpose.SuperposePDB(filename1)
      rmsd, lsq = moving.superpose(target)
      moving.output(lsq, filename=filename_output)

      # ["Number of atoms for LS fitting =  36",
      # "RMSD (all matching atoms) (start): 60.830 (number of atoms: 99)",
      # "RMSD (all matching atoms) (final): 0.992 (number of atoms: 99)"]:
      self.assertLess(rmsd, 1.0)

    # Mostly OK!
    def test_altlocs_1(self, test='test_altlocs_1', tolerance=0.001):
      filename1 = get_filename("fab_1.pdb")
      filename2 = get_filename("fab_2.pdb")
      filename_output = '%s.fitted.pdb'%test

      moving = superpose.SuperposePDB(filename2)
      target = superpose.SuperposePDB(filename1)
      rmsd, lsq = moving.superpose(target)
      moving.output(lsq, filename=filename_output)

      # ["Number of atoms for LS fitting =  6",
      # "RMSD between fixed and moving atoms (start): 12.830",
      # "RMSD between fixed and moving atoms (final): 0.000",
      # "RMSD (all matching atoms) (start): 13.164 (number of atoms: 15)",
      # "RMSD (all matching atoms) (final): 0.001 (number of atoms: 15)"]:
      self.assertLess(rmsd, tolerance)

    # OK!
    def test_same_models_many_differently_ordered_chains_1(self, test='test_same_models_many_differently_ordered_chains_1', tolerance=0.03):
      filename1 = get_filename("a1.pdb")
      filename2 = get_filename("b1.pdb")
      filename_output = '%s.fitted.pdb'%test

      moving = superpose.SuperposePDB(filename2)
      target = superpose.SuperposePDB(filename1)
      rmsd, lsq = moving.superpose(target)
      rmsd_output = moving.output(lsq, filename=filename_output)

      # ["Number of atoms for LS fitting =  33",
      # "RMSD between fixed and moving atoms (start): 153.279",
      # "RMSD between fixed and moving atoms (final): 0.025"]:
      self.assertLess(rmsd, tolerance)

    # OK!
    def test_same_models_many_differently_ordered_chains_2(self, test='test_same_models_many_differently_ordered_chains_2', tolerance=0.13):
      filename1 = get_filename("a2.pdb")
      filename2 = get_filename("b2.pdb")
      filename_output = '%s.fitted.pdb'%test

      moving = superpose.SuperposePDB(filename2)
      target = superpose.SuperposePDB(filename1)
      rmsd, lsq = moving.superpose(target)
      rmsd_output = moving.output(lsq, filename=filename_output)

      # ["Number of atoms for LS fitting =  1284",
      # "RMSD (all matching atoms) (start): 159.830 (number of atoms: 26184)",
      # "RMSD (all matching atoms) (final): 67.995 (number of atoms: 26184)"]
      self.assertLess(rmsd, tolerance)

    # OK!
    def test_rna_dna(self, test='test_rna_dna', tolerance=0.7):
      filename1 = get_filename('superpose_pdbs_a.pdb')
      filename2 = get_filename('superpose_pdbs_b.pdb')
      filename_output = '%s.fitted.pdb'%test

      moving = superpose.SuperposePDB(filename2)
      target = superpose.SuperposePDB(filename1)
      rmsd, lsq = moving.superpose(target)
      rmsd_output = moving.output(lsq, filename=filename_output)

      # ["Number of atoms for LS fitting =  8142",
      # "RMSD (all matching atoms) (start): 405.009 (number of atoms: 8142)",
      # "RMSD (all matching atoms) (final): 0.607 (number of atoms: 8142)"]:
      self.assertLess(rmsd, tolerance)

if __name__ == '__main__':
    unittest.main(verbosity=0)


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_table_one.py
from __future__ import absolute_import, division, print_function

import os

from mmtbx.regression import model_1yjp
from mmtbx.command_line import table_one
import iotbx.pdb
from cctbx import sgtbx
from scitbx.array_family import flex
from libtbx.utils import null_out
import random
import libtbx.load_env

def exercise():
  flex.set_random_seed(123456)
  random.seed(123456)
  base = "tst_table_one"
  pdb_in = iotbx.pdb.input(source_info=None, lines=model_1yjp)
  xrs = pdb_in.xray_structure_simple()
  xrs.set_inelastic_form_factors(
    photon=1.54,
    table="sasaki")
  fc = abs(xrs.structure_factors(d_min=1.5).f_calc()).average_bijvoet_mates()
  fc.set_observation_type_xray_amplitude()
  flags = fc.generate_r_free_flags()
  mtz = fc.as_mtz_dataset(column_root_label="F",
    wavelength=1.54)
  mtz.add_miller_array(flags, column_root_label="FreeR_flag")
  mtz.mtz_object().write(base + ".mtz")
  xrs_p1 = xrs.expand_to_p1()
  xrs_p1.shake_sites_in_place(rms_difference=0.1)
  fc_p1 = xrs_p1.structure_factors(d_min=1.4).f_calc()
  fc_p1_extra = fc_p1.randomize_amplitude_and_phase(amplitude_error=1.0,
    phase_error_deg=0,
    random_seed=123456)
  fc_p1 = abs(fc_p1.concatenate(other=fc_p1_extra)).sort(
    by_value="packed_indices")
  fc_p1.set_observation_type_xray_amplitude()
  sg_p2 = sgtbx.space_group_info("P2")
  ic = fc_p1.f_as_f_sq().customized_copy(
    space_group_info=sg_p2,
    sigmas=flex.double(fc_p1.size(), 10.0))
  ic.export_as_scalepack_unmerged(file_name=base + ".sca")
  with open(base + ".pdb", "w") as f:
    f.write(model_1yjp)
  args = [
    base + ".mtz",
    base + ".pdb",
    "unmerged_data=%s.sca" % base,
    "prefix=tst_table_one_1",
  ]
# BROKEN
#  table_one.run(args=args, out=null_out(),
#    use_current_directory_if_not_specified=True)
#  # now with unmerged data in SHELX format
#  f = open(base + ".hkl", "w")
#  ic.export_as_shelx_hklf(file_object=f)
#  f.close()
#  args = [
#    base + ".mtz",
#    base + ".pdb",
#    "unmerged_data=%s.hkl=hklf4" % base,
#    "prefix=tst_table_one_2",
#  ]
#  table_one.run(args=args, out=null_out(),
#    use_current_directory_if_not_specified=True)
#  # now with phil file
#  f = open("tst_table_one_3.eff", "w")
#  f.write("""\
#table_one {
#  structure {
#    name = %(base)s
#    pdb_file = %(base)s.pdb
#    mtz_file = %(base)s.mtz
#    unmerged_data = %(base)s.hkl=hklf4
#  }
#  output {
#    directory = os.getcwd()
#    base_name = %(base)s_3
#  }
#}""" % {"base" : base })
#  args = [ "tst_table_one_3.eff" ]
#  table_one.run(args=args, out=null_out(),
#    use_current_directory_if_not_specified=True)

def exercise_counts():
  pdb_file = libtbx.env.under_dist('mmtbx', 'regression/pdbs/two_chains_ligand_water.pdb')
  base = "tst_table_one_counts"
  mtz_file = base + ".mtz"
  pdb_in = iotbx.pdb.input(pdb_file)
  xrs = pdb_in.xray_structure_simple()
  xrs.set_inelastic_form_factors(photon=1.54, table="sasaki")
  fc = abs(xrs.structure_factors(d_min=4.0).f_calc()).average_bijvoet_mates()
  fc.set_observation_type_xray_amplitude()
  fcs = fc.customized_copy(sigmas=flex.double(fc.size(), 10.0))
  flags = fcs.generate_r_free_flags()
  mtz = fcs.as_mtz_dataset(column_root_label="Fobs", wavelength=1.54)
  mtz.add_miller_array(flags, column_root_label="R-free-flags")
  mtz.mtz_object().write(mtz_file)
  params = """
table_one {
  structure {
    name = "abc"
    pdb_file = "%s"
    mtz_file = "./%s"
    data_labels = "Fobs,SIGFobs"
    r_free_flags_label = "R-free-flags"
    wavelength = None
    cif_file = None
    cif_directory = None
    data_type = *xray neutron
    unmerged_data = None
    unmerged_labels = None
    use_internal_variance = False
    count_anomalous_pairs_separately = False
    enable_twinning = False
    twin_law = Auto
  }
  processing {
    re_compute_r_factors = True
    n_bins = 10
    ligand_selection = None
  }
  multiprocessing {
    nproc = 1
    technology = *multiprocessing sge lsf pbs condor slurm
    qsub_command = None
  }
  output {
    directory = "%s"
    job_title = None
    show_missing_fields = True
    format = *txt *csv *rtf
    base_name = "%s"
    verbose = "True"
    text_field_separation = 2
  }
}
""" % (pdb_file, mtz_file, os.getcwd(), base)
  eff_file = base + ".eff"
  with open(eff_file, "w") as f:
    f.write(params)
  args = [ eff_file ]
  table_one.run(args=args, out=null_out(),
    use_current_directory_if_not_specified=True)

  count_stats = """\
  Number of non-hydrogen atoms                             65
                macromolecules                             26
                       ligands                             35
                       solvent                              4
              Protein residues                              3\
"""
  adp_stats = """\
              Average B-factor                          16.01
                macromolecules                           8.07
                       ligands                          23.16
                       solvent                           5.19\
"""
  with open(base + ".txt", "r") as f:
    lines = f.read()
  assert count_stats in lines
  assert adp_stats in lines

if (__name__ == "__main__"):
  exercise()
  exercise_counts()
  print("OK")


 *******************************************************************************


 *******************************************************************************
mmtbx/regression/tst_utils.py
from __future__ import absolute_import, division, print_function
from mmtbx import utils
import iotbx.pdb
from scitbx.array_family import flex
from libtbx.test_utils import approx_equal, Exception_expected
from libtbx.utils import format_cpu_times, null_out, Sorry
import sys
import mmtbx.model

def exercise_d_data_target_d_atomic_params():
  import iotbx.pdb
  import mmtbx.f_model
  from scitbx.array_family import flex
  good = """
CRYST1   15.000   15.000   15.000  90.00  90.00  90.00 P 212121
HETATM  115  O   HOH A  18       3.000   5.000   5.000  1.00 10.00           O
HETATM  115  O   HOH A  18       5.000   5.000   8.000  1.00 10.00           O
TER
END
  """
  bad = """
CRYST1   15.000   15.000   15.000  90.00  90.00  90.00 P 212121
HETATM  115  O   HOH A  18       3.000   5.000   5.000  0.50 10.00           O
HETATM  115  O   HOH A  19       5.000   5.000   8.000  0.90 10.00           O
TER
END
  """
  for update_f_part1 in [True, False]:
    pdb_inp = iotbx.pdb.input(source_info=None, lines=bad)
    xrs = pdb_inp.xray_structure_simple()
    xrs.scattering_type_registry(table = "wk1995")
    #
    xb = iotbx.pdb.input(source_info=None, lines=good).xray_structure_simple()
    xb.scattering_type_registry(table = "wk1995")
    f_obs = abs(xb.structure_factors(d_min=1,
      algorithm="direct").f_calc()).set_observation_type_xray_amplitude()
    #
    sfp = mmtbx.f_model.sf_and_grads_accuracy_master_params.extract()
    sfp.algorithm="direct"
    for target_name in ["ls_wunit_kunit", "ls_wunit_k1", "ml"]:
      print("%s"%target_name, "-"*50)
      fmodel = mmtbx.f_model.manager(
        f_obs                        = f_obs,
        xray_structure               = xrs.deep_copy_scatterers(),
        target_name                  = target_name,
        sf_and_grads_accuracy_params = sfp)
      fmodel.update_all_scales(update_f_part1=update_f_part1)
      alpha_beta = fmodel.alpha_beta()
      print("R-work: %6.4f"%fmodel.r_work())
      #
      tg = mmtbx.utils.experimental_data_target_and_gradients(fmodel = fmodel,
        alpha_beta=alpha_beta)
      tg.show()
      eps = 1.e-6
      # occupancies
      go = tg.grad_occ()
      for i in [0,1]:
        xrs1 = fmodel.xray_structure.deep_copy_scatterers()
        xrs2 = fmodel.xray_structure.deep_copy_scatterers()
        #
        xrs1.scatterers()[i].occupancy+=+eps
        tg.update_xray_structure(xray_structure=xrs1, alpha_beta=alpha_beta)
        t1 = tg.target()
        #
        xrs2.scatterers()[i].occupancy+=-eps
        tg.update_xray_structure(xray_structure=xrs2, alpha_beta=alpha_beta)
        t2 = tg.target()
        #
        gfd = (t1-t2)/(2*eps)
        print(gfd, go[i])
        assert approx_equal(go[i], gfd, 1.e-5)
      # sites_cart
      gc = tg.grad_sites_cart()
      uc = fmodel.xray_structure.unit_cell()
      for i in [0,1]:
        gfd = []
        for e in [(eps,0,0),(0,eps,0),(0,0,eps)]:
          xrs1 = fmodel.xray_structure.deep_copy_scatterers()
          xrs2 = fmodel.xray_structure.deep_copy_scatterers()
          #
          s1 = flex.vec3_double([uc.orthogonalize(xrs1.scatterers()[i].site)])
          s1 = s1+flex.vec3_double([e])
          xrs1.scatterers()[i].site = uc.fractionalize(s1[0])
          tg.update_xray_structure(xray_structure=xrs1, alpha_beta=alpha_beta)
          t1 = tg.target()
          #
          s2 = flex.vec3_double([uc.orthogonalize(xrs2.scatterers()[i].site)])
          s2 = s2-flex.vec3_double([e])
          xrs2.scatterers()[i].site = uc.fractionalize(s2[0])
          tg.update_xray_structure(xray_structure=xrs2, alpha_beta=alpha_beta)
          t2 = tg.target()
          #
          gfd.append( (t1-t2)/(2*eps) )
        print(gfd, list(gc[i]))
        assert approx_equal(gc[i], gfd, 1.e-5)

def exercise_d_data_target_d_atomic_params2():
  import iotbx.pdb
  import mmtbx.f_model
  from scitbx.array_family import flex
  good = """
CRYST1   26.771   27.605   16.145  90.00  90.00  90.00 P 1
ATOM      1  N   ASP A   1      21.771  22.605   5.434  1.00 10.00           N
ATOM      2  CA  ASP A   1      20.399  22.215   5.000  1.00 10.00           C
ATOM      3  C   ASP A   1      19.546  21.744   6.168  1.00 10.00           C
ATOM      4  O   ASP A   1      19.997  20.958   7.001  1.00 10.00           O
ATOM      5  N   VAL A   2      18.313  22.233   6.229  1.00 10.00           N
ATOM      6  CA  VAL A   2      17.402  21.833   7.287  1.00 10.00           C
ATOM      7  C   VAL A   2      16.896  20.436   6.954  1.00 10.00           C
ATOM      8  O   VAL A   2      16.413  20.188   5.850  1.00 10.00           O
ATOM      9  N   GLN A   3      17.009  19.531   7.918  1.00 10.00           N
ATOM     10  CA  GLN A   3      16.590  18.147   7.740  1.00 10.00           C
ATOM     11  C   GLN A   3      15.154  17.904   8.207  1.00 10.00           C
ATOM     12  O   GLN A   3      14.813  18.175   9.356  1.00 10.00           O
ATOM     13  N   MET A   4      14.318  17.383   7.310  1.00 10.00           N
ATOM     14  CA  MET A   4      12.921  17.091   7.630  1.00 10.00           C
ATOM     15  C   MET A   4      12.750  15.585   7.849  1.00 10.00           C
ATOM     16  O   MET A   4      13.057  14.784   6.965  1.00 10.00           O
TER
ATOM     17  N   THR B   5      14.260  17.201  11.025  1.00 10.00           N
ATOM     18  CA  THR B   5      14.076  15.783  11.355  1.00 10.00           C
ATOM     19  C   THR B   5      12.612  15.405  11.550  1.00 10.00           C
ATOM     20  O   THR B   5      11.958  15.902  12.463  1.00 10.00           O
ATOM     21  N   GLN B   6      12.104  14.518  10.697  1.00 10.00           N
ATOM     22  CA  GLN B   6      10.712  14.084  10.797  1.00 10.00           C
ATOM     23  C   GLN B   6      10.571  12.704  11.424  1.00 10.00           C
ATOM     24  O   GLN B   6      11.336  11.787  11.118  1.00 10.00           O
ATOM     25  N   THR B   7       9.565  12.570  12.283  1.00 10.00           N
ATOM     26  CA  THR B   7       9.266  11.322  12.973  1.00 10.00           C
ATOM     27  C   THR B   7       7.756  11.127  12.915  1.00 10.00           C
ATOM     28  O   THR B   7       7.000  12.070  13.145  1.00 10.00           O
ATOM     29  N   PRO B   8       7.291   9.907  12.609  1.00 10.00           N
ATOM     30  CA  PRO B   8       8.060   8.698  12.310  1.00 10.00           C
ATOM     31  C   PRO B   8       8.406   8.619  10.827  1.00 10.00           C
ATOM     32  O   PRO B   8       8.058   9.514  10.054  1.00 10.00           O
ATOM     33  N   LEU B   9       9.093   7.553  10.427  1.00 10.00           N
ATOM     34  CA  LEU B   9       9.459   7.385   9.023  1.00 10.00           C
ATOM     35  C   LEU B   9       8.232   7.000   8.213  1.00 10.00           C
ATOM     36  O   LEU B   9       8.026   7.506   7.113  1.00 10.00           O
TER
  """
  bad = """
CRYST1   26.771   27.605   16.145  90.00  90.00  90.00 P 1
ATOM      1  N   ASP A   1      21.771  22.605   5.434  1.00 10.00           N
ATOM      2  CA  ASP A   1      20.399  22.215   5.000  1.00 10.00           C
ATOM      3  C   ASP A   1      19.546  21.744   6.168  1.00 10.00           C
ATOM      4  O   ASP A   1      19.997  20.958   7.001  1.00 10.00           O
ATOM      5  N   VAL A   2      18.313  22.233   6.229  1.00 10.00           N
ATOM      6  CA  VAL A   2      17.402  21.833   7.287  1.00 10.00           C
ATOM      7  C   VAL A   2      16.896  20.436   6.954  1.00 10.00           C
ATOM      8  O   VAL A   2      16.413  20.188   5.850  1.00 10.00           O
ATOM      9  N   GLN A   3      17.009  19.531   7.918  1.00 10.00           N
ATOM     10  CA  GLN A   3      16.590  18.147   7.740  1.00 10.00           C
ATOM     11  C   GLN A   3      15.154  17.904   8.207  1.00 10.00           C
ATOM     12  O   GLN A   3      14.813  18.175   9.356  1.00 10.00           O
ATOM     13  N   MET A   4      14.318  17.383   7.310  1.00 10.00           N
ATOM     14  CA  MET A   4      12.921  17.091   7.630  1.00 10.00           C
ATOM     15  C   MET A   4      12.750  15.585   7.849  1.00 10.00           C
ATOM     16  O   MET A   4      13.057  14.784   6.965  1.00 10.00           O
TER
ATOM     17  N   THR B   5      14.260  17.201  11.025  1.00 10.00           N
ATOM     18  CA  THR B   5      14.076  15.783  11.355  1.00 10.00           C
ATOM     19  C   THR B   5      12.612  15.405  11.550  1.00 10.00           C
ATOM     20  O   THR B   5      11.958  15.902  12.463  1.00 10.00           O
ATOM     21  N   GLN B   6      12.104  14.518  10.697  0.90 10.00           N
ATOM     22  CA  GLN B   6      10.712  14.084  10.797  0.90 10.00           C
ATOM     23  C   GLN B   6      10.571  12.704  11.424  0.90 10.00           C
ATOM     24  O   GLN B   6      11.336  11.787  11.118  0.90 10.00           O
ATOM     25  N   THR B   7       9.565  12.570  12.283  1.00 10.00           N
ATOM     26  CA  THR B   7       9.266  11.322  12.973  1.00 10.00           C
ATOM     27  C   THR B   7       7.756  11.127  12.915  1.00 10.00           C
ATOM     28  O   THR B   7       7.000  12.070  13.145  1.00 10.00           O
ATOM     29  N   PRO B   8       7.291   9.907  12.609  1.00 10.00           N
ATOM     30  CA  PRO B   8       8.060   8.698  12.310  1.00 10.00           C
ATOM     31  C   PRO B   8       8.406   8.619  10.827  1.00 10.00           C
ATOM     32  O   PRO B   8       8.058   9.514  10.054  1.00 10.00           O
ATOM     33  N   LEU B   9       9.093   7.553  10.427  1.10 10.00           N
ATOM     34  CA  LEU B   9       9.459   7.385   9.023  1.10 10.00           C
ATOM     35  C   LEU B   9       8.232   7.000   8.213  1.10 10.00           C
ATOM     36  O   LEU B   9       8.026   7.506   7.113  1.10 10.00           O
TER
  """
  pdb_inp = iotbx.pdb.input(source_info=None, lines=good)
  hierarchy = pdb_inp.construct_hierarchy()
  hierarchy.atoms().reset_i_seq()
  xrs = pdb_inp.xray_structure_simple()
  xrs.scattering_type_registry(table = "wk1995")
  f_obs = abs(xrs.structure_factors(d_min=1,
    algorithm="direct").f_calc()).set_observation_type_xray_amplitude()
  sfp = mmtbx.f_model.sf_and_grads_accuracy_master_params.extract()
  sfp.algorithm="direct"
  #
  pdb_inp = iotbx.pdb.input(source_info=None, lines=bad)
  xrs = pdb_inp.xray_structure_simple()
  xrs.scattering_type_registry(table = "wk1995")
  #
  fmodel = mmtbx.f_model.manager(
    f_obs                        = f_obs,
    xray_structure               = xrs,
    target_name                  = "ml",
    sf_and_grads_accuracy_params = sfp)
  alpha_beta = fmodel.alpha_beta()
  tg = mmtbx.utils.experimental_data_target_and_gradients(
    fmodel = fmodel,
    alpha_beta=alpha_beta)
  result = tg.group_occupancy_grads(
    pdb_hierarchy       = hierarchy,
    residues_per_window = 1)
  for r in result:
    print("chainID_resseqs: %s occupancy_grad: %-15.6f"%tuple(r))
  # get group gradients using custom selections
  selections = [flex.size_t([0,1,2,3]), flex.size_t([4,5,6,7,8])]
  result = tg.group_occupancy_grads(selections = selections)
  for i, r in enumerate(result):
    print("selection#: %s occupancy_grad: %-15.6f"%(str(i), r[1]))

def exercise_get_atom_selections(verbose=False):
  pdb_in = """\
CRYST1   15.000   15.000   15.000  90.00  90.00  90.00 P 212121
HETATM  115  O   HOH A  18       3.000   5.000   5.000  1.00 10.00           O
HETATM  115  O   HOH A  19       5.000   5.000   8.000  1.00 10.00           O
HETATM  115  O   HOH A  20       5.000   5.000   8.000  1.00 10.00           O
END"""
  log = null_out()
  if (verbose):
    log = sys.stdout
  model = mmtbx.model.manager(
      model_input = iotbx.pdb.input(lines=pdb_in.splitlines(), source_info=None))
  processed_pdb_files_srv = utils.process_pdb_file_srv(log=log)
  processed_pdb_file, pdb_inp = processed_pdb_files_srv.process_pdb_files(
    raw_records=pdb_in.splitlines())
  selections1 = utils.get_atom_selections(
    model = model,
    selection_strings=["resseq 18", "resseq 19", "resseq 20"],
    parameter_name="refine.occupancy")
  try :
    selections2 = utils.get_atom_selections(
      model = model,
      selection_strings=["resseq 18:19", "resseq 19:20"],
      parameter_name="refine.occupancy")
  except Sorry as s :
    assert (str(s) == """\
One or more overlapping selections for refine.occupancy:
resseq 18:19
resseq 19:20""")
  else :
    raise Exception_expected

def exercise_f_000():
  pdb_str="""
CRYST1    5.000    5.000    5.000  90.00  90.00  90.00 P 1
HETATM    1  C    C      1       0.000   0.000   0.000  1.00  5.00           C
END
"""
  xrs = iotbx.pdb.input(source_info=None, lines=pdb_str).xray_structure_simple()
  #
  f = utils.f_000(xray_structure=xrs, mean_solvent_density=0)
  assert approx_equal(f.f_000, 6, 1.e-3)
  #
  f = utils.f_000(mean_solvent_density=1, unit_cell_volume=125)
  assert approx_equal(f.f_000, 125)
  #
  f = utils.f_000(mean_solvent_density=0.25, unit_cell_volume=125,
                  solvent_fraction=0.3, xray_structure = xrs)
  assert approx_equal(f.f_000, 0.25*125*0.3+6, 1.e-3)
  assert approx_equal(f.solvent_fraction, 0.3)
  #
  f = utils.f_000(mean_solvent_density=0.25, unit_cell_volume=125,
                  xray_structure = xrs)
  assert approx_equal(f.f_000, 0.25*125*0.687355324074+6, 1.e-3)

def exercise_detect_link_problems():
  with open("tmp_mmtbx_utils_asn_nag.pdb", "w") as f:
    f.write("""\
CRYST1  124.702  124.702   71.573  90.00  90.00  90.00 P 4 21 2
ATOM   3196  N   ASN A 284      36.622 -19.654  35.782  1.00 19.63           N
ATOM   3197  CA  ASN A 284      36.491 -18.279  35.327  1.00 19.79           C
ATOM   3198  C   ASN A 284      35.037 -17.835  35.322  1.00 20.05           C
ATOM   3199  O   ASN A 284      34.751 -16.634  35.341  1.00 28.11           O
ATOM   3200  CB  ASN A 284      37.063 -18.130  33.915  1.00 21.07           C
ATOM   3201  CG  ASN A 284      38.549 -17.829  33.904  1.00 20.78           C
ATOM   3202  OD1 ASN A 284      39.040 -17.053  34.702  1.00 19.74           O
ATOM   3203  ND2 ASN A 284      39.263 -18.449  32.968  1.00 21.82           N
ATOM   3204  H   ASN A 284      36.875 -20.208  35.174  1.00 23.56           H
ATOM   3205 HD21 ASN A 284      38.893 -18.679  32.227  1.00 26.19           H
ATOM   3206  HA  ASN A 284      36.987 -17.719  35.944  1.00 19.79           H
ATOM   3207  HB2 ASN A 284      36.900 -18.947  33.418  1.00 21.07           H
ATOM   3208  HB3 ASN A 284      36.591 -17.419  33.454  1.00 21.07           H
ATOM   3209 HD22 ASN A 284      38.878 -18.991  32.422  1.00 21.82           H
HETATM 5988  C1  NAG A 467      40.601 -17.959  32.799  1.00 27.22           C
HETATM 5989  C2  NAG A 467      41.289 -19.314  32.714  1.00 22.16           C
HETATM 5990  C3  NAG A 467      42.783 -19.123  32.507  1.00 54.68           C
HETATM 5991  C4  NAG A 467      43.034 -18.265  31.278  1.00 23.55           C
HETATM 5992  C5  NAG A 467      42.261 -16.957  31.391  1.00 33.78           C
HETATM 5993  C6  NAG A 467      42.388 -16.125  30.141  1.00 24.49           C
HETATM 5994  C7  NAG A 467      41.114 -21.444  33.906  1.00 21.47           C
HETATM 5995  C8  NAG A 467      40.844 -22.107  35.214  1.00 20.34           C
HETATM 5996  N2  NAG A 467      41.041 -20.110  33.902  1.00 24.73           N
HETATM 5997  O3  NAG A 467      43.399 -20.391  32.338  1.00 54.77           O
HETATM 5998  O4  NAG A 467      44.417 -17.960  31.155  1.00 53.51           O
HETATM 5999  O5  NAG A 467      40.861 -17.215  31.600  1.00 31.39           O
HETATM 6000  O6  NAG A 467      41.470 -15.043  30.154  1.00 46.51           O
HETATM 6001  O7  NAG A 467      41.392 -22.081  32.897  1.00 22.76           O
HETATM 6002  H1  NAG A 467      40.952 -17.467  33.566  1.00 32.66           H
HETATM 6003  H2  NAG A 467      40.934 -19.790  31.940  1.00 26.59           H
HETATM 6004  H3  NAG A 467      43.163 -18.682  33.290  1.00 65.62           H
HETATM 6005  H4  NAG A 467      42.738 -18.746  30.482  1.00 28.26           H
HETATM 6006  H5  NAG A 467      42.608 -16.449  32.148  1.00 40.54           H
HETATM 6007  H61 NAG A 467      42.210 -16.687  29.363  1.00 29.39           H
HETATM 6008  H62 NAG A 467      43.296 -15.773  30.082  1.00 29.39           H
HETATM 6009  H81 NAG A 467      40.882 -23.076  35.101  1.00 24.41           H
HETATM 6010  H82 NAG A 467      39.958 -21.851  35.532  1.00 24.41           H
HETATM 6011  H83 NAG A 467      41.516 -21.829  35.865  1.00 24.41           H
HETATM 6012  HN2 NAG A 467      40.836 -19.681  34.680  1.00 29.67           H
HETATM 6013  HO3 NAG A 467      42.779 -20.998  32.145  1.00 65.72           H
HETATM 6014  HO4 NAG A 467      44.884 -18.471  31.711  1.00 64.21           H
HETATM 6015  HO6 NAG A 467      40.829 -15.206  30.746  1.00 55.81           H
""")
  result = utils.detect_hydrogen_nomenclature_problem(
    pdb_file="tmp_mmtbx_utils_asn_nag.pdb")
  assert (result.n_asn_hd22 == 0)

def exercise_corrupt_cryst1():
  """
  Consistency check for cs derived in different scenarious (inspired by PDB code
  2y9k).
  """
  pdb_str = """
CRYST1    1.000    1.000    1.000  90.00  90.00  90.00 P 1          15
ORIGX1      1.000000  0.000000  0.000000        0.00000
ORIGX2      0.000000  1.000000  0.000000        0.00000
ORIGX3      0.000000  0.000000  1.000000        0.00000
SCALE1      1.000000  0.000000  0.000000        0.00000
SCALE2      0.000000  1.000000  0.000000        0.00000
SCALE3      0.000000  0.000000  1.000000        0.00000
ATOM      1  N   GLY A  34     -74.292  12.386 -24.083  1.00  0.00           N
ATOM      2  CA  GLY A  34     -74.465  11.623 -25.332  1.00  0.00           C
ATOM      3  C   GLY A  34     -73.114  11.306 -25.993  1.00  0.00           C
ATOM      4  O   GLY A  34     -72.196  12.128 -25.997  1.00  0.00           O
"""
  of = open("tmp_exercise_corrupt_cryst1.pdb", "w")
  print(pdb_str, file=of)
  of.close()
  base_arg = ["tmp_exercise_corrupt_cryst1.pdb"]
  for extra_arg in [[], ["bla=bla"], ["bla"]]:
    o = utils.process_command_line_args(args=base_arg+extra_arg)
    assert o.crystal_symmetry is None, o.crystal_symmetry
    o = utils.process_command_line_args(args=extra_arg+base_arg)
    assert o.crystal_symmetry is None

def exercise_rotatable_bonds():
  pdb_str = """
CRYST1  124.792  235.089   82.032  90.00  90.00  90.00 C 2 2 21
ATOM      1  N   LYS C   1     -31.148 -19.390 -11.207  1.00  0.00           N
ATOM      2  CA  LYS C   1     -31.030 -18.256 -10.299  1.00  0.00           C
ATOM      3  C   LYS C   1     -31.972 -18.403  -9.110  1.00  0.00           C
ATOM      4  O   LYS C   1     -31.567 -18.231  -7.960  1.00  0.00           O
ATOM      5  CB  LYS C   1     -31.312 -16.946 -11.035  1.00  0.00           C
ATOM      6  CG  LYS C   1     -31.183 -15.698 -10.172  1.00  0.00           C
ATOM      7  CD  LYS C   1     -31.387 -14.435 -10.995  1.00  0.00           C
ATOM      8  CE  LYS C   1     -31.277 -13.186 -10.131  1.00  0.00           C
ATOM      9  NZ  LYS C   1     -31.474 -11.943 -10.922  1.00  0.00           N
ATOM     10  HA  LYS C   1     -30.010 -18.227  -9.914  1.00  0.00           H
ATOM     11  HB1 LYS C   1     -30.622 -16.845 -11.874  1.00  0.00           H
ATOM     12  HB2 LYS C   1     -32.323 -16.968 -11.444  1.00  0.00           H
ATOM     13  HG1 LYS C   1     -31.929 -15.728  -9.377  1.00  0.00           H
ATOM     14  HG2 LYS C   1     -30.193 -15.670  -9.719  1.00  0.00           H
ATOM     15  HD1 LYS C   1     -30.634 -14.388 -11.783  1.00  0.00           H
ATOM     16  HD2 LYS C   1     -32.373 -14.458 -11.458  1.00  0.00           H
ATOM     17  HE1 LYS C   1     -32.025 -13.224  -9.341  1.00  0.00           H
ATOM     18  HE2 LYS C   1     -30.291 -13.153  -9.665  1.00  0.00           H
ATOM     19  HZ1 LYS C   1     -31.393 -11.140 -10.314  1.00  0.00           H
ATOM     20  HZ2 LYS C   1     -30.771 -11.889 -11.646  1.00  0.00           H
ATOM     21  HZ3 LYS C   1     -32.391 -11.953 -11.344  1.00  0.00           H
ATOM     22  H 1 LYS C   1     -30.521 -19.268 -11.976  1.00  0.00           H
ATOM     23  H 2 LYS C   1     -30.920 -20.233 -10.720  1.00  0.00           H
ATOM     24  H 3 LYS C   1     -32.087 -19.447 -11.549  1.00  0.00           H
TER
END
"""
  pdb_inp = iotbx.pdb.input(source_info=None, lines=pdb_str)
  model = mmtbx.model.manager(model_input = pdb_inp, log=null_out())
  model.process(make_restraints=True)
  residue = model.get_hierarchy().only_residue()
  r = mmtbx.utils.rotatable_bonds.axes_and_atoms_aa_specific(
      residue = residue, mon_lib_srv = model.get_mon_lib_srv(), log=null_out())
  assert r is None

def run():
  verbose = "--verbose" in sys.argv[1:]
  exercise_corrupt_cryst1()
  exercise_d_data_target_d_atomic_params()
  exercise_d_data_target_d_atomic_params2()
  exercise_get_atom_selections(verbose=verbose)
  exercise_f_000()
  exercise_detect_link_problems()
  exercise_rotatable_bonds()
  print(format_cpu_times())

if (__name__ == "__main__"):
  run()


 *******************************************************************************
